
MAIN	CLR.L	-(SP)
	MOVE.W	#$20,-(SP)
	TRAP	#1
	ADDQ.W	#6,SP

	CLR.W	-(SP)
	PEA	-1.W
	PEA	-1.W
	MOVE.W	#5,-(SP)
	TRAP	#14
	LEA	12(SP),SP

	move.l	#FIN,$008.W
	move.l	#FIN,$010.W
	move.l	#FIN,$01C.W
	move.l	#FIN,$014.W

	LEA	IMG+34,A0
	MOVE.L	$44E.W,A1
	MOVE	#7999,D0
COP	MOVE.L	(A0)+,(A1)+
	DBF	D0,COP
	
	MOVE.L	#VBL,$70.W
P	JMP	P
FIN	MOVE.L	4.W,A0
	JMP	(A0)
VBL
	LEA	TABL2EYES,A0
MOD_EYES	EQU	*+2
	LEA	0(A0),A0
	CMPI.B	#-1,(A0)
	BNE.S	.OK
	
	MOVE.L	$44E.W,A0
	LEA	160*50(A0),A0
	LEA	8(A0),A1
	MOVE	#150-1,D0
.E
N	SET	0
	REPT	10
	MOVE.L	N(A1),N(A0)
N	SET	N+8
	ENDR
	LEA	160(A0),A0
	LEA	160(A1),A1
	DBF	D0,.E
	
	BRA	.FIN
	;CLR	MOD_EYES
	;LEA	TABL2EYES,A0
.OK
	ADDQ	#1,MOD_EYES
	MOVEQ	#0,D0	
	MOVE.B	(A0),D0
	ADD	D0,D0
	ADD	D0,D0
	LEA	TABL_EYES,A0
	MOVE.L	(A0,D0.W),A0

	MOVE.L	$44E.W,A1
	LEA	128*160(A1),A1

	MOVE	#14,D0
.AFY1	MOVE	#9,D1
.AFX1	MOVE.L	(A0)+,(A1)+
	MOVE.L	(A0)+,(A1)+
	DBF	D1,.AFX1
	LEA	80(A0),A0
	LEA	80(A1),A1
	DBF	D0,.AFY1

.FIN
	RTE

IMG	INCBIN	SCREEN2.PI1
EYES	INCBIN	UTILS.PI1

TABL_EYES	
N	SET	0
	REPT	13
	DC.L	EYES+34+N*160
N	SET	N+15
	ENDR
	DC.L	EYES+34+80
	DC.L	EYES+34+80+15*160
	DC.L	EYES+34+80+30*160
TABL2EYES
N	SET	0
	REPT	16-1
	DCB.B	10,N
N	SET	N+1
	ENDR
	DCB.B	100,N
	;DC.B	15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0
	DC.B	15,13,11,9,7,5,3,1
	DCB.B	100,0
	;DC.B	1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
	DC.B	1,3,5,7,9,11,13,15
	DCB.B	100,15
	DC.B	15,13,11,9,7,5,3,1
	DCB.B	25,0
	DC.B	1,3,5,7,9,11,13,15
	DCB.B	100,15
	DC.B	-1
	EVEN