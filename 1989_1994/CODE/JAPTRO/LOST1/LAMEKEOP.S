Main:
	clr.l	-(sp)
	move.w	#$20,-(sp)
	trap	#1
	addq.l	#6,sp

	lea.l	8,a0
	move.l	#fini,d0
	move.l	#fini,d1
	move.l	#fini,d2
	move.l	#fini,d3
	move.l	#fini,d4
	move.l	#fini,d5
	move.l	#fini,d6
	move.l	#fini,d7
	movem.l	d0-d7,(a0)

	CLR	-(SP)
	PEA	-1.W
	PEA	-1.W
	move.w	#$5,-(sp)
	trap	#14
	lea.l	12(sp),sp
***
	MOVE.L	#BUFFER,D0
	CLR.B	D0
	MOVE.L	D0,SCREEN1
	MOVE.B	SCREEN1+1,$FFFF8201.W
	MOVE.B	SCREEN1+2,$FFFF8203.W
	MOVE.L	#$07770777,$FFFF8240.W
	MOVE.L	SCREEN1,A0
	MOVE	#7999,D0
OUTY2	CLR.L	(A0)+
	DBF	D0,OUTY2

	JSR	DêCAL

	LEA	MSG,A0
	MOVE.L	SCREEN1,A1
	MOVE	#200-1,D0
AFY2	MOVE	#20-1,D1
AFX2	MOVE	(A0)+,(A1)
	ADDQ	#8,A1
	DBF	D1,AFX2
	DBF	D0,AFY2

	MOVE.L	#VBL,$70.W
B	BRA.S	B

fini	move.l	4.w,a0
	jmp	(a0)

VBL

	LEA	FAD_END,A6
MODFDEND	EQU	*+2
	LEA	0(A6),A6
	CMPI	#-1,(A6)
	BEQ.S	.OUT
	SUBQ	#1,BAZOUNGA
	BNE.S	.OUT
	MOVE	#5,BAZOUNGA
	ADDQ	#2,MODFDEND
	MOVE	(A6),$FFFF8240.W
.OUT	
	MOVE	#$333,$FFFF8244.W
	MOVE	#$333,$FFFF8246.W
	CMPI	#150,TIME
	BLE.S	OK
	CMPI	#165,TIME
	BGE.S	OK
	LEA	DECAL,A0
MOD_DêC	LEA	30*15(A0),A0
	MOVE.L	SCREEN1,A1
MOD_DêC2	LEA	160*95+152-16+2(A1),A1
	MOVEQ	#4,D0
PO5	MOVE	(A0)+,(A1)
	MOVE	(A0)+,8(A1)
	MOVE	(A0)+,16(A1)
	CLR	24(A1)
	LEA	160(A1),A1
	DBF	D0,PO5
	SUB	#30*8,MOD_DêC+2
	CMPI	#-30,MOD_DêC+2
	BGT.S	.OK
	MOVE	#30*15,MOD_DêC+2
	SUBQ	#8,MOD_DêC2+2
.OK	
OK
	ADDQ	#1,TIME
	RTE
TIME	DC	0
BAZOUNGA	DC	5
FAD_END	;dc	$101,$212,$323,$434,$545,$656,$777,-1
	DC	$777,$667,$556,$445,$334,$223,$112,$101,-1

MSG	INCBIN	MSG5.DAT

DêCAL	
	LEA	DECAL,A1
	MOVE	#16-1,D7
PO4
	LEA	GFX,A0
	MOVEQ	#15-1,D0
PO	MOVE	(A0)+,(A1)+
	DBF	D0,PO

	;MOVEQ	#0,D1
PO3	LEA	GFX,A0
	MOVEQ	#4,D0
PO2	ROXR	(A0)
	ROXR	2(A0)
	ROXR	4(A0)
	ADDQ	#6,A0
	SUB	D1,D1
	DBF	D0,PO2
	;DBF	D1,PO3

	DBF	D7,PO4
	RTS

GFX	DC.B	0,%1100100,%01110011,%11100000,0,0
	DC.B	0,%1010100,%10001000,%10000000,0,0
	DC.B	0,%1001100,%10001000,%10000000,0,0
	DC.B	0,%1000100,%10001000,%10000000,0,0
	DC.B	0,%1000100,%01110000,%10000000,0,0
	BSS
SCREEN1	DS.L	1
DECAL	DS.B	5*6*16
	DS.B	256
BUFFER	DS.B	32000