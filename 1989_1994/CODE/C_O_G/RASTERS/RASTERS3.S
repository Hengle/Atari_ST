DEBUT:	MOVEA.L  A7,A5
	LEA.L 	D_PILE,A7
	MOVE.L 	4(A5),A5
	MOVE.L 	$C(A5),D0
	ADD.L 	$14(A5),D0
	ADD.L 	$1C(A5),D0
	ADD.L 	#$100,D0		
	MOVE.L 	D0,-(SP)		
        MOVE.L 	A5,-(SP)
	MOVE 	#0,-(SP)
	MOVE 	#$4A,-(SP)
	TRAP 	#1
	LEA 	12(SP),SP
	
	CLR.L 	-(SP)
	MOVE 	#$20,-(SP)
	TRAP 	#1
	ADDQ.L 	#6,SP
	MOVE.L 	D0,SAUVE


	CLR.L	POINTEUR
;	MOVE.L	#14,POINTEUR
	
	MOVE.L	#FIN,$008.W
	MOVE.L	#FIN,$00C.W
	MOVE.L	#FIN,$010.W
			
	MOVE.B	$FFFFFA07.W,MFP1
	MOVE.B	$FFFFFA09.W,MFP2
	MOVE.B	$FFFFFA0F.W,MFP3
	MOVE.B	$FFFFFA13.W,MFP4
	MOVE.B	$FFFFFA1B.W,MFP5
	MOVE.B	$FFFFFA21.W,MFP6
	
	CLR.B	$FFFFFA07.W
	CLR.B	$FFFFFA09.W
	
	MOVE	#4,-(SP)
	TRAP 	#14
	ADDQ.L	#2,SP
	MOVE	D0,RES
	
	MOVE	#2,-(SP)
	TRAP 	#14
	ADDQ.L 	#2,SP
	MOVE.L	D0,ANC_ECR
	
	CLR.W 	-(SP)
	MOVE.L	#$78000,-(SP)
	MOVE.L	#$78000,-(SP)
	MOVE 	#5,-(SP)
	TRAP 	#14
	LEA.L 	12(SP),SP


	LEA.L	$FFFF8240.W,A0
	MOVEM.L	(A0),D0-D7
	LEA.L	ANC_PAL,A0
	MOVEM.L	D0-D7,(A0)
	
        
	MOVE.L	$70.W,ANC_VBL
	MOVE.L	#VBL_IR,$70.W
	MOVE.L	$120.W,ANC_TB
	MOVE.L	#TB0_IR,$120.W
	
	DC.W	$A00A
	MOVE.B	#$12,$FFFFFC02.W
	
	CLR.B	$FFFFFA1B.W
	BSET	#0,$FFFFFA07.W
	BSET	#0,$FFFFFA13.W



BOUCLE	JMP	BOUCLE

FIN:	
	MOVE.B	#8,$FFFFFC02.W
	MOVE.B	MFP1,$FFFFFA07.W
	MOVE.B	MFP2,$FFFFFA09.W
	MOVE.B	MFP3,$FFFFFA0F.W
	MOVE.B	MFP4,$FFFFFA13.W
	MOVE.B	MFP5,$FFFFFA1B.W
	MOVE.B	MFP6,$FFFFFA21.W
	
	MOVE.L	ANC_VBL,$70.W
	MOVE.L	ANC_TB,$120.W
	
	LEA.L	ANC_PAL,A0
	MOVEM.L	(A0),D0-D7
	LEA.L	$FFFF8240.W,A0
	MOVEM.L	D0-D7,(A0)
	
	MOVE 	RES,-(SP)	
	MOVE.L	ANC_ECR,-(SP)	
	MOVE.L	ANC_ECR,-(SP)	
	MOVE 	#5,-(SP)	
	TRAP 	#14		
	LEA.L 	12(SP),SP	
	
	MOVE.L	SAUVE,-(SP)	
	MOVE 	#$20,-(SP)	
	TRAP 	#1		
	ADDQ.L 	#6,SP		
	
;	PEA	CHUT_DA	   	
;	MOVE	#$20,-(A7) 	
;	TRAP	#14        	
;	ADDQ.L	#6,A7      	

	CLR.W 	-(SP)		
	TRAP	#1		
	





VBL_IR	

	LEA	BUFFER,A0

	MOVE.L	#99,D0
P	CLR.L	(A0)+
	DBF	D0,P
	CLR.L	D1
	
	LEA	BARRE,A2
	LEA	BUFFER,A0
	LEA	Y_DAT,A1
	ADDA.L	POINTEUR,A1
	CMPI.B	#-1,21(A1)
	BNE.S	OK
	CLR.L	POINTEUR
	LEA	Y_DAT,A1
OK	MOVE.B	(A1),D1
	MULU	#2,D1
	ADD.L	D1,A0
	
	REPT	21
	MOVE.L	(A2)+,(A0)+
	ENDR
	
	CLR.L	D1
	LEA	BARRE,A2
	LEA	BUFFER,A0
	LEA	Y_DAT+6,A1
	ADDA.L	POINTEUR,A1
	MOVE.B	(A1),D1
	MULU	#2,D1
	ADD.L	D1,A0
	REPT	21
	MOVE.L	(A2)+,(A0)+
	ENDR

	CLR.L	D1
	LEA	BARRE,A2
	LEA	BUFFER,A0
	LEA	Y_DAT+12,A1
	ADDA.L	POINTEUR,A1
	MOVE.B	(A1),D1
	MULU	#2,D1
	ADD.L	D1,A0
	REPT	21
	MOVE.L	(A2)+,(A0)+
	ENDR


	CLR.L	D1
	LEA	BARRE,A2
	LEA	BUFFER,A0
	LEA	Y_DAT+18,A1
	ADDA.L	POINTEUR,A1
	MOVE.B	(A1),D1
	MULU	#2,D1
	ADD.L	D1,A0
	REPT	21
	MOVE.L	(A2)+,(A0)+
	ENDR


	LEA	BUFFER,A0
	ADD.L	#1,POINTEUR
	
	
	CLR.B	$FFFFFA1B.W
	MOVE.B	#1,$FFFFFA21.W
	MOVE.B	#8,$FFFFFA1B.W
	
	
	CMPI.B	#$39,$FFFFFC02.W
	BEQ	FIN
	RTE


 


TB0_IR	
;	CLR.B	$FFFFFA1B.W
;	MOVE.B	#1,$FFFFFA21.W
;	MOVE.B	#8,$FFFFFA1B.W
;	MOVE.L	#TB0_IR,$120
	MOVE	(A0)+,$FFFF8240.W
	BCLR	#0,$FFFFFA0F.W
	RTE			







	 
	section   data

BARRE	;DC	$111,$222,$333,$444,$555,$666,$777
	;DC	$777,$666,$555,$444,$333,$222,$111

COLORS	
	DC.W	$100,$200,$300,$400,$500,$600,$700
	DC.W	$710,$720,$730,$740,$750,$760,$770
	DC.W	$771,$772,$773,$774,$775,$776,$777

	DC.W	$776,$766,$666,$665,$655,$555,$554
	DC.W	$544,$444,$443,$433,$333,$332,$322
	DC.W	$222,$221,$211,$111,$110,$100,$000




BUFFER
	DCB	300,$000

Y_DAT
 DC.B 84
 DC.B 87
 DC.B 90
 DC.B 94
 DC.B 97
 DC.B 100
 DC.B 103
 DC.B 107
 DC.B 110
 DC.B 113
 DC.B 116
 DC.B 119
 DC.B 122
 DC.B 125
 DC.B 128
 DC.B 131
 DC.B 134
 DC.B 136
 DC.B 139
 DC.B 141
 DC.B 144
 DC.B 146
 DC.B 148
 DC.B 150
 DC.B 152
 DC.B 154
 DC.B 156
 DC.B 158
 DC.B 159
 DC.B 161
 DC.B 162
 DC.B 163
 DC.B 164
 DC.B 165
 DC.B 166
 DC.B 166
 DC.B 167
 DC.B 167
 DC.B 167
 DC.B 167
 DC.B 167
 DC.B 167
 DC.B 167
 DC.B 167
 DC.B 166
 DC.B 165
 DC.B 164
 DC.B 164
 DC.B 162
 DC.B 161
 DC.B 160
 DC.B 158
 DC.B 157
 DC.B 155
 DC.B 153
 DC.B 151
 DC.B 149
 DC.B 147
 DC.B 145
 DC.B 143
 DC.B 140
 DC.B 138
 DC.B 135
 DC.B 132
 DC.B 130
 DC.B 127
 DC.B 124
 DC.B 121
 DC.B 118
 DC.B 115
 DC.B 112
 DC.B 108
 DC.B 105
 DC.B 102
 DC.B 99
 DC.B 95
 DC.B 92
 DC.B 89
 DC.B 85
 DC.B 82
 DC.B 79
 DC.B 75
 DC.B 72
 DC.B 69
 DC.B 65
 DC.B 62
 DC.B 59
 DC.B 56
 DC.B 52
 DC.B 49
 DC.B 46
 DC.B 43
 DC.B 40
 DC.B 38
 DC.B 35
 DC.B 32
 DC.B 29
 DC.B 27
 DC.B 25
 DC.B 22
 DC.B 20
 DC.B 18
 DC.B 16
 DC.B 14
 DC.B 12
 DC.B 10
 DC.B 9
 DC.B 7
 DC.B 6
 DC.B 5
 DC.B 4
 DC.B 3
 DC.B 2
 DC.B 1
 DC.B 0
 DC.B 0
 DC.B 0
 DC.B 0
 DC.B 0
 DC.B 0
 DC.B 0
 DC.B 0
 DC.B 1
 DC.B 1
 DC.B 2
 DC.B 3
 DC.B 4
 DC.B 5
 DC.B 6
 DC.B 8
 DC.B 9
 DC.B 11
 DC.B 13
 DC.B 15
 DC.B 17
 DC.B 19
 DC.B 21
 DC.B 23
 DC.B 25
 DC.B 28
 DC.B 30
 DC.B 33
 DC.B 36
 DC.B 39
 DC.B 42
 DC.B 44
 DC.B 47
 DC.B 51
 DC.B 54
 DC.B 57
 DC.B 60
 DC.B 63
 DC.B 67
 DC.B 70
 DC.B 73
 DC.B 77
 DC.B 80
; DC.B 83
;
 DC.B 84
 DC.B 87
 DC.B 90
 DC.B 94
 DC.B 97
 DC.B 100
 DC.B 103
 DC.B 107
 DC.B 110
 DC.B 113
 DC.B 116
 DC.B 119
 DC.B 122
 DC.B 125
 DC.B 128
 DC.B 131
 DC.B 134
 DC.B 136
 DC.B 139
 DC.B 141
 DC.B 144
	DC.L	-1

;CHUT_DA	DC.B	7,$FF,6,0,8,0,9,0,$A,0

 	SECTION BSS
 	EVEN
F_PILE	DS.L 	128	
D_PILE	DS.L 	1	
POINTEUR	DS.L	1
SAUVE	DS.L	1	
ANC_VBL DS.L	1	
ANC_TB	DS.L	1	
ANC_ECR	DS.L	1	
RES	DS.W	1	
ANC_PAL	DS.W	16
MFP1	DS.B	1
MFP2	DS.B	1
MFP3	DS.B	1
MFP4	DS.B	1
MFP5	DS.B	1
MFP6	DS.B	1
