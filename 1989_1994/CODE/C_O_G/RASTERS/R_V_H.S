	SECTION TEXT
DEBUT:	MOVE.L  A7,A5
	LEA.L 	D_PILE,A7
	MOVE.L 	4(A5),A5
	MOVE.L 	$C(A5),D0
	ADD.L 	$14(A5),D0
	ADD.L 	$1C(A5),D0
	ADD.L 	#$100,D0		
	MOVE.L 	D0,-(SP)		
        MOVE.L 	A5,-(SP)
	MOVE.W 	#0,-(SP)
	MOVE.W 	#$4A,-(SP)
	TRAP 	#1
	LEA 	12(SP),SP
	
	CLR.L 	-(SP)
	MOVE.W 	#$20,-(SP)
	TRAP 	#1
	ADDQ.L 	#6,SP
	MOVE.L 	D0,SAUVE

	MOVE.L	#8,NB_PART

	MOVE.L	#TB0_IR,PNT
	ADD.L	#$14,PNT
	MOVE.L	#226,D0
	LEA	TB0_IR,A1
	
DO_TIM	LEA	DATA_RAST,A0
	
	MOVE	(A0)+,(A1)+
	MOVE.L	PNT,(A1)+
	MOVE.L	(A0)+,(A1)+
	MOVE.L	(A0)+,(A1)+
	MOVE.L	(A0)+,(A1)+
	MOVE	(A0)+,(A1)+
	ADD.L	#$14,PNT
	DBF	D0,DO_TIM


	CLR.L	POINTEUR
	


	MOVE.L	#FIN,$008.W
	MOVE.L	#FIN,$00C.W
	MOVE.L	#FIN,$010.W
	MOVE.L	#FIN,$012.W



	CLR.L	TPS
	
	MOVEQ	#1,D0
	JSR	ZIK

;	LEA	IMAGE,A0
;	JSR	decrunch

	MOVE.L #MES_F3,MES_PNT3

	MOVE.L	#FIN,$008.W
	MOVE.L	#FIN,$00C.W
	MOVE.L	#FIN,$010.W
			
	MOVE.B	$FFFFFA07.W,MFP1
	MOVE.B	$FFFFFA09.W,MFP2
	MOVE.B	$FFFFFA0F.W,MFP3
	MOVE.B	$FFFFFA13.W,MFP4
	MOVE.B	$FFFFFA1B.W,MFP5
	MOVE.B	$FFFFFA21.W,MFP6
	
	CLR.B	$FFFFFA07.W	* A VIRER POUR LA ZIK D'HOTLINE
	CLR.B	$FFFFFA09.W	* 
	
	JSR	SET_SCR

	
	CLR.L	PLUS
	MOVE.L	#7,LIGNES
	MOVE.L	#15,D3

O2      MOVEA.L #DATA+34,A4
        JSR PREDECALE

        MOVEA.L #DATA+34,A0
	LEA	BUF1,A1
	ADDA.L	PLUS,A1

	MOVE.L	#7,D1
P2	MOVE.L	#3,D0
L2	MOVE.L	(A0)+,(A1)+
	DBF	D0,L2
	LEA	144(A0),A0	* 72=160-88
	DBF	D1,P2
		
	MOVE.L	PLUS,D4
	ADD.L	#128,D4
	MOVE.L	D4,PLUS

	DBF	D3,O2





        MOVEA.L #DATA+34,A0
        LEA   MASQ,A1
        MOVE.L  #15,D7
QS1     MOVE.W  (A0),D0
	MOVE.W  2(A0),D1
	MOVE.W  4(A0),D2
	MOVE.W  6(A0),D3
	OR.W	D0,D1
	OR.W	D1,D2
	OR.W	D2,D3
	MOVE	D3,(A1)
	MOVE	D3,2(A1)
	MOVE	D3,4(A1)
	MOVE	D3,6(A1)
	LEA     8(A1),A1
	LEA     8(A0),A0
        DBF D7,QS1

        LEA   BUF1,A0
        LEA   MASQ2,A1
        MOVE.L  #15,D7
QS2     MOVE.W  (A0),D0
	MOVE.W  2(A0),D1
	MOVE.W  4(A0),D2
	MOVE.W  6(A0),D3
	OR.W	D0,D1
	OR.W	D1,D2
	OR.W	D2,D3
	MOVE	D3,(A1)
	MOVE	D3,2(A1)
	MOVE	D3,4(A1)
	MOVE	D3,6(A1)
	LEA     8(A1),A1
	LEA     8(A0),A0
        DBF D7,QS2

        LEA   BUF2,A0
        LEA   MASQ3,A1
        MOVE.L  #15,D7
QS3     MOVE.W  (A0),D0
	MOVE.W  2(A0),D1
	MOVE.W  4(A0),D2
	MOVE.W  6(A0),D3
	OR.W	D0,D1
	OR.W	D1,D2
	OR.W	D2,D3
	MOVE	D3,(A1)
	MOVE	D3,2(A1)
	MOVE	D3,4(A1)
	MOVE	D3,6(A1)
	LEA     8(A1),A1
	LEA     8(A0),A0
        DBF D7,QS3

        LEA   BUF3,A0
        LEA   MASQ4,A1
        MOVE.L  #15,D7
QS4     MOVE.W  (A0),D0
	MOVE.W  2(A0),D1
	MOVE.W  4(A0),D2
	MOVE.W  6(A0),D3
	OR.W	D0,D1
	OR.W	D1,D2
	OR.W	D2,D3
	MOVE	D3,(A1)
	MOVE	D3,2(A1)
	MOVE	D3,4(A1)
	MOVE	D3,6(A1)
	LEA     8(A1),A1
	LEA     8(A0),A0
        DBF D7,QS4

        LEA   BUF4,A0
        LEA   MASQ5,A1
        MOVE.L  #15,D7
QS5     MOVE.W  (A0),D0
	MOVE.W  2(A0),D1
	MOVE.W  4(A0),D2
	MOVE.W  6(A0),D3
	OR.W	D0,D1
	OR.W	D1,D2
	OR.W	D2,D3
	MOVE	D3,(A1)
	MOVE	D3,2(A1)
	MOVE	D3,4(A1)
	MOVE	D3,6(A1)
	LEA     8(A1),A1
	LEA     8(A0),A0
        DBF D7,QS5

        LEA   BUF5,A0
        LEA   MASQ6,A1
        MOVE.L  #15,D7
QS6     MOVE.W  (A0),D0
	MOVE.W  2(A0),D1
	MOVE.W  4(A0),D2
	MOVE.W  6(A0),D3
	OR.W	D0,D1
	OR.W	D1,D2
	OR.W	D2,D3
	MOVE	D3,(A1)
	MOVE	D3,2(A1)
	MOVE	D3,4(A1)
	MOVE	D3,6(A1)
	LEA     8(A1),A1
	LEA     8(A0),A0
        DBF D7,QS6

        LEA   BUF6,A0
        LEA   MASQ7,A1
        MOVE.L  #15,D7
QS7     MOVE.W  (A0),D0
	MOVE.W  2(A0),D1
	MOVE.W  4(A0),D2
	MOVE.W  6(A0),D3
	OR.W	D0,D1
	OR.W	D1,D2
	OR.W	D2,D3
	MOVE	D3,(A1)
	MOVE	D3,2(A1)
	MOVE	D3,4(A1)
	MOVE	D3,6(A1)
	LEA     8(A1),A1
	LEA     8(A0),A0
        DBF D7,QS7

        LEA   BUF7,A0
        LEA   MASQ8,A1
        MOVE.L  #15,D7
QS8     MOVE.W  (A0),D0
	MOVE.W  2(A0),D1
	MOVE.W  4(A0),D2
	MOVE.W  6(A0),D3
	OR.W	D0,D1
	OR.W	D1,D2
	OR.W	D2,D3
	MOVE	D3,(A1)
	MOVE	D3,2(A1)
	MOVE	D3,4(A1)
	MOVE	D3,6(A1)
	LEA     8(A1),A1
	LEA     8(A0),A0
        DBF D7,QS8


        LEA   BUF8,A0
        LEA   MASQ9,A1
        MOVE.L  #15,D7
QS9     MOVE.W  (A0),D0
	MOVE.W  2(A0),D1
	MOVE.W  4(A0),D2
	MOVE.W  6(A0),D3
	OR.W	D0,D1
	OR.W	D1,D2
	OR.W	D2,D3
	MOVE	D3,(A1)
	MOVE	D3,2(A1)
	MOVE	D3,4(A1)
	MOVE	D3,6(A1)
	LEA     8(A1),A1
	LEA     8(A0),A0
        DBF D7,QS9


        LEA   BUF9,A0
        LEA   MASQ10,A1
        MOVE.L  #15,D7
QS10    MOVE.W  (A0),D0
	MOVE.W  2(A0),D1
	MOVE.W  4(A0),D2
	MOVE.W  6(A0),D3
	OR.W	D0,D1
	OR.W	D1,D2
	OR.W	D2,D3
	MOVE	D3,(A1)
	MOVE	D3,2(A1)
	MOVE	D3,4(A1)
	MOVE	D3,6(A1)
	LEA     8(A1),A1
	LEA     8(A0),A0
        DBF D7,QS10

        LEA   BUF10,A0
        LEA   MASQ11,A1
        MOVE.L  #15,D7
QS11    MOVE.W  (A0),D0
	MOVE.W  2(A0),D1
	MOVE.W  4(A0),D2
	MOVE.W  6(A0),D3
	OR.W	D0,D1
	OR.W	D1,D2
	OR.W	D2,D3
	MOVE	D3,(A1)
	MOVE	D3,2(A1)
	MOVE	D3,4(A1)
	MOVE	D3,6(A1)
	LEA     8(A1),A1
	LEA     8(A0),A0
       DBF D7,QS11


        LEA   BUF11,A0
        LEA   MASQ12,A1
        MOVE.L  #15,D7
QS12    MOVE.W  (A0),D0
	MOVE.W  2(A0),D1
	MOVE.W  4(A0),D2
	MOVE.W  6(A0),D3
	OR.W	D0,D1
	OR.W	D1,D2
	OR.W	D2,D3
	MOVE	D3,(A1)
	MOVE	D3,2(A1)
	MOVE	D3,4(A1)
	MOVE	D3,6(A1)
	LEA     8(A1),A1
	LEA     8(A0),A0
        DBF D7,QS12

        LEA   BUF12,A0
        LEA   MASQ13,A1
        MOVE.L  #15,D7
QS13    MOVE.W  (A0),D0
	MOVE.W  2(A0),D1
	MOVE.W  4(A0),D2
	MOVE.W  6(A0),D3
	OR.W	D0,D1
	OR.W	D1,D2
	OR.W	D2,D3
	MOVE	D3,(A1)
	MOVE	D3,2(A1)
	MOVE	D3,4(A1)
	MOVE	D3,6(A1)
	LEA     8(A1),A1
	LEA     8(A0),A0
        DBF D7,QS13

        LEA   BUF13,A0
        LEA   MASQ14,A1
        MOVE.L  #15,D7
QS14    MOVE.W  (A0),D0
	MOVE.W  2(A0),D1
	MOVE.W  4(A0),D2
	MOVE.W  6(A0),D3
	OR.W	D0,D1
	OR.W	D1,D2
	OR.W	D2,D3
	MOVE	D3,(A1)
	MOVE	D3,2(A1)
	MOVE	D3,4(A1)
	MOVE	D3,6(A1)
	LEA     8(A1),A1
	LEA     8(A0),A0
        DBF D7,QS14

        LEA   BUF14,A0
        LEA   MASQ15,A1
        MOVE.L  #15,D7
QS15    MOVE.W  (A0),D0
	MOVE.W  2(A0),D1
	MOVE.W  4(A0),D2
	MOVE.W  6(A0),D3
	OR.W	D0,D1
	OR.W	D1,D2
	OR.W	D2,D3
	MOVE	D3,(A1)
	MOVE	D3,2(A1)
	MOVE	D3,4(A1)
	MOVE	D3,6(A1)
	LEA     8(A1),A1
	LEA     8(A0),A0
        DBF D7,QS15

        LEA   BUF15,A0
        LEA   MASQ16,A1
        MOVE.L  #15,D7
QS16    MOVE.W  (A0),D0
	MOVE.W  2(A0),D1
	MOVE.W  4(A0),D2
	MOVE.W  6(A0),D3
	OR.W	D0,D1
	OR.W	D1,D2
	OR.W	D2,D3
	MOVE	D3,(A1)
	MOVE	D3,2(A1)
	MOVE	D3,4(A1)
	MOVE	D3,6(A1)
	LEA     8(A1),A1
	LEA     8(A0),A0
        DBF D7,QS16

        LEA   BUF16,A0
        LEA   MASQ17,A1
        MOVE.L  #15,D7
QS17    MOVE.W  (A0),D0
	MOVE.W  2(A0),D1
	MOVE.W  4(A0),D2
	MOVE.W  6(A0),D3
	OR.W	D0,D1
	OR.W	D1,D2
	OR.W	D2,D3
	MOVE	D3,(A1)
	MOVE	D3,2(A1)
	MOVE	D3,4(A1)
	MOVE	D3,6(A1)
	LEA     8(A1),A1
	LEA     8(A0),A0
        DBF D7,QS17




        LEA   MASQ,A1 
        MOVE.L  #544,D7       * 264*16=1184
QSS     NOT.L  (A1)+
        DBF D7,QSS

	MOVE.W	#4,-(SP)
	TRAP 	#14
	ADDQ.L	#2,SP
	MOVE.W	D0,RES
	
	MOVE.W	#2,-(SP)
	TRAP 	#14
	ADDQ.L 	#2,SP
	MOVE.L	D0,ANC_ECR
	
	MOVE.W 	#0,-(SP)
	MOVE.L	#-1,-(SP)
	MOVE.L	#-1,-(SP)
	MOVE.W 	#5,-(SP)
	TRAP 	#14
	LEA.L 	12(SP),SP

	LEA.L	$FFFF8240.W,A0
	MOVEM.L	(A0),D0-D7
	LEA.L	ANC_PAL,A0
	MOVEM.L	D0-D7,(A0)
	
	MOVE.L	$70,ANC_VBL
	MOVE.L	#VBL_IR,$70
	MOVE.L	$120,ANC_TB
	MOVE.L	#TB0_IR,$120
	
	DC.W	$A00A
	MOVE.B	#$12,$FFFFFC02.W
	
	CLR.B	$FFFFFA1B.W
	BSET	#0,$FFFFFA07.W
	BSET	#0,$FFFFFA13.W

BOUCLE	JMP BOUCLE

SCROLL	MOVE.L	ADRTXT,A6
	LEA	-2(A6),A6
	LEA	BUF_LET,A1
	REPT	8
	ROXL	(A1)


	ROXL	154(A6)
	ROXL	146(A6)
	ROXL	138(A6)
	ROXL	130(A6)
	ROXL	122(A6)
	ROXL	114(A6)
	ROXL	106(A6)
	ROXL	98(A6)
	ROXL	90(A6)
	ROXL	82(A6)
	ROXL	74(A6)
	ROXL	66(A6)
	ROXL	58(A6)	
	ROXL	50(A6)
	ROXL	42(A6)
	ROXL	34(A6)
	ROXL	26(A6)
	ROXL	18(A6)
	ROXL	10(A6)
	ROXL	2(A6)
	LEA	160(A6),A6
	ADDQ.L	#2,A1
	ENDR
	ADDI.L	#1,NB_PART
	RTS

TEST_LET	MOVEQ	#0,D0
	LEA	TEXT1,A6	
	ADDA.L	POINT2,A6
	LEA	FONT8_8,A1
	CMPI.B	#$FF,(A6)
	BNE	SUITTST
	CLR.L	POINT2
	LEA	TEXT1,A6
SUITTST	MOVE.B	(A6),D0	
	SUBI.B	#32,D0	
	LSL.W	#3,D0	
	ADDA.L	D0,A1	
	LEA	BUF_LET,A2
	MOVE.B	(A1)+,(A2)
	MOVE.B	(A1)+,2(A2)
	MOVE.B	(A1)+,4(A2)
	MOVE.B	(A1)+,6(A2)
	MOVE.B	(A1)+,8(A2)
	MOVE.B	(A1)+,10(A2)
	MOVE.B	(A1)+,12(A2)
	MOVE.B	(A1)+,14(A2)
	ADDI.L	#1,POINT2
	RTS

VBL_IR
	CLR.B	$FFFFFA1B.W

	
	LEA	BUFFER_RAST,A0	3
	MOVEQ	#0,D0	1
	MOVEQ	#0,D1	1
	MOVEQ	#0,D2	1
	MOVEQ	#0,D3	1
	MOVEQ	#0,D4	1
	MOVEQ	#0,D5	1
	MOVEQ	#0,D6	1
	MOVEQ	#0,D7	1
	MOVEM.L	D0-D7,(A0)	18
	MOVEM.L	D0-D7,4*8(A0)	19
	MOVEM.L	D0-D7,4*8*2(A0)	19
	MOVEM.L	D0-D7,4*8*3(A0)	19
	MOVEM.L	D0-D7,4*8*4(A0)	19
	MOVEM.L	D0-D7,4*8*5(A0)	19
	MOVEM.L	D0-D7,4*8*6(A0)	19
	MOVEM.L	D0-D7,4*8*7(A0)	19
	MOVEM.L	D0-D7,4*8*8(A0)	19
	MOVEM.L	D0-D7,4*8*9(A0)	19
	MOVEM.L	D0-D7,4*8*10(A0)	19
	MOVEM.L	D0-D7,4*8*11(A0)	19

	MOVEM.L	D0-D7,4*8*12(A0)	19
	MOVEM.L	D0-D7,4*8*13(A0)	19


	MOVEM.L	D0-D3,4*8*14(A0)	11
;		T=249

	CLR	D1	1
	LEA	BARRE,A2	3
	LEA	BUFFER_RAST,A0	3
	LEA	Y_DAT,A1	3
	ADDA.L	POINTEUR,A1	6
	CMPI.B	#-1,81(A1)	4
	BNE.S	OK2	3/2
	CLR.L	POINTEUR	7
	LEA	Y_DAT,A1	3
	BRA.S	OK	3
OK2	DCB	12,$4E71

OK	MOVE.B	(A1),D1	2
	LSL	#1,D1	2
	ADD	D1,A0	2
	
	MOVEM.L	(A2),D0-D7/A1/A3-A6	29
	MOVEM.L	D0-D7/A1/A3-A6,(A0)	28
	MOVEM.L	52(A2),D0-D7	20
	MOVEM.L	D0-D7,52(A0)	19
;	T=137
	
	CLR	D1
	LEA	BARRE,A2
	LEA	BUFFER_RAST,A0
	LEA	Y_DAT+6,A1
	ADDA.L	POINTEUR,A1
	MOVE.B	(A1),D1
	LSL	#1,D1
	ADD	D1,A0
	MOVEM.L	(A2),D0-D7/A1/A3-A6
	MOVEM.L	D0-D7/A1/A3-A6,(A0)
	MOVEM.L	52(A2),D0-D7
	MOVEM.L	D0-D7,52(A0)
;	T=118

	CLR	D1
	LEA	BARRE,A2
	LEA	BUFFER_RAST,A0
	LEA	Y_DAT+12,A1
	ADDA.L	POINTEUR,A1
	MOVE.B	(A1),D1
	LSL	#1,D1
	ADD	D1,A0
	MOVEM.L	(A2),D0-D7/A1/A3-A6
	MOVEM.L	D0-D7/A1/A3-A6,(A0)
	MOVEM.L	52(A2),D0-D7
	MOVEM.L	D0-D7,52(A0)


	CLR	D1
	LEA	BARRE,A2
	LEA	BUFFER_RAST,A0
	LEA	Y_DAT+18,A1
	ADDA.L	POINTEUR,A1
	MOVE.B	(A1),D1
	LSL	#1,D1
	ADD	D1,A0
	MOVEM.L	(A2),D0-D7/A1/A3-A6
	MOVEM.L	D0-D7/A1/A3-A6,(A0)
	MOVEM.L	52(A2),D0-D7
	MOVEM.L	D0-D7,52(A0)

	CLR	D1
	LEA	BARRE,A2
	LEA	BUFFER_RAST,A0
	LEA	Y_DAT+24,A1
	ADDA.L	POINTEUR,A1
	MOVE.B	(A1),D1
	LSL	#1,D1
	ADD	D1,A0
	MOVEM.L	(A2),D0-D7/A1/A3-A6
	MOVEM.L	D0-D7/A1/A3-A6,(A0)
	MOVEM.L	52(A2),D0-D7
	MOVEM.L	D0-D7,52(A0)

	CLR	D1
	LEA	BARRE,A2
	LEA	BUFFER_RAST,A0
	LEA	Y_DAT+30,A1
	ADDA.L	POINTEUR,A1
	MOVE.B	(A1),D1
	LSL	#1,D1
	ADD	D1,A0
	MOVEM.L	(A2),D0-D7/A1/A3-A6
	MOVEM.L	D0-D7/A1/A3-A6,(A0)
	MOVEM.L	52(A2),D0-D7
	MOVEM.L	D0-D7,52(A0)

	CLR	D1
	LEA	BARRE,A2
	LEA	BUFFER_RAST,A0
	LEA	Y_DAT+36,A1
	ADDA.L	POINTEUR,A1
	MOVE.B	(A1),D1
	LSL	#1,D1
	ADD	D1,A0
	MOVEM.L	(A2),D0-D7/A1/A3-A6
	MOVEM.L	D0-D7/A1/A3-A6,(A0)
	MOVEM.L	52(A2),D0-D7
	MOVEM.L	D0-D7,52(A0)

	CLR	D1
	LEA	BARRE,A2
	LEA	BUFFER_RAST,A0
	LEA	Y_DAT+42,A1
	ADDA.L	POINTEUR,A1
	MOVE.B	(A1),D1
	LSL	#1,D1
	ADD	D1,A0
	MOVEM.L	(A2),D0-D7/A1/A3-A6
	MOVEM.L	D0-D7/A1/A3-A6,(A0)
	MOVEM.L	52(A2),D0-D7
	MOVEM.L	D0-D7,52(A0)

	CLR	D1
	LEA	BARRE,A2
	LEA	BUFFER_RAST,A0
	LEA	Y_DAT+48,A1
	ADDA.L	POINTEUR,A1
	MOVE.B	(A1),D1
	LSL	#1,D1
	ADD	D1,A0
	MOVEM.L	(A2),D0-D7/A1/A3-A6
	MOVEM.L	D0-D7/A1/A3-A6,(A0)
	MOVEM.L	52(A2),D0-D7
	MOVEM.L	D0-D7,52(A0)

	CLR	D1
	LEA	BARRE,A2
	LEA	BUFFER_RAST,A0
	LEA	Y_DAT+54,A1
	ADDA.L	POINTEUR,A1
	MOVE.B	(A1),D1
	LSL	#1,D1
	ADD	D1,A0
	MOVEM.L	(A2),D0-D7/A1/A3-A6
	MOVEM.L	D0-D7/A1/A3-A6,(A0)
	MOVEM.L	52(A2),D0-D7
	MOVEM.L	D0-D7,52(A0)

	CLR	D1
	LEA	BARRE,A2
	LEA	BUFFER_RAST,A0
	LEA	Y_DAT+60,A1
	ADDA.L	POINTEUR,A1
	MOVE.B	(A1),D1
	LSL	#1,D1
	ADD	D1,A0
	MOVEM.L	(A2),D0-D7/A1/A3-A6
	MOVEM.L	D0-D7/A1/A3-A6,(A0)
	MOVEM.L	52(A2),D0-D7
	MOVEM.L	D0-D7,52(A0)

	CLR	D1
	LEA	BARRE,A2
	LEA	BUFFER_RAST,A0
	LEA	Y_DAT+66,A1
	ADDA.L	POINTEUR,A1
	MOVE.B	(A1),D1
	LSL	#1,D1
	ADD	D1,A0
	MOVEM.L	(A2),D0-D7/A1/A3-A6
	MOVEM.L	D0-D7/A1/A3-A6,(A0)
	MOVEM.L	52(A2),D0-D7
	MOVEM.L	D0-D7,52(A0)

	CLR	D1
	LEA	BARRE,A2
	LEA	BUFFER_RAST,A0
	LEA	Y_DAT+72,A1
	ADDA.L	POINTEUR,A1
	MOVE.B	(A1),D1
	LSL	#1,D1
	ADD	D1,A0
	MOVEM.L	(A2),D0-D7/A1/A3-A6
	MOVEM.L	D0-D7/A1/A3-A6,(A0)
	MOVEM.L	52(A2),D0-D7
	MOVEM.L	D0-D7,52(A0)

	CLR	D1
	LEA	BARRE,A2
	LEA	BUFFER_RAST,A0
	LEA	Y_DAT+78,A1
	ADDA.L	POINTEUR,A1
	MOVE.B	(A1),D1
	LSL	#1,D1
	ADD	D1,A0
	MOVEM.L	(A2),D0-D7/A1/A3-A6
	MOVEM.L	D0-D7/A1/A3-A6,(A0)
	MOVEM.L	52(A2),D0-D7
	MOVEM.L	D0-D7,52(A0)


	LEA	BUFFER_RAST,A0
	ADD.L	#1,POINTEUR	9

;	TF=1940-8

	DCB	4295-1940+8-4-19-19,$4E71
	
;	SF	$FFFF8240.W
	
	
	MOVE.B	#0,$FFFF820A.W
	DCB	18,$4E71
	MOVE.B	#2,$FFFF820A.W


	ADDQ.L	#1,TPS
	CMPI.L	#40,TPS
	BPL.S	GNAGNA

	MOVEQ	#0,D0
	MOVEQ	#0,D1
	MOVEQ	#0,D2
	MOVEQ	#0,D3
	MOVEQ	#0,D4
	MOVEQ	#0,D5
	MOVEQ	#0,D6
	MOVEQ	#0,D7
	MOVEM.L	D0-D7,$FFFF8240.W
	BRA.S	PAS_COUL

GNAGNA  

	MOVEM.L	PALET,D0-D7
	MOVEM.L	D0-D7,$FFFF8240.W

	MOVE.B	#1,$FFFFFA21.W
	MOVE.B	#8,$FFFFFA1B.W

PAS_COUL
;	CMPI.B  #$3B,$FFFFFC02.W
;        BEQ.S LM
;        BRA.S LK
;LM	MOVE.W  #$777,$FFFF8240.W
;
;LK	CMPI.B	#$3C,$FFFFFC02.W
;	BEQ	OOPS





	MOVE.L	SCREEN1,A6
	ADDA.L	#160*304,A6
	MOVEQ	#0,D0
	MOVEQ	#0,D1
	MOVEQ	#0,D2
	MOVEQ	#0,D3
	MOVEQ	#0,D4
	MOVEQ	#0,D5
	MOVEQ	#0,D6
	MOVEQ	#0,D7
INC	SET	0
	REPT	8
	MOVEM.L	D0-D7,INC(A6)
	MOVEM.L	D0-D7,INC+32(A6)
	MOVEM.L	D0-D7,INC+64(A6)
	MOVEM.L	D0-D7,INC+96(A6)
	MOVEM.L	D0-D7,INC+128(A6)
	MOVEM.L	D0-D1,INC+150(A6)
INC	SET	INC+160
	ENDR

	CLR.L	AUGMENTATION
	MOVEQ	#7,D7


PAR_ICI MOVEQ   #0,D1			*1
	MOVEA.L	MES_PNT3,A2		*5
	CMPI.B	#-1,4816(A2)		*4
	BEQ	 AGAIN3			*2 SI FAUX
					*3 SI OUI
        MOVE.L  (A2)+,KLM		*7
	MOVE.L  (A2)+,KLM2		*7
        MOVE.L  (A2)+,X_VALUE		*7
	MOVE.L  (A2)+,Y_VALUE		*7

        MOVE.L  320(A2),KLMB		*7
	MOVE.L  324(A2),KLM2B		*7
        MOVE.L  328(A2),X_VALUEB		*7

        MOVE.L  640(A2),KLMC		*7
	MOVE.L  644(A2),KLM2C		*7
        MOVE.L  648(A2),X_VALUEC		*7

        MOVE.L  960(A2),KLMD		*7
	MOVE.L  964(A2),KLM2D		*7
        MOVE.L  968(A2),X_VALUED		*7

        MOVE.L  1280(A2),KLME		*7
	MOVE.L  1284(A2),KLM2E		*7
        MOVE.L  1288(A2),X_VALUEE		*7

        MOVE.L  1600(A2),KLMF		*7
	MOVE.L  1604(A2),KLM2F		*7
        MOVE.L  1608(A2),X_VALUEF		*7

        MOVE.L  1920(A2),KLMG		*7
	MOVE.L  1924(A2),KLM2G		*7
        MOVE.L  1928(A2),X_VALUEG		*7

        MOVE.L  2240(A2),KLMH		*7
	MOVE.L  2244(A2),KLM2H		*7
        MOVE.L  2248(A2),X_VALUEH		*7

        MOVE.L  2560(A2),KLMI		*7
	MOVE.L  2564(A2),KLM2I		*7
        MOVE.L  2568(A2),X_VALUEI		*7

        MOVE.L  2880(A2),KLMJ		*7
	MOVE.L  2884(A2),KLM2J		*7
        MOVE.L  2888(A2),X_VALUEJ		*7

        MOVE.L  3200(A2),KLMK		*7
	MOVE.L  3204(A2),KLM2K		*7
        MOVE.L  3208(A2),X_VALUEK		*7

        MOVE.L  3520(A2),KLML		*7
	MOVE.L  3524(A2),KLM2L		*7
        MOVE.L  3528(A2),X_VALUEL		*7

        MOVE.L  3840(A2),KLMM		*7
	MOVE.L  3844(A2),KLM2M		*7
        MOVE.L  3848(A2),X_VALUEM		*7

        MOVE.L  4160(A2),KLMN		*7
	MOVE.L  4164(A2),KLM2N		*7
        MOVE.L  4168(A2),X_VALUEN		*7

        MOVE.L  4480(A2),KLMO		*7
	MOVE.L  4484(A2),KLM2O		*7
        MOVE.L  4488(A2),X_VALUEO		*7

        MOVE.L  4800(A2),KLMP		*7
	MOVE.L  4804(A2),KLM2P		*7
        MOVE.L  4808(A2),X_VALUEP		*7





	MOVE.L	A2,MES_PNT3
	REPT	11
	NOP
	ENDR

        BRA   LA_SUITE3		*3

	*= 46+2

AGAIN3	MOVE.L	#MES_F3,MES_PNT3	*7
        MOVEQ   #0,D1			*1
	MOVEA.L	MES_PNT3,A2		*5
		*3 SI OUI
		*3 SI OUI
        MOVE.L  (A2)+,KLM		*7
	MOVE.L  (A2)+,KLM2		*7
        MOVE.L  (A2)+,X_VALUE		*7
	MOVE.L  (A2)+,Y_VALUE		*7

        MOVE.L  320(A2),KLMB		*7
	MOVE.L  324(A2),KLM2B		*7
        MOVE.L  328(A2),X_VALUEB		*7

        MOVE.L  640(A2),KLMC		*7
	MOVE.L  644(A2),KLM2C		*7
        MOVE.L  648(A2),X_VALUEC		*7

        MOVE.L  960(A2),KLMD		*7
	MOVE.L  964(A2),KLM2D		*7
        MOVE.L  968(A2),X_VALUED		*7

        MOVE.L  1280(A2),KLME		*7
	MOVE.L  1284(A2),KLM2E		*7
        MOVE.L  1288(A2),X_VALUEE		*7

        MOVE.L  1600(A2),KLMF		*7
	MOVE.L  1604(A2),KLM2F		*7
        MOVE.L  1608(A2),X_VALUEF		*7

        MOVE.L  1920(A2),KLMG		*7
	MOVE.L  1924(A2),KLM2G		*7
        MOVE.L  1928(A2),X_VALUEG		*7

        MOVE.L  2240(A2),KLMH		*7
	MOVE.L  2244(A2),KLM2H		*7
        MOVE.L  2248(A2),X_VALUEH		*7

        MOVE.L  2560(A2),KLMI		*7
	MOVE.L  2564(A2),KLM2I		*7
        MOVE.L  2568(A2),X_VALUEI		*7

        MOVE.L  2880(A2),KLMJ		*7
	MOVE.L  2884(A2),KLM2J		*7
        MOVE.L  2888(A2),X_VALUEJ		*7

        MOVE.L  3200(A2),KLMK		*7
	MOVE.L  3204(A2),KLM2K		*7
        MOVE.L  3208(A2),X_VALUEK		*7

        MOVE.L  3520(A2),KLML		*7
	MOVE.L  3524(A2),KLM2L		*7
        MOVE.L  3528(A2),X_VALUEL		*7

        MOVE.L  3840(A2),KLMM		*7
	MOVE.L  3844(A2),KLM2M		*7
        MOVE.L  3848(A2),X_VALUEM		*7

        MOVE.L  4160(A2),KLMN		*7
	MOVE.L  4164(A2),KLM2N		*7
        MOVE.L  4168(A2),X_VALUEN		*7

        MOVE.L  4480(A2),KLMO		*7
	MOVE.L  4484(A2),KLM2O		*7
        MOVE.L  4488(A2),X_VALUEO		*7

        MOVE.L  4800(A2),KLMP		*7
	MOVE.L  4804(A2),KLM2P		*7
        MOVE.L  4808(A2),X_VALUEP		*7

        MOVE.L	A2,MES_PNT3		*5

	*=46+13


LA_SUITE3
	MOVE.L	SCREEN1,A6
	ADDA.L	#160*304,A6
	ADDA.L	AUGMENTATION,A6
        MOVEA.L   KLM2,A1       		*5
	MOVEA.L	  KLM,A2			*5
	ADDA.L	X_VALUE,A6			*6


INC	SET	0
	MOVEM.L	INC(A6),D0-D3
	AND.L	(A1)+,D0	
	AND.L	(A1)+,D1
	AND.L	(A1)+,D2
	AND.L	(A1)+,D3
	OR.L	(A2)+,D0
	OR.L	(A2)+,D1
	OR.L	(A2)+,D2
	OR.L	(A2)+,D3
	MOVEM.L	D0-D3,INC(A6)		*19

;	LEA	64(A1),A1
;	LEA	64(A2),A2
INC	SET	INC+160


	MOVE.L	SCREEN1,A6
	ADDA.L	#160*304,A6
	ADDA.L	AUGMENTATION,A6
        MOVEA.L   KLM2B,A1       		*5
	MOVEA.L	  KLMB,A2			*5
	ADDA.L	X_VALUEB,A6			*6


INC	SET	0
	MOVEM.L	INC(A6),D0-D3
	AND.L	(A1)+,D0	
	AND.L	(A1)+,D1
	AND.L	(A1)+,D2
	AND.L	(A1)+,D3
	OR.L	(A2)+,D0
	OR.L	(A2)+,D1
	OR.L	(A2)+,D2
	OR.L	(A2)+,D3
	MOVEM.L	D0-D3,INC(A6)		*19

;	LEA	64(A1),A1
;	LEA	64(A2),A2
INC	SET	INC+160

	MOVE.L	SCREEN1,A6
	ADDA.L	#160*304,A6
	ADDA.L	AUGMENTATION,A6
        MOVEA.L   KLM2C,A1       		*5
	MOVEA.L	  KLMC,A2			*5
	ADDA.L	X_VALUEC,A6			*6


INC	SET	0
	MOVEM.L	INC(A6),D0-D3
	AND.L	(A1)+,D0	
	AND.L	(A1)+,D1
	AND.L	(A1)+,D2
	AND.L	(A1)+,D3
	OR.L	(A2)+,D0
	OR.L	(A2)+,D1
	OR.L	(A2)+,D2
	OR.L	(A2)+,D3
	MOVEM.L	D0-D3,INC(A6)		*19

;	LEA	64(A1),A1
;	LEA	64(A2),A2
INC	SET	INC+160

	MOVE.L	SCREEN1,A6
	ADDA.L	#160*304,A6
	ADDA.L	AUGMENTATION,A6
        MOVEA.L   KLM2D,A1       		*5
	MOVEA.L	  KLMD,A2			*5
	ADDA.L	X_VALUED,A6			*6


INC	SET	0
	MOVEM.L	INC(A6),D0-D3
	AND.L	(A1)+,D0	
	AND.L	(A1)+,D1
	AND.L	(A1)+,D2
	AND.L	(A1)+,D3
	OR.L	(A2)+,D0
	OR.L	(A2)+,D1
	OR.L	(A2)+,D2
	OR.L	(A2)+,D3
	MOVEM.L	D0-D3,INC(A6)		*19

;	LEA	64(A1),A1
;	LEA	64(A2),A2
INC	SET	INC+160



INC	SET	0
	MOVE.L	SCREEN1,A6
	ADDA.L	#160*304,A6
	ADDA.L	AUGMENTATION,A6
        MOVEA.L   KLM2E,A1       		*5
	MOVEA.L	  KLME,A2			*5
	ADDA.L	X_VALUEE,A6			*6
	MOVEM.L	INC(A6),D0-D3
	AND.L	(A1)+,D0	
	AND.L	(A1)+,D1
	AND.L	(A1)+,D2
	AND.L	(A1)+,D3
	OR.L	(A2)+,D0
	OR.L	(A2)+,D1
	OR.L	(A2)+,D2
	OR.L	(A2)+,D3
	MOVEM.L	D0-D3,INC(A6)		*19
	MOVE.L	SCREEN1,A6
	ADDA.L	#160*304,A6
	ADDA.L	AUGMENTATION,A6
        MOVEA.L   KLM2F,A1       		*5
	MOVEA.L	  KLMF,A2			*5
	ADDA.L	X_VALUEF,A6			*6
	MOVEM.L	INC(A6),D0-D3
	AND.L	(A1)+,D0	
	AND.L	(A1)+,D1
	AND.L	(A1)+,D2
	AND.L	(A1)+,D3
	OR.L	(A2)+,D0
	OR.L	(A2)+,D1
	OR.L	(A2)+,D2
	OR.L	(A2)+,D3
	MOVEM.L	D0-D3,INC(A6)		*19
	MOVE.L	SCREEN1,A6
	ADDA.L	#160*304,A6
	ADDA.L	AUGMENTATION,A6
        MOVEA.L   KLM2G,A1       		*5
	MOVEA.L	  KLMG,A2			*5
	ADDA.L	X_VALUEG,A6			*6
	MOVEM.L	INC(A6),D0-D3
	AND.L	(A1)+,D0	
	AND.L	(A1)+,D1
	AND.L	(A1)+,D2
	AND.L	(A1)+,D3
	OR.L	(A2)+,D0
	OR.L	(A2)+,D1
	OR.L	(A2)+,D2
	OR.L	(A2)+,D3
	MOVEM.L	D0-D3,INC(A6)		*19
	MOVE.L	SCREEN1,A6
	ADDA.L	#160*304,A6
	ADDA.L	AUGMENTATION,A6
        MOVEA.L   KLM2H,A1       		*5
	MOVEA.L	  KLMH,A2			*5
	ADDA.L	X_VALUEH,A6			*6
	MOVEM.L	INC(A6),D0-D3
	AND.L	(A1)+,D0	
	AND.L	(A1)+,D1
	AND.L	(A1)+,D2
	AND.L	(A1)+,D3
	OR.L	(A2)+,D0
	OR.L	(A2)+,D1
	OR.L	(A2)+,D2
	OR.L	(A2)+,D3
	MOVEM.L	D0-D3,INC(A6)		*19

	MOVE.L	SCREEN1,A6
	ADDA.L	#160*304,A6
	ADDA.L	AUGMENTATION,A6
        MOVEA.L   KLM2I,A1       		*5
	MOVEA.L	  KLMI,A2			*5
	ADDA.L	X_VALUEI,A6			*6


INC	SET	0
	MOVEM.L	INC(A6),D0-D3
	AND.L	(A1)+,D0	
	AND.L	(A1)+,D1
	AND.L	(A1)+,D2
	AND.L	(A1)+,D3
	OR.L	(A2)+,D0
	OR.L	(A2)+,D1
	OR.L	(A2)+,D2
	OR.L	(A2)+,D3
	MOVEM.L	D0-D3,INC(A6)		*19

;	LEA	64(A1),A1
;	LEA	64(A2),A2
INC	SET	INC+160


	MOVE.L	SCREEN1,A6
	ADDA.L	#160*304,A6
	ADDA.L	AUGMENTATION,A6
        MOVEA.L   KLM2J,A1       		*5
	MOVEA.L	  KLMJ,A2			*5
	ADDA.L	X_VALUEJ,A6			*6


INC	SET	0
	MOVEM.L	INC(A6),D0-D3
	AND.L	(A1)+,D0	
	AND.L	(A1)+,D1
	AND.L	(A1)+,D2
	AND.L	(A1)+,D3
	OR.L	(A2)+,D0
	OR.L	(A2)+,D1
	OR.L	(A2)+,D2
	OR.L	(A2)+,D3
	MOVEM.L	D0-D3,INC(A6)		*19

;	LEA	64(A1),A1
;	LEA	64(A2),A2
INC	SET	INC+160

	MOVE.L	SCREEN1,A6
	ADDA.L	#160*304,A6
	ADDA.L	AUGMENTATION,A6
        MOVEA.L   KLM2K,A1       		*5
	MOVEA.L	  KLMK,A2			*5
	ADDA.L	X_VALUEK,A6			*6


INC	SET	0
	MOVEM.L	INC(A6),D0-D3
	AND.L	(A1)+,D0	
	AND.L	(A1)+,D1
	AND.L	(A1)+,D2
	AND.L	(A1)+,D3
	OR.L	(A2)+,D0
	OR.L	(A2)+,D1
	OR.L	(A2)+,D2
	OR.L	(A2)+,D3
	MOVEM.L	D0-D3,INC(A6)		*19

;	LEA	64(A1),A1
;	LEA	64(A2),A2
INC	SET	INC+160

	MOVE.L	SCREEN1,A6
	ADDA.L	#160*304,A6
	ADDA.L	AUGMENTATION,A6
        MOVEA.L   KLM2L,A1       		*5
	MOVEA.L	  KLML,A2			*5
	ADDA.L	X_VALUEL,A6			*6


INC	SET	0
	MOVEM.L	INC(A6),D0-D3
	AND.L	(A1)+,D0	
	AND.L	(A1)+,D1
	AND.L	(A1)+,D2
	AND.L	(A1)+,D3
	OR.L	(A2)+,D0
	OR.L	(A2)+,D1
	OR.L	(A2)+,D2
	OR.L	(A2)+,D3
	MOVEM.L	D0-D3,INC(A6)		*19

;	LEA	64(A1),A1
;	LEA	64(A2),A2
INC	SET	INC+160



INC	SET	0
	MOVE.L	SCREEN1,A6
	ADDA.L	#160*304,A6
	ADDA.L	AUGMENTATION,A6
        MOVEA.L   KLM2M,A1       		*5
	MOVEA.L	  KLMM,A2			*5
	ADDA.L	X_VALUEM,A6			*6
	MOVEM.L	INC(A6),D0-D3
	AND.L	(A1)+,D0	
	AND.L	(A1)+,D1
	AND.L	(A1)+,D2
	AND.L	(A1)+,D3
	OR.L	(A2)+,D0
	OR.L	(A2)+,D1
	OR.L	(A2)+,D2
	OR.L	(A2)+,D3
	MOVEM.L	D0-D3,INC(A6)		*19
	MOVE.L	SCREEN1,A6
	ADDA.L	#160*304,A6
	ADDA.L	AUGMENTATION,A6
        MOVEA.L   KLM2N,A1       		*5
	MOVEA.L	  KLMN,A2			*5
	ADDA.L	X_VALUEN,A6			*6
	MOVEM.L	INC(A6),D0-D3
	AND.L	(A1)+,D0	
	AND.L	(A1)+,D1
	AND.L	(A1)+,D2
	AND.L	(A1)+,D3
	OR.L	(A2)+,D0
	OR.L	(A2)+,D1
	OR.L	(A2)+,D2
	OR.L	(A2)+,D3
	MOVEM.L	D0-D3,INC(A6)		*19
	MOVE.L	SCREEN1,A6
	ADDA.L	#160*304,A6
	ADDA.L	AUGMENTATION,A6
        MOVEA.L   KLM2O,A1       		*5
	MOVEA.L	  KLMO,A2			*5
	ADDA.L	X_VALUEO,A6			*6
	MOVEM.L	INC(A6),D0-D3
	AND.L	(A1)+,D0	
	AND.L	(A1)+,D1
	AND.L	(A1)+,D2
	AND.L	(A1)+,D3
	OR.L	(A2)+,D0
	OR.L	(A2)+,D1
	OR.L	(A2)+,D2
	OR.L	(A2)+,D3
	MOVEM.L	D0-D3,INC(A6)		*19
	MOVE.L	SCREEN1,A6
	ADDA.L	#160*304,A6
	ADDA.L	AUGMENTATION,A6
        MOVEA.L   KLM2P,A1       		*5
	MOVEA.L	  KLMP,A2			*5
	ADDA.L	X_VALUEP,A6			*6
	MOVEM.L	INC(A6),D0-D3
	AND.L	(A1)+,D0	
	AND.L	(A1)+,D1
	AND.L	(A1)+,D2
	AND.L	(A1)+,D3
	OR.L	(A2)+,D0
	OR.L	(A2)+,D1
	OR.L	(A2)+,D2
	OR.L	(A2)+,D3
	MOVEM.L	D0-D3,INC(A6)		*19

	ADD.L	#160,AUGMENTATION
	DBF	D7,PAR_ICI




	MOVE.L	SCREEN1,A6
	ADDA.L	#160*304,A6
	MOVE.L	SCREEN1,A2
	SUBA.L	#160*8,A2
INC	SET	0
	REPT	8
	MOVEM.L	INC(A6),D0-D7/A3-A5
	MOVEM.L	D0-D7/A3-A5,INC(A2)

	MOVEM.L	INC+44(A6),D0-D7/A3-A5
	MOVEM.L	D0-D7/A3-A5,INC+44(A2)

	MOVEM.L	INC+88(A6),D0-D7/A3-A5
	MOVEM.L	D0-D7/A3-A5,INC+88(A2)

	MOVEM.L	INC+144-12(A6),D0-D6
	MOVEM.L	D0-D6,INC+144-12(A2)
INC	SET	INC+160
	ENDR




	CMPI.L	#8,NB_PART
	BNE	SUITV0
	BSR	TEST_LET
	CLR.L	NB_PART
SUITV0	BSR	SCROLL

	MOVE.L	SCREEN1,A1
	LEA	160*192(A1),A1
	LEA	160*30(A1),A1
	ADDA.L	AUGMENTATION,A1
	MOVE.L	ADRSAVE,A6
	REPT	40*8
	MOVE.L	(A6)+,(A1)+
	ENDR

	MOVE.L	SCREEN1,A1
	LEA	160*200(A1),A1
	LEA	160*30(A1),A1
	ADDA.L	AUGMENTATION,A1
	MOVE.L	ADRSAVE,A6
	REPT	40*8
	MOVE.L	(A1)+,(A6)+
	ENDR

	MOVE.L	SCREEN1,A1
	LEA	160*200(A1),A1
	LEA	160*30(A1),A1
	ADDA.L	AUGMENTATION,A1
	MOVE.L	ADRTXT,A6
N	SET	0
	REPT	20*8
	MOVE	N(A6),D0
	OR	D0,N(A1)
N	SET	N+8
	ENDR









	ADDI.L  #1280,SCREEN1
	MOVE.L  SCREEN1,D0
	MOVE.L  SCREEN2,D1
	CMP.L   D1,D0
	BNE     OOPS
	MOVE.L  SCREEN2,SCREEN1
	SUBI.L  #49920,SCREEN1
OOPS	MOVE.B  SCREEN1+1,$FFFF8201.W
	MOVE.B  SCREEN1+2,$FFFF8203.W

	JSR	ZIK+8


	CMPI.B	#$39,$FFFFFC02.W
	BEQ	FIN
;        ST	$FFFF8240.W
	RTE


FIN:	
        MOVE.B  #2,$FFFF820A.W
	MOVE.B	#8,$FFFFFC02.W
	MOVE.B	MFP1,$FFFFFA07.W
	MOVE.B	MFP2,$FFFFFA09.W
	MOVE.B	MFP3,$FFFFFA0F.W
	MOVE.B	MFP4,$FFFFFA13.W
	MOVE.B	MFP5,$FFFFFA1B.W
	MOVE.B	MFP6,$FFFFFA21.W
	
	MOVE.L	ANC_VBL,$70
	MOVE.L	ANC_TB,$120


;	MOVEQ	#0,D0
;	JSR	ZIK

	
	LEA.L	ANC_PAL,A0
	MOVEM.L	(A0),D0-D7
	LEA.L	$FFFF8240.W,A0
	MOVEM.L	D0-D7,(A0)
	
	MOVE.W 	RES,-(SP)
	MOVE.L	ANC_ECR,-(SP)
	MOVE.L	ANC_ECR,-(SP)
	MOVE.W 	#5,-(SP)
	TRAP 	#14
	LEA.L 	12(SP),SP
	
	MOVE.L	SAUVE,-(SP)
	MOVE.W 	#$20,-(SP)
	TRAP 	#1
	ADDQ.L 	#6,SP
	

	CLR.W 	-(SP)
	TRAP	#1
	
	
	
TB0_IR	
	DS.B	20*227
;	CLR.B	$FFFFFA1B.W
;	MOVE.B	#1,$FFFFFA21.W
;	MOVE.B	#8,$FFFFFA1B.W
;	MOVE.L	#TB0_IR,$120
;	MOVE	(A0)+,$FFFF8240.W
;	BCLR	#0,$FFFFFA0F.W
;	RTE


TB1_IR	
	MOVE	(A0)+,$FFFF8240.W
     REPT 127-4+128
	NOP			
     ENDR
	MOVE.B	#0,$FFFF820A.W	
     REPT 8
     	NOP			
     ENDR
	MOVE.B	#2,$FFFF820A.W	
	CLR.B	$FFFFFA1B.W
	
	
	MOVE.L	#TB0_IR,$120	
	BCLR	#0,$FFFFFA0F.W	
	RTE			
	

PREDECALE:
          MOVE.L    LIGNES,D5
DECAL	MOVE.L	#3,D7
DECAL2
	MOVE.L	#19,D6
DECAL3
          roxl.w    152(a4)  * 1ER PLAN
          
          LEA	-8(A4),A4
          DBF	D6,DECAL3

      	LEA	152(A4),A4    
          
          
	LEA	2(A4),A4
	DBF	D7,DECAL2
	LEA	-6(A4),A4
          
          LEA.L   160(A4),A4
          DBF D5,DECAL
          RTS



SET_SCR:	move.l	#BUFFER,d0
	and.l	#$ffffff00,d0
	move.l	d0,SCREEN1
	add.l	#49920,d0
	move.l	d0,SCREEN2
	move.l	#BUFFERSCR,d0
	and.l	#$ffffff00,d0
	MOVE.L	D0,SCREEN3
	
	MOVE.L	#BUFSCR,D1
	MOVE.L	D1,ADRTXT
	MOVE.L	#BUFSAVE,D1
	MOVE.L	D1,ADRSAVE

	rts			

SWAP_SCR:	move.l	SCREEN1,d0	
	move.l	SCREEN2,SCREEN1		
	move.l	d0,SCREEN2		
	lsr.l	#8,d0		
	move.l	#$ffff8201,A6
	movep	d0,(A6)
	rts


ZIK	INCBIN	MADMAX52.BIN
DATA:	INCBIN	A:\I.PI1

	

TEXT1	DC.B	" HI, VIEWERS. THIS SCREEN WAS CODED BY "
	DC.B	"\ZAPPY/ FROM \HOLOCAUST/. IF YOU LIKE IT"
	DC.B	" - I DON'T, BUT THAT DON'T MEAN THE WHOLE"
	DC.B	" WORLD DOESN'T -, AND IF YOU'RE LOOKING FOR"
	DC.B	" GUEST APPEARANCES IN YOUR COMING-AWAY PRODUCTS,"
	DC.B	" THEN JUST CONTACT ME ON THE 3615 STMAG, OR 3615 GEN4,"
	DC.B	" BAL: ZAPPY      SO LONG, AND THANKS FOR...  "
	DC.B	"               ",$FF


FONT8_8	
	DC.B	0,0,0,0,0,0,0,0
	DC.B 24,24,48,48,0,96,96,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B 24,24,48,0,0,0,0,0
	DC.B 24,56,48,48,48,56,24,0
	DC.B 48,56,24,24,24,56,48,0
	DC.B 18,84,56,254,56,84,144,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B 0,0,0,0,48,48,96,0
	DC.B 0,0,0,126,126,0,0,0
	DC.B 0,0,0,0,0,48,48,0
	DC.B 254,0,252,0,248,0,240,0
	DC.B 124,198,206,214,230,198,124,0
	DC.B 24,56,56,24,24,60,60,0
 DC.B 60,94,102,12,24,54,126,0
 DC.B 126,126,6,28,6,126,124,0
 DC.B 28,60,108,204,254,254,12,0
 DC.B 126,126,64,124,6,126,124,0
 DC.B 60,102,96,124,102,102,60,0
 DC.B 126,118,76,12,24,24,24,0
 DC.B 60,102,102,60,102,102,60,0
 DC.B 60,102,102,62,6,6,60,0
 DC.B 0,0,48,48,0,48,48,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
 DC.B 60,102,102,12,0,24,24,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	124,230,230,254,230,230,230,0	;A
	DC.B	252,230,230,252,230,230,252,0	;B
	DC.B	124,230,224,224,224,230,124,0	;C
	DC.B	252,230,230,230,230,230,252,0	;D
	DC.B	254,224,224,248,224,224,254,0	;E
	DC.B	254,224,224,248,224,224,224,0	;F
	DC.B	124,230,224,224,238,230,124,0	;G
	DC.B	230,230,230,254,230,230,230,0	;H
	DC.B	124,56,56,56,56,56,124,0	;I
	DC.B	14,14,14,14,14,206,124,0	;J
	DC.B	230,238,252,248,252,238,230,0	;K
	DC.B	224,224,224,224,224,224,254,0	;L
	DC.B	198,238,246,230,230,230,230,0	;M
	DC.B	252,230,230,230,230,230,230,0	;N
	DC.B	124,230,230,230,230,230,124,0	;O
	DC.B	252,230,230,252,224,224,224,0	;P
	DC.B	121,230,230,230,238,252,118,0	;Q
	DC.B	252,230,230,252,236,230,230,0	;R
	DC.B	124,230,224,124,14,206,124,0	;S
	DC.B	254,56,56,56,56,56,56,0	;T
	DC.B	230,230,230,230,230,230,124,0	;U
	DC.B	230,230,230,230,230,124,56,0	;V
	DC.B	230,230,230,230,254,238,198,0	;W
	DC.B	198,238,124,56,124,238,198,0	;X
	DC.B	230,230,230,124,56,56,56,0	;Y
	DC.B	254,206,28,56,112,230,254,0	;Z
	DC.B	0,0,0,0,0,0,0,0
 DC.B 254,0,126,0,62,0,30,0


DATA_RAST	
	DC.L	$21FC0120
	DC.L	$31D88240
	DC.L	$08B80000
	DC.L	$FA0F4E73


BARRE	
	DC.W	$100,$200,$300,$400,$500,$600,$700
	DC.W	$710,$720,$730,$740,$750,$760,$770
	DC.W	$771,$772,$773,$774,$775,$776,$777

	DC.W	$776,$766,$666,$665,$655,$555,$554
	DC.W	$544,$444,$443,$433,$333,$332,$322
	DC.W	$222,$221,$211,$111,$110,$100,$000




BUFFER_RAST
	DCB	300,$000

Y_DAT
 DC.B 84
 DC.B 87
 DC.B 90
 DC.B 94
 DC.B 97
 DC.B 100
 DC.B 103
 DC.B 107
 DC.B 110
 DC.B 113
 DC.B 116
 DC.B 119
 DC.B 122
 DC.B 125
 DC.B 128
 DC.B 131
 DC.B 134
 DC.B 136
 DC.B 139
 DC.B 141
 DC.B 144
 DC.B 146
 DC.B 148
 DC.B 150
 DC.B 152
 DC.B 154
 DC.B 156
 DC.B 158
 DC.B 159
 DC.B 161
 DC.B 162
 DC.B 163
 DC.B 164
 DC.B 165
 DC.B 166
 DC.B 166
 DC.B 167
 DC.B 167
 DC.B 167
 DC.B 167
 DC.B 167
 DC.B 167
 DC.B 167
 DC.B 167
 DC.B 166
 DC.B 165
 DC.B 164
 DC.B 164
 DC.B 162
 DC.B 161
 DC.B 160
 DC.B 158
 DC.B 157
 DC.B 155
 DC.B 153
 DC.B 151
 DC.B 149
 DC.B 147
 DC.B 145
 DC.B 143
 DC.B 140
 DC.B 138
 DC.B 135
 DC.B 132
 DC.B 130
 DC.B 127
 DC.B 124
 DC.B 121
 DC.B 118
 DC.B 115
 DC.B 112
 DC.B 108
 DC.B 105
 DC.B 102
 DC.B 99
 DC.B 95
 DC.B 92
 DC.B 89
 DC.B 85
 DC.B 82
 DC.B 79
 DC.B 75
 DC.B 72
 DC.B 69
 DC.B 65
 DC.B 62
 DC.B 59
 DC.B 56
 DC.B 52
 DC.B 49
 DC.B 46
 DC.B 43
 DC.B 40
 DC.B 38
 DC.B 35
 DC.B 32
 DC.B 29
 DC.B 27
 DC.B 25
 DC.B 22
 DC.B 20
 DC.B 18
 DC.B 16
 DC.B 14
 DC.B 12
 DC.B 10
 DC.B 9
 DC.B 7
 DC.B 6
 DC.B 5
 DC.B 4
 DC.B 3
 DC.B 2
 DC.B 1
 DC.B 0
 DC.B 0
 DC.B 0
 DC.B 0
 DC.B 0
 DC.B 0
 DC.B 0
 DC.B 0
 DC.B 1
 DC.B 1
 DC.B 2
 DC.B 3
 DC.B 4
 DC.B 5
 DC.B 6
 DC.B 8
 DC.B 9
 DC.B 11
 DC.B 13
 DC.B 15
 DC.B 17
 DC.B 19
 DC.B 21
 DC.B 23
 DC.B 25
 DC.B 28
 DC.B 30
 DC.B 33
 DC.B 36
 DC.B 39
 DC.B 42
 DC.B 44
 DC.B 47
 DC.B 51
 DC.B 54
 DC.B 57
 DC.B 60
 DC.B 63
 DC.B 67
 DC.B 70
 DC.B 73
 DC.B 77
 DC.B 80
; DC.B 83
;
 DC.B 84
 DC.B 87
 DC.B 90
 DC.B 94
 DC.B 97
 DC.B 100
 DC.B 103
 DC.B 107
 DC.B 110
 DC.B 113
 DC.B 116
 DC.B 119
 DC.B 122
 DC.B 125
 DC.B 128
 DC.B 131
 DC.B 134
 DC.B 136
 DC.B 139
 DC.B 141
 DC.B 144
 DC.B 146
 DC.B 148
 DC.B 150
 DC.B 152
 DC.B 154
 DC.B 156
 DC.B 158
 DC.B 159
 DC.B 161
 DC.B 162
 DC.B 163
 DC.B 164
 DC.B 165
 DC.B 166
 DC.B 166
 DC.B 167
 DC.B 167
 DC.B 167
 DC.B 167
 DC.B 167
 DC.B 167
 DC.B 167
 DC.B 167
 DC.B 166
 DC.B 165
 DC.B 164
 DC.B 164
 DC.B 162
 DC.B 161
 DC.B 160
 DC.B 158
 DC.B 157
 DC.B 155
 DC.B 153
 DC.B 151
 DC.B 149
 DC.B 147
 DC.B 145
 DC.B 143
 DC.B 140
 DC.B 138
 DC.B 135
 DC.B 132
 DC.B 130
 DC.B 127
 DC.B 124
 DC.B 121
 DC.B 118
 DC.B 115
 DC.B 112
 DC.B 108
 DC.B 105
 DC.B 102
 DC.B 99
 DC.B 95
 DC.B 92
 DC.B 89
 DC.B 85
 DC.B 82
	DC.L	-1




MES_F3
	INCLUDE	COURBRAS.S

PALET	DC.W	$000,$002,$112,$223,$334,$445,$556,$667
	DC.W	$777,$772,$762,$650,$540,$430,$320,$210


	
 	SECTION BSS
 	EVEN

ADRTXT	DS.L	1
BUFSCR	DS.B	160*8
ADRSAVE	DS.L	1
BUFSAVE	DS.B	160*8
SAVER	DS.L	15
ADRLOGO DS.L    1
ADRFONT DS.L    1
POINTEUR	DS.L	1
MES_PNT DS.L    1
MES_PNT2 DS.L    1
BIDON   DS.L    1
F_PILE	DS.L 	128
D_PILE	DS.L 	1
SAUVE	DS.L	1
ANC_VBL DS.L	1
ANC_TB	DS.L	1
ANC_ECR	DS.L	1
RES	DS.W	1
ANC_PAL	DS.W	16
TPS	DS.L	1
MFP1	DS.B	1
MFP2	DS.B	1
MFP3	DS.B	1
MFP4	DS.B	1
MFP5	DS.B	1
MFP6	DS.B	1
VSYNC	DS.B	1

          DS.B  256
	  DS.B	160*8
BUFFER    DS.B  49920*2
          DS.B  256
BUFFERSCR	DS.B	160*8


SCREEN1:	ds.l	1
SCREEN2:	ds.l	1
SCREEN3		DS.L	1
AUGMENTATION	DS.L	1
MEM_LET:	ds.l	1
PART_AFF:	ds.l    1
SAVEA5A6	DS.L	2
POINTA4	DS.L	1
POINTA6	DS.L	1
SAVEA0	DS.L	1
COUL1	DS.W	1
COUL2	DS.W	1
COUL3	DS.W	1
PLUS	DS.L	1
LIGNES	DS.L	1

BUF1	DS.L	32
BUF2	DS.L	32
BUF3	DS.L	32
BUF4	DS.L	32
BUF5	DS.L	32
BUF6	DS.L	32
BUF7	DS.L	32
BUF8	DS.L	32
BUF9	DS.L	32
BUF10	DS.L	32
BUF11	DS.L	32
BUF12	DS.L	32
BUF13	DS.L	32
BUF14	DS.L	32
BUF15	DS.L	32
BUF16	DS.L	32
MASQ    DS.L    32
MASQ2	DS.L	32
MASQ3	DS.L	32

MASQ4	DS.L	32
MASQ5	DS.L	32
MASQ6	DS.L	32
MASQ7	DS.L	32
MASQ8	DS.L	32
MASQ9	DS.L	32
MASQ10	DS.L	32
MASQ11	DS.L	32
MASQ12	DS.L	32
MASQ13	DS.L	32
MASQ14	DS.L	32
MASQ15	DS.L	32
MASQ16	DS.L	32
MASQ17	DS.L	32

KLM		DS.L	1
KLM2		DS.L	1
Y_VALUE		DS.L	1
X_VALUE		DS.L	1

KLMB		DS.L	1
KLM2B		DS.L	1
Y_VALUEB	DS.L	1
X_VALUEB	DS.L	1


KLMC		DS.L	1
KLM2C		DS.L	1
Y_VALUEC	DS.L	1
X_VALUEC	DS.L	1


KLMD		DS.L	1
KLM2D		DS.L	1
Y_VALUED	DS.L	1
X_VALUED	DS.L	1


KLME		DS.L	1
KLM2E		DS.L	1
Y_VALUEE	DS.L	1
X_VALUEE	DS.L	1

KLMF		DS.L	1
KLM2F		DS.L	1
Y_VALUEF	DS.L	1
X_VALUEF	DS.L	1

KLMG		DS.L	1
KLM2G		DS.L	1
Y_VALUEG	DS.L	1
X_VALUEG	DS.L	1


KLMH		DS.L	1
KLM2H		DS.L	1
Y_VALUEH	DS.L	1
X_VALUEH	DS.L	1



KLMI		DS.L	1
KLM2I		DS.L	1
Y_VALUEI	DS.L	1
X_VALUEI	DS.L	1

KLMJ		DS.L	1
KLM2J		DS.L	1
Y_VALUEJ	DS.L	1
X_VALUEJ	DS.L	1

KLMK		DS.L	1
KLM2K		DS.L	1
Y_VALUEK	DS.L	1
X_VALUEK	DS.L	1

KLML		DS.L	1
KLM2L		DS.L	1
Y_VALUEL	DS.L	1
X_VALUEL	DS.L	1

KLMM		DS.L	1
KLM2M		DS.L	1
Y_VALUEM	DS.L	1
X_VALUEM	DS.L	1

KLMN		DS.L	1
KLM2N		DS.L	1
Y_VALUEN	DS.L	1
X_VALUEN	DS.L	1

KLMO		DS.L	1
KLM2O		DS.L	1
Y_VALUEO	DS.L	1
X_VALUEO	DS.L	1

KLMP		DS.L	1
KLM2P		DS.L	1
Y_VALUEP	DS.L	1
X_VALUEP	DS.L	1

MES_PNT3	DS.L	1
PNT	DS.L	1		
POINT2	DS.L	1
NB_PART	DS.L	1
BUF_LET	DS.B	(1*8)*2
