NB_PTS_X=80
NB_PTS_Y=25

	PEA	0.W
	move.w	#$20,-(sp)
	trap	#1
	addq.l	#6,sp

	CLR	-(SP)
	PEA	-1.W
	PEA	-1.W
	move.w	#5,-(sp)
	trap	#14
	lea.l	12(sp),sp
          LEA     ZIK+2688,A0 
          LEA     ZIK+12,A1 
          MOVE.L  A0,(A1) 
          MOVEQ   #6,D0 
          JSR	ZIK

	MOVE.L	#FIN,$8.W
	MOVE.L	#FIN,$C.W
	MOVE.L	#FIN,$10.W
	MOVE.L	#FIN,$14.W
	MOVE.L	#FIN,$18.W
	MOVE.L	#FIN,$1c.W
	MOVE.L	#FIN,$20.W
*********
	MOVEQ	#0,D0
	LEA	B_DP,A0
	LEA	CHAISE,A1
	MOVE	#31,D1
	MOVE.L	A0,(A1)+
LM	MOVE	(A0)+,D0
	CMPI	#$4E75,D0
	BNE.S	LM
	MOVE.L	A0,(A1)+
	DBF	D1,LM

	LEA	B_DPS,A1
	LEA	CHAISES,A2
	MOVE.L	A1,(A2)+
LLL	CMPI	#$9999,(A1)
	BEQ.S	DAC
	CMPI	#$4E75,(A1)
	BNE.S	COCO
	LEA	2(A1),A1
	MOVE.L	A1,(A2)+
	BRA.S	LLL
COCO	LEA	2(A1),A1
	BRA.S	LLL
DAC	

*****
PART_TWO
	LEA	B_DPS2,A2
	LEA	CHAISES2,A3
	MOVE.L	A2,(A3)+
	LEA	FONT8_8,A1
	MOVE	#94,D3
DO_FNT	ADDQ.L	#1,A1
	MOVEQ	#6,D2
DO_LINE	MOVEQ	#0,D0
	MOVE.B	(A1)+,D0
	MOVEQ	#7,D1
TEST_X	BTST	D1,D0
	BNE	BIT_A_UN
CONT	MOVE	#$5889,(A2)+
	DBF	D1,TEST_X
	MOVE	#$43E9,(A2)+
	MOVE	#(NB_PTS_X-8)*4,(A2)+
	DBF	D2,DO_LINE
	BRA	FINI
BIT_A_UN	MOVE	#$2451,(A2)+
	MOVE	#$4E92,(A2)+
	BRA	CONT
FINI	MOVE	#$4E75,(A2)+
	MOVE.L	A2,(A3)+
	DBF	D3,DO_FNT
ENDED
**********
	JSR	SET_SCR
*0000	40
*0001	42
*0010	44
*0011	46
*0100	48*
*0101	4A*
*0110	4C*
*0111	4E*
*1000	50
*1001	52
*1010	54
*1011	56
*1100	58*
*1101	5A*
*1110	5C*
*1111	5E*
*********
	MOVE	#$777,$FFFF8242.W
	MOVE	#$777,$FFFF8250.W
	
	move.l	SCREEN1,d0
	lsr.l	#8,d0
	move.l	#$ffff8201,a0
	movep	d0,(a0)
	JSR	EFF

	MOVE.L	SCREEN1,A0
	LEA	2+160*100(A0),A0
	MOVE.L	SCREEN2,A1
	LEA	2+160*100(A1),A1
	MOVE	#1999,D0
PLAN2	MOVE	#$FFFF,(A0)
	MOVE	#$FFFF,(A1)
	LEA	8(A0),A0
	LEA	8(A1),A1
	DBF	D0,PLAN2
	
	LEA	LOGO+34,A0
	MOVE.L	SCREEN1,A1
	LEA	32(A1),A1
	MOVE.L	SCREEN2,A2
	LEA	32(A2),A2
	MOVE	#(40*100)-1,D0
COPLOG	MOVE.L	(A0),(A1)+
	MOVE.L	(A0)+,(A2)+
	DBF	D0,COPLOG
	
	MOVE	#$2700,SR
	MOVE.B	$FFFFFA07.W,MFP1
	MOVE.B	$FFFFFA09.W,MFP2
	MOVE.B	$FFFFFA0F.W,MFP3
	MOVE.B	$FFFFFA13.W,MFP4
	MOVE.B	$FFFFFA1B.W,MFP5
	MOVE.B	$FFFFFA21.W,MFP6
	MOVE.B	$FFFFFA15.W,MFP7
	MOVE.B	$FFFFFA17.W,MFP8
	MOVE.B	$FFFFFA19.W,MFP9
	MOVE.B	$FFFFFA1F.W,MFP10

	CLR.B	$FFFFFA07.W
	CLR.B	$FFFFFA09.W
	CLR.B	$FFFFFA13.W
	CLR.B	$FFFFFA15.W
	
	MOVE.L	$70.W,ANC_VBL
	MOVE.L	#VBL_IR,$70.W
	MOVE.L	$120.W,ANC_TB
	MOVE.L	#TB0_IR,$120.W
	
	MOVE.B	#$12,$FFFFFC02.W
	
	CLR.B	$FFFFFA1B.W
	BSET	#0,$FFFFFA07.W
	BSET	#0,$FFFFFA13.W


	LEA	CHAISE,A1
	MOVE.L	(A1),A1
	MOVEM.L	(A1),D0-D7
	MOVE.L	SCREEN1,A0
	JSR	8*4(A1)
	MOVE.L	SCREEN2,A0
	JSR	8*4(A1)
	
	LEA	CHAISE+4,A1
	MOVE.L	A1,SAVEA1
	MOVE	#$2300,SR
J	JMP	J
SAVEA1	DC.L	0
VBL_IR	CLR.B	$FFFFFA1B.W
	MOVE.L	#TB0_IR,$120.W
	MOVE.B	#100,$FFFFFA21.W
	MOVE.B	#8,$FFFFFA1B.W
	MOVEM.L	LOGO+2,D0-D7
	MOVEM.L	D0-D7,$FFFF8240.W
	JSR	ZIK+8
	MOVE.L	SAVEA1,A1
	CMPI.B	#$F,$FFFFFC02.W
	BNE.S	NO_TIM
	ST	$FFFF8240.W
NO_TIM	
	MOVE.L	(A1)+,A2
	CMPI.L	#0,-4(A1)
	BNE.S	ROUL
	LEA	CHAISE+4,A1
	MOVE.L	(A1)+,A2
ROUL	MOVEM.L	(A2),D0-D7
	MOVE.L	SCREEN1,A0
	JSR	8*4(A2)
	MOVE.L	SCREEN2,A0
	JSR	8*4(A2)
	MOVE.L	A1,SAVEA1
VBLROUTINE
	MOVE.L	SCREEN1,A0
	LEA	4+160*100(A0),A0
	MOVE	#99,D0
EFS	CLR	(A0)
	CLR	8(A0)
	CLR	16(A0)
	CLR	24(A0)
	CLR	32(A0)
	CLR	40(A0)
	CLR	48(A0)
	CLR	56(A0)
	CLR	64(A0)
	CLR	72(A0)
	CLR	80(A0)
	CLR	88(A0)
	CLR	96(A0)
	CLR	104(A0)
	CLR	112(A0)
	CLR	120(A0)
	CLR	128(A0)
	CLR	136(A0)
	CLR	144(A0)
	CLR	152(A0)
	LEA	160(A0),A0
	DBF	D0,EFS

	LEA	TEXTE,A3
	ADDA.L	PNT_TXT,A3
	CMPI.B	#-1,10(A3)
	BNE.S	OKAY
	CLR.L	PNT_TXT
	MOVE.L	#7*4,PNT_TXT2
	LEA	TEXTE,A3
	CLR	MODIF
OKAY	MOVE	#((NB_PTS_X+1)/8)-3,D1
ICI	LEA	CHAISES,A1
MOD	EQU	*+2
	LEA	80*4*19(A1),A1
	ADDA.L	PNT_TXT2,A1
MODIF	EQU	*+2
	LEA	0(A1),A1
	LEA	CHAISES2,A2
	MOVEQ	#0,D0
	MOVE.B	(A3)+,D0
	SUBI.L	#32,D0
	LSL	#2,D0
	ADDA.L	D0,A2
	MOVE.L	(A2),A2
	MOVE.L	SCREEN1,A0
	LEA	160*15+4(A0),A0
	JSR	(A2)
	ADD	#4*8,MODIF
	DBF	D1,ICI
;	MOVE	#7,-(SP)
;	TRAP	#1
;	ADDQ.L	#2,SP
	CLR	MODIF
	SUBQ.L	#4,PNT_TXT2
	CMPI.L	#-4,PNT_TXT2
	BNE.S	LETSDOIT
	MOVE.L	#7*4,PNT_TXT2
	ADDQ.L	#1,PNT_TXT
LETSDOIT
SUITE	move.l	SCREEN1,d0
	MOVE.L	SCREEN2,SCREEN1
	MOVE.L	D0,SCREEN2
	lsr.l	#8,d0
	move.l	#$ffff8201,a0
	movep	d0,(a0)
	CMPI.B	#$3B,$FFFFFC02.W
	BNE.S	KKQ
	CMPI	#80*4*19,MOD
	BGE.S	KKQ
	ADD	#80*4,MOD
KKQ	CMPI.B	#$3C,$FFFFFC02.W
	BNE.S	KKQ2
	CMPI	#0,MOD
	BLE.S	KKQ2
	SUB	#80*4,MOD
KKQ2	SF	$FFFF8240.W
	CMPI.B	#$39,$FFFFFC02.W
	BEQ.S	FIN
	RTE
FIN:
	MOVE	#$2700,SR
	MOVE.B	#8,$FFFFFC02.W
	MOVE.B	MFP1,$FFFFFA07.W
	MOVE.B	MFP2,$FFFFFA09.W
	MOVE.B	MFP3,$FFFFFA0F.W
	MOVE.B	MFP4,$FFFFFA13.W
	MOVE.B	MFP5,$FFFFFA1B.W
	MOVE.B	MFP6,$FFFFFA21.W
	MOVE.B	MFP7,$FFFFFA15.W
	MOVE.B	MFP8,$FFFFFA17.W
	MOVE.B	MFP9,$FFFFFA19.W
	MOVE.B	MFP10,$FFFFFA1F.W
	MOVE.L	ANC_TB,$70.W
	MOVE.L	ANC_VBL,$70.W
	MOVE	#$2300,SR

	JSR	ZIK+4
	MOVE.L	#$8080000,$FFFF8800.W
	MOVE.L	#$9090000,$FFFF8800.W
	MOVE.L	#$A0A0000,$FFFF8800.W

	BSET	#0,$484.W
	BSET	#1,$484.W
	BSET	#2,$484.W

	MOVE.B	#8,$FFFFFC02.W
	MOVE.B	#2,$FFFF820A.W
	
	PEA	0.W
	TRAP	#1

TB0_IR
 	MOVE	#$112,$FFFF8246.W
	MOVE	#$112,$FFFF8254.W
	MOVE	#$001,$FFFF8244.W

	MOVE	#$100,$FFFF8248.W
	MOVE	#$100,$FFFF824A.W
	MOVE	#$100,$FFFF824C.W
	MOVE	#$100,$FFFF824E.W
	MOVE	#$100,$FFFF8258.W
	MOVE	#$100,$FFFF825A.W
	MOVE	#$100,$FFFF825C.W
	MOVE	#$100,$FFFF825E.W

	CLR.B	$FFFFFA1B.W
	MOVE.L	#TB1_IR,$120.W
	MOVE.B	#5,$FFFFFA21.W
	MOVE.B	#8,$FFFFFA1B.W
	BCLR	#0,$FFFFFA0F.W
	RTE	
TB1_IR
 	MOVE	#$223,$FFFF8246.W
	MOVE	#$223,$FFFF8254.W
	MOVE	#$002,$FFFF8244.W

	MOVE	#$200,$FFFF8248.W
	MOVE	#$200,$FFFF824A.W
	MOVE	#$200,$FFFF824C.W
	MOVE	#$200,$FFFF824E.W
	MOVE	#$200,$FFFF8258.W
	MOVE	#$200,$FFFF825A.W
	MOVE	#$200,$FFFF825C.W
	MOVE	#$200,$FFFF825E.W

	CLR.B	$FFFFFA1B.W
	MOVE.L	#TB7_IR,$120.W
	MOVE.B	#5,$FFFFFA21.W
	MOVE.B	#8,$FFFFFA1B.W
	BCLR	#0,$FFFFFA0F.W
	RTE	
TB7_IR	
	MOVE	#$334,$FFFF8246.W
	MOVE	#$334,$FFFF8254.W
	MOVE	#$003,$FFFF8244.W

	MOVE	#$300,$FFFF8248.W
	MOVE	#$300,$FFFF824A.W
	MOVE	#$300,$FFFF824C.W
	MOVE	#$300,$FFFF824E.W
	MOVE	#$300,$FFFF8258.W
	MOVE	#$300,$FFFF825A.W
	MOVE	#$300,$FFFF825C.W
	MOVE	#$300,$FFFF825E.W

	CLR.B	$FFFFFA1B.W
	MOVE.L	#TB8_IR,$120.W
	MOVE.B	#8,$FFFFFA21.W
	MOVE.B	#8,$FFFFFA1B.W
	BCLR	#0,$FFFFFA0F.W
	RTE
TB8_IR	
	MOVE	#$445,$FFFF8246.W
	MOVE	#$445,$FFFF8254.W
	MOVE	#$004,$FFFF8244.W

	MOVE	#$400,$FFFF8248.W
	MOVE	#$400,$FFFF824A.W
	MOVE	#$400,$FFFF824C.W
	MOVE	#$400,$FFFF824E.W
	MOVE	#$400,$FFFF8258.W
	MOVE	#$400,$FFFF825A.W
	MOVE	#$400,$FFFF825C.W
	MOVE	#$400,$FFFF825E.W

	CLR.B	$FFFFFA1B.W
	MOVE.L	#TB9_IR,$120.W
	MOVE.B	#10,$FFFFFA21.W
	MOVE.B	#8,$FFFFFA1B.W
	BCLR	#0,$FFFFFA0F.W
	RTE
TB9_IR	
	MOVE	#$556,$FFFF8246.W
	MOVE	#$556,$FFFF8254.W
	MOVE	#$005,$FFFF8244.W

	MOVE	#$500,$FFFF8248.W
	MOVE	#$500,$FFFF824A.W
	MOVE	#$500,$FFFF824C.W
	MOVE	#$500,$FFFF824E.W
	MOVE	#$500,$FFFF8258.W
	MOVE	#$500,$FFFF825A.W
	MOVE	#$500,$FFFF825C.W
	MOVE	#$500,$FFFF825E.W

	CLR.B	$FFFFFA1B.W
	MOVE.L	#TB10_IR,$120.W
	MOVE.B	#20,$FFFFFA21.W
	MOVE.B	#8,$FFFFFA1B.W
	BCLR	#0,$FFFFFA0F.W
	RTE
TB10_IR	
	MOVE	#$667,$FFFF8246.W
	MOVE	#$667,$FFFF8254.W
	MOVE	#$006,$FFFF8244.W

	MOVE	#$600,$FFFF8248.W
	MOVE	#$600,$FFFF824A.W
	MOVE	#$600,$FFFF824C.W
	MOVE	#$600,$FFFF824E.W
	MOVE	#$600,$FFFF8258.W
	MOVE	#$600,$FFFF825A.W
	MOVE	#$600,$FFFF825C.W
	MOVE	#$600,$FFFF825E.W

	CLR.B	$FFFFFA1B.W
	MOVE.L	#TB11_IR,$120.W
	MOVE.B	#27,$FFFFFA21.W
	MOVE.B	#8,$FFFFFA1B.W
	BCLR	#0,$FFFFFA0F.W
	RTE
TB11_IR	
	MOVE	#$777,$FFFF8246.W
	MOVE	#$777,$FFFF8254.W
	MOVE	#$007,$FFFF8244.W

	MOVE	#$700,$FFFF8248.W
	MOVE	#$700,$FFFF824A.W
	MOVE	#$700,$FFFF824C.W
	MOVE	#$700,$FFFF824E.W
	MOVE	#$700,$FFFF8258.W
	MOVE	#$700,$FFFF825A.W
	MOVE	#$700,$FFFF825C.W
	MOVE	#$700,$FFFF825E.W

	CLR.B	$FFFFFA1B.W
;	MOVE.L	#TB11_IR,$120.W
;	MOVE.B	#20,$FFFFFA21.W
;	MOVE.B	#8,$FFFFFA1B.W
	BCLR	#0,$FFFFFA0F.W
	RTE

EFF	move.l	SCREEN1,a0
	MOVE	#7999,D0
HA	CLR.L	(A0)+
	DBF	D0,HA
	RTS	

SET_SCR:	move.l	#BUFFERSCR,d0	
	CLR.B	D0
	move.l	d0,SCREEN1
	add.l	#32000,d0		
	move.l	d0,SCREEN2
	rts				

	DATA
B_DPS	INCBIN	CODED
	RTS
	DC	$9999
	EVEN

B_DP	INCBIN	DAMDAT
	RTS
ZIK	INCBIN	FRAG.MUS
PNT_TXT	DC.L	0
PNT_TXT2	DC.L	7*4

FONT8_8	*95 LETTRES (?)
;	DCB.L	(50-13)*6,$FFFFFFFF
font:   	dc.l	$00000000,$00000000,$00181818,$18001800,$00666666 
	dc.l	$00000000,$0066FF66,$66FF6600,$183E603C,$067C1800 
	dc.l	$00666C18,$30664600,$1C361C38,$6F663B00,$00181818 
	dc.l	$00000000,$000E1C18,$181C0E00,$00703818,$18387000 
	dc.l	$00663CFF,$3C660000,$0018187E,$18180000,$00000000 
	dc.l	$00181830,$0000007E,$00000000,$00000000,$00181800 
	dc.l	$00060C18,$30604000,$003C666E,$76663C00,$00183818 
	dc.l	$18187E00,$003C660C,$18307E00,$007E0C18,$0C663C00 
	dc.l	$000C1C3C,$6C7E0C00,$007E607C,$06663C00,$003C607C 
	dc.l	$66663C00,$007E060C,$18303000,$003C663C,$66663C00 
	dc.l	$003C663E,$060C3800,$00001818,$00181800,$00001818 
	dc.l	$00181830,$060C1830,$180C0600,$00007E00,$007E0000 
	dc.l	$6030180C,$18306000,$003C660C,$18001800,$003C666E 
	dc.l	$6E603E00,$00183C66,$667E6600,$007C667C,$66667C00 
	dc.l	$003C6660,$60663C00,$00786C66,$666C7800,$007E607C 
	dc.l	$60607E00,$007E607C,$60606000,$003E6060,$6E663E00 
	dc.l	$0066667E,$66666600,$007E1818,$18187E00,$00060606 
	dc.l	$06663C00,$00666C78,$786C6600,$00606060,$60607E00 
	dc.l	$0063777F,$6B636300,$0066767E,$7E6E6600,$003C6666 
	dc.l	$66663C00,$007C6666,$7C606000,$003C6666,$666C3600 
	dc.l	$007C6666,$7C6C6600,$003C603C,$06063C00,$007E1818 
	dc.l	$18181800,$00666666,$66667E00,$00666666,$663C1800 
	dc.l	$0063636B,$7F776300,$0066663C,$3C666600,$0066663C 
	dc.l	$18181800,$007E0C18,$30607E00,$001E1818,$18181E00 
	dc.l	$00406030,$180C0600,$00781818,$18187800,$00081C36 
	dc.l	$63000000,$00000000,$0000FF00,$00183C7E,$7E3C1800 
	dc.l	$00003C06,$3E663E00,$0060607C,$66667C00,$00003C60 
	dc.l	$60603C00,$0006063E,$66663E00,$00003C66,$7E603C00 
	dc.l	$000E183E,$18181800,$00003E66,$663E067C,$0060607C 
	dc.l	$66666600,$00180038,$18183C00,$00060006,$0606063C 
	dc.l	$0060606C,$786C6600,$00381818,$18183C00,$0000667F 
	dc.l	$7F6B6300,$00007C66,$66666600,$00003C66,$66663C00 
	dc.l	$00007C66,$667C6060,$00003E66,$663E0606,$00007C66 
	dc.l	$60606000,$00003E60,$3C067C00,$00187E18,$18180E00 
	dc.l	$00006666,$66663E00,$00006666,$663C1800,$0000636B 
	dc.l	$7F3E3600,$0000663C,$183C6600,$00006666,$663E0C78 
	dc.l	$00007E0C,$18307E00,$00183C7E,$7E183C00,$18181818 
	dc.l	$18181818,$007E787C,$6E660600,$08183878,$38180800 
	even
TEXTE	
 DC.B "          "
 dc.b "WELCOME TO YOU BRAVE ADVENTURERS! WE OFFER YOU A TRIP ON THE SEAS OF DREAM... "
 DC.B "    BUT DON'T PANIC: THERE'S NOTHING TO FEAR...      "
 DC.B "          "
	dc.l	-1
	even

LOGO	INCBIN	NOTHING.PI1
	BSS

SCREEN2	DS.L	1
SCREEN1	DS.L	1
	
	DS.B	256
BUFFERSCR	DS.B	64000
CHAISES	DS.L	(NB_PTS_Y+1)*(NB_PTS_X+1)
CHAISES2	DS.L	100
B_DPS2	DS.B	25000	*20646
	EVEN
CHAISE	DS.L	40
ANC_VBL	DS.L	1
ANC_TB	DS.L	1
MFP1	DS.B	1
MFP2	DS.B	1
MFP3	DS.B	1
MFP4	DS.B	1
MFP5	DS.B	1
MFP6	DS.B	1
MFP7	DS.B	1
MFP8	DS.B	1
MFP9	DS.B	1
MFP10	DS.B	1
