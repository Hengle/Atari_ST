	TEXT
Begin:
	MOVEA.L	A7,A5 
	LEA	NEW_STAC(PC),A7 
	MOVEA.L	4(A5),A5
	MOVE.L	12(A5),D0 
	ADD.L	20(A5),D0 
	ADD.L	28(A5),D0 
	ADDI.L	#$100,D0
	MOVE.L	D0,-(A7)
	MOVE.L	A5,-(A7)
	CLR	-(A7) 
	MOVE	#$4A,-(A7)
	TRAP	#1
	ADDA.L	#$C,A7

	PEA	0.W
	MOVE	#$20,-(A7)
	TRAP	#1
	ADDQ	#6,A7 
	MOVE.L	D0,-(A7)
	
	BSR	ACCELERA

	MOVE	#3,$FFFF8240.W 
	MOVE	#$400,$FFFF8242.W
	MOVE	#5,$FFFF8244.W 
	MOVE	#$444,$FFFF8246.W

	LEA	TEXT(PC),A0 
	BSR	PRINT_IT
	BSR	INIT_RES
	MOVE	#$20,-(A7)
	TRAP	#1
	ADDQ	#6,A7 

	PEA	ENV 
	PEA	COM 
	PEA	FILENAME
	CLR	-(A7)
	MOVE	#$4B,-(A7)
	TRAP	#1
	ADDA.L	#$10,A7 
	CLR	-(A7) 
	TRAP	#1
PRINT_IT:	MOVE.L	A0,-(A7)
	MOVE	#9,-(A7)
	TRAP	#1
	ADDQ	#6,A7 
	RTS
ENV:	DS.W    1
COM:	DS.W    1
FILENAME:	DC.B   'GENST_3.' 
	DC.B   'PRG',$00
TEXT:	DC.B   $1B,'EMOUSE '
	DC.B   'ACCELERA' 
	DC.B   'TOR IS N' 
	DC.B   'OW ON!',$0A,$0A 
	DC.B   $0D,'PLEASE '
	DC.B   'WAIT...',$0A
	DC.B   $0D,'LOADING'
	DC.B   ' RESIDEN' 
	DC.B   'T GENST ' 
	DC.B   'DEVELOPE' 
	DC.B   'R.',$00,$00 

INIT_RES:	MOVE.B  $FFFF820A.W,SAUVE_FR
	MOVE.B  $FFFF8260.W,SAUVE_RE
	LEA     $FFFFFA01.W,A0
	LEA     SAUVE_MF(PC),A1 
	MOVEQ   #$F,D0

MFP_LOOP:	MOVE.B  (A0),(A1)+
	ADDQ.W  #2,A0 
	DBF     D0,MFP_LOOP 
	MOVE.B  #-$40,$FFFFFA23.W
	LEA     $00000028.L,A0
	LEA     SAUVE_TE(PC),A1 
	MOVE.L  #$1FF,D0
TEX_LOOP:	MOVE.L  (A0)+,(A1)+ 
	DBF     D0,TEX_LOOP 
	MOVE.L  #RESET_RO,$42A.W
	MOVE.L  #$31415926,$426.W
	RTS 
INTER_RT:	RTE 
RESET_RO:	LEA     TRANSIT_(PC),A7 
	MOVE.L  #INTER_RT,$70.W
	MOVE    #$2300,SR 
	MOVEQ   #5,D0 
SHIFTER:	STOP    #$2300
	MOVE.B  #1,$FFFF8260.W 
	STOP    #$2300
	DC.B   $11,$FC,$00,$00,$82,'`'
	DBF     D0,SHIFTER
	LEA     NEW_STAC(PC),A7 
	LEA     $00000028.L,A0
	LEA     SAUVE_TE(PC),A1 
	MOVE.L  #$1FF,D0
L000B:	MOVE.L  (A1)+,(A0)+ 
	DBF     D0,L000B
	LEA     $FFFFFA01.W,A0
	LEA     SAUVE_MF(PC),A1 
	MOVEQ   #$F,D0
L000C:	MOVE.B  (A1)+,(A0)
	ADDQ.W  #2,A0 
	DBF     D0,L000C
	MOVE.L  #RESET_RO,$0000042A.L 
	MOVE.L  #$31415926,$00000426.L
	MOVE.B  SAUVE_FR,$FFFF820A.W 
	MOVE.B  SAUVE_RE,$FFFF8260.W 
	MOVE.L  #$707FFFF,$FFFF8800.W
	DC.B   $A0,$00
	MOVE  #1,D0 
	ANDI.W  #3,D0 
	LEA     SKUMTAB(PC),A1
	ADD.W   D0,D0 
	ADD.W   D0,D0 
	MOVE.L  0(A1,D0.W),(A0) 
	MOVE.B  #3,$FFFFFC04.W
	MOVE.B  #-$6B,$FFFFFC04.W
	MOVE.B  #3,$FFFFFC00.W
	MOVE.B  #-$6A,$FFFFFC00.W
	MOVE  #$C8,D0 
TIMA:	NOP
	DBF     D0,TIMA 
	MOVE    #$2300,SR 
	MOVE  #0,$FFFF8240.W 
	MOVE  #$400,$FFFF8242.W
	MOVE  #5,$FFFF8244.W 
	MOVE  #$555,$FFFF8246.W
	CLR.W   -(A7) 
	TRAP    #1
ACCELERA:	MOVE  #$22,-(A7)
	TRAP    #$E 
	ADDQ.L  #2,A7 
	MOVEA.L D0,A0 
	MOVE.L  16(A0),OLDMOUSE 
	MOVE.L  #SPD_MOUS,16(A0)
	RTS 
SPD_MOUS:	MOVEM.L A0/D0-D1,-(A7)
	ADDQ.L  #1,A0 
	MOVE.B  (A0),D0 
	BSR.S   INC_TEST
	MOVE.B  (A0),D0 
	BSR.S   INC_TEST
	MOVEM.L (A7)+,A0/D0-D1
	MOVE.L  OLDMOUSE(PC),-(A7)
	RTS 
INC_TEST:	MOVE.B  D0,D1 
	BPL.S   POSITIVE
	NEG.B   D1
POSITIVE:	CMP.B   #2,D1 
	BLT.S   NO_SPEED
	MULS    D1,D0 
	ASR.B   #1,D0 
NO_SPEED:	MOVE.B  D0,(A0)+
	RTS 
OLDMOUSE:	DS.W	2
SKUMTAB:	DC.B	$00,$04,$00,$A0,$00,$02,$00,$A0
	DC.B	$00,$01,$00,'P',$00,$01,$00,'P'
	DC.B	$80,$01,$12,$14,$00,$00,$00,$00
	DS.W	8 
TRANSIT_:	DS.W	1 
SAUVE_FR:	DS.W	1
SAUVE_RE:	DS.W	1
SAUVE_MF:	DS.W	12
SAUVE_TE:	DS.W	1736
NEW_STAC:	DS.W	1
ZUEND: END
