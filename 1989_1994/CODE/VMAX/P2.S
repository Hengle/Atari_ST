	CLR.L	-(SP)
	MOVE.W	#$20,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP
	MOVE.L	D0,SAUV_SP
	
	CLR.W	-(SP)
	MOVE.L	#-1,-(SP)
	MOVE.L	#-1,-(SP)
	MOVE.W	#5,-(SP)
	TRAP	#14
	LEA	12(SP),SP

	CLR.L	PNT2
	CLR.L	PNT
	CLR.L	COLPLUS
	CLR.L	COLP

	
	MOVE.L	#FIN,$008
	MOVE.L	#FIN,$00C
	MOVE.L	#FIN,$010
	MOVE.L	#FIN,$014
	MOVE.L	#FIN,$018
	MOVE.L	#FIN,$01C
	MOVE.L	#FIN,$020
	MOVE.L	#FIN,$024
	
	ANDI.B	#%11111000,$484.W
	
	MOVE.B	$FFFF8201.W,SAUVEC
	MOVE.B	$FFFF8203.W,SAUVEC+1
	
	MOVEM.L	$FFFF8240.W,D0-D7
	MOVEM.L	D0-D7,ANC_PAL
;	MOVEM.L	FONT1+2,D0-D7
;	MOVEM.L	D0-D7,$FFFF8240.W
	
	BSR	PREP_ECR
;	MOVE.L	#FONT1+34+(160*64)+96,SOV_LET
;	CLR.L	POS_LET
;	CLR.B	SCRP1

	MOVE.L	$70.W,ANC_VBL
	MOVE.L	#VBLR,$70.W
	
LOOP	JMP	LOOP

FIN	MOVE.L	ANC_VBL,$70.W

	MOVEM.L	ANC_PAL,D0-D7
	MOVEM.L	D0-D7,$FFFF8240.W
	
	MOVE.B	SAUVEC,$FFFF8201.W
	MOVE.B	SAUVEC+1,$FFFF8203.W
	
	ORI.B	#%00000111,$484.W
	
	MOVE.L	SAUV_SP,-(SP)
	MOVE.W	#$20,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP
	
	CLR.W	-(SP)
	TRAP	#1
	ADDQ.L	#2,SP
	
	*******	V B L  &  P R O C E D U R E S   *******
VBLR	
	ADD.L	#4,PDTA

	ADDQ.L	#2,CNT
	CMPI.L	#5*50,CNT
	BNE.S	R
	CLR.L	CNT
;	MOVE.L	#L0002B,$70.W
R
	MOVE.L	COLP,D6
	LEA	COLORS,A5
	ADDA.L	COLPLUS,A5
	LEA	$FFFF8240.W,A6

	LEA	ROUTINE,A0
	LEA	DATA,A1
	ADD.L	PDTA,A1
	CMPI.L	#-1,200*4(A1)
	BNE.S	P
	LEA	DATA,A1
	CLR.L	PDTA
	BRA.S	O
P	REPT	17-3
	NOP
	ENDR
O	ADDA.L	(A1)+,A0
  JSR     (A0)


	LEA	BIDON,A2
	ADDA.L	PDTA2,A2
	CMPI.L	#-1,200*4(A2)
	BNE.S	PLPL
	LEA	BIDON,A2
		CLR.L	PDTA2
PLPL
	MOVE.B	#$18,D0 
	MOVE	#$2700,SR 
L0004:TST.B	$FFFF8209.W
	BEQ.S	L0004 
	SUB.B	$FFFF8209.W,D0 
	LSR.L	D0,D0 

	REPT	85
	NOP
	ENDR


	REPT	199
	LEA	ROUTINE,A0
	LEA	COLORS,A5
	ADDA.L	D6,A5
	ADDA.L	(A1)+,A0
	ADDA.L	(A2)+,A0
	JSR     (A0)
	ENDR

	CLR	(A6)
  MOVE    #$2300,SR 
  CMPI.B  #$39,$FFFFFC02.W
  BEQ     FIN
  RTE 



L0002B:	
	ADDQ.L	#2,COLPLUS
	ADDQ.L	#2,PNT
	CMPI.L	#35*2+42*2,PNT
	BNE.S	RA
	CLR.L	PNT
	ADD.L	#35*2+42*2,COLP
	MOVE.L	#VBLR,$70.W
	ADDQ.L	#1,PNT2
	CMPI.L	#14,PNT2			*15
	BNE.S	RA
	CLR.L	COLP
	CLR.L	PNT2
	CLR.L	COLPLUS
	CLR.L	PNT
RA
	MOVE.L	COLPLUS,D6
	LEA	COLORS,A5
	ADDA.L	COLPLUS,A5
	LEA	$FFFF8240.W,A6


	MOVE.B	#$18,D0 
	MOVE	#$2700,SR 
L0004A:TST.B	$FFFF8209.W
	BEQ.S	L0004A
	SUB.B	$FFFF8209.W,D0 
	LSR.L	D0,D0 

	REPT	85
	NOP
	ENDR

	LEA	ROUTINE,A0
;	MOVE.L	BIDON,A1
	CMPI.L	#-1,200*4(A1)
	BNE.S	PA
	MOVE.L	#DATA,BIDON
	MOVE.L	BIDON,A1
	BRA.S	OA
PA	REPT	17-3
	NOP
	ENDR
OA	ADDA.L	(A1)+,A0
	JSR     (A0)
	move.l	a1,BIDON

	REPT	199
	LEA	ROUTINE,A0
	LEA	COLORS,A5
	ADDA.L	D6,A5
	ADDA.L	(A1)+,A0
	JSR     (A0)
	ENDR
	
	CLR	(A6)
  MOVE    #$2300,SR 
  CMPI.B  #$39,$FFFFFC02.W
  BEQ     FIN
  RTE 



	REPT	3
	NOP
	ENDR

ROUTINE
	

	REPT	3
	NOP
	ENDR

	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)

	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)


	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)


	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)



	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
	MOVE	(A5)+,(A6)
;	MOVE	(A5)+,(A6)

	RTS
	
SWAPEC	MOVE.L	SCREEN2,D0
	MOVE.L	SCREEN1,SCREEN2
	MOVE.L	D0,SCREEN1
	MOVE.B	SCREEN1+1,$FFFF8201.W
	MOVE.B	SCREEN1+2,$FFFF8203.W
	RTS
	
PREP_ECR	MOVE.L	#BUFFER,D0
	ANDI.B	#0,D0
	MOVE.L	D0,SCREEN1
	ADDI.L	#32000,D0
	MOVE.L	D0,SCREEN2
	MOVE.B	SCREEN1+1,$FFFF8201.W
	MOVE.B	SCREEN1+2,$FFFF8203.W
	RTS
	
	SECTION	DATA
	
	
COLORS	

	DC.W	$100,$200,$300,$400,$500,$600,$700
	DC.W	$710,$720,$730,$740,$750,$760,$770
	DC.W	$771,$772,$773,$774,$775,$776,$777
	DC.W	$677,$577,$477,$377,$277,$177,$077
	DC.W	$066,$055,$044,$033,$022,$011,$001
	DCB.W	42,0

	DC.W	$001,$002,$003,$004,$005,$006,$007
	DC.W	$017,$027,$037,$047,$057,$067,$077
	DC.W	$177,$277,$377,$477,$577,$677,$777
	DC.W	$776,$775,$774,$773,$772,$771,$770
	DC.W	$760,$650,$540,$430,$320,$210,$100
	DCB.W	42,0

	DC.W	$010,$020,$030,$040,$050,$060,$070
	DC.W	$170,$270,$370,$470,$570,$670,$770
	DC.W	$771,$772,$773,$774,$775,$776,$777
	DC.W	$777,$776,$775,$774,$773,$772,$771
	DC.W	$770,$670,$570,$470,$370,$270,$170
	DCB.W	42,0

	DC.W	$000,$100,$210,$320,$430,$540,$650
	DC.W	$760,$761,$762,$763,$764,$765,$766
	DC.W	$767,$757,$747,$737,$727,$717,$707
	DC.W	$706,$705,$704,$703,$702,$701,$601
	DC.W	$501,$401,$301,$201,$101,$001,$000
	DCB.W	42,0

	DC.W	$001,$102,$203,$304,$405,$506,$607
	DC.W	$707,$717,$727,$737,$747,$757,$767
	DC.W	$777,$667,$556,$445,$334,$223,$112
	DC.W	$001,$001,$001,$001,$001,$001,$001
	DC.W	$001,$001,$001,$001,$001,$001,$001
	DCB.W	42,0

	DC.W	$002,$012,$023,$034,$045,$056,$067
	DC.W	$077,$177,$276,$375,$474,$573,$672
	DC.W	$771,$761,$751,$741,$731,$721,$711
	DC.W	$701,$601,$501,$401,$301,$201,$101
	DC.W	$000,$000,$000,$000,$000,$000,$000
	DCB.W	42,0

	DC.W	$010,$020,$030,$040,$050,$060,$070
	DC.W	$071,$171,$172,$272,$273,$373,$374
	DC.W	$474,$475,$575,$576,$676,$677,$777
	DC.W	$776,$766,$666,$665,$655,$555,$554
	DC.W	$544,$444,$344,$244,$144,$044,$033
	DCB.W	42,0

	DC.W	$010,$020,$030,$040,$050,$060,$070
	DC.W	$071,$171,$172,$272,$273,$373,$374
	DC.W	$474,$475,$575,$576,$676,$677,$777
	DC.W	$677,$577,$477,$377,$277,$177,$077
	DC.W	$067,$057,$047,$037,$027,$017,$007
	DCB.W	42,0

	DC.W	$010,$020,$030,$040,$050,$060,$070
	DC.W	$071,$171,$172,$272,$273,$373,$374
	DC.W	$474,$475,$575,$576,$676,$677,$777
	DC.W	$776,$766,$666,$665,$655,$555,$554
	DC.W	$544,$444,$344,$244,$144,$044,$000
	DCB.W	42,0

	DC.W	$010,$020,$030,$040,$050,$060,$070
	DC.W	$071,$171,$172,$272,$273,$373,$374
	DC.W	$474,$475,$575,$576,$676,$677,$777
	DC.W	$677,$577,$477,$377,$277,$177,$077
	DC.W	$067,$057,$047,$037,$027,$017,$007
;	DC.W	$006,$005,$004,$003,$002,$001,$000
	DCB.W	42,0

	DC.W	$001,$002,$003,$004,$005,$006,$007
	DC.W	$017,$027,$037,$047,$057,$067,$077
	DC.W	$177,$277,$377,$477,$577,$677,$777
	DC.W	$776,$775,$774,$773,$772,$771,$770
	DC.W	$760,$750,$740,$730,$720,$710,$700
;	DC.W	$600,$500,$400,$300,$200,$100,$000
	DCB.W	42,0

	DC.W	$001,$002,$003,$004,$005,$006,$007
	DC.W	$017,$027,$037,$047,$057,$067,$077
	DC.W	$177,$277,$377,$477,$577,$677,$777
	DC.W	$776,$775,$774,$773,$772,$771,$770
	DC.W	$670,$570,$470,$370,$270,$170,$070
;	DC.W	$060,$050,$040,$030,$020,$010,$000
	DCB.W	42,0

	DC.W	$001,$002,$003,$004,$005,$006,$007
	DC.W	$017,$027,$037,$047,$057,$067,$077
	DC.W	$177,$277,$377,$477,$577,$677,$777
	DC.W	$776,$775,$774,$773,$772,$771,$770
	DC.W	$760,$750,$740,$730,$720,$710,$700
;	DC.W	$600,$500,$400,$300,$200,$100,$000
	DCB.W	42,0

	DC.W	$001,$002,$003,$004,$005,$006,$007
	DC.W	$017,$027,$037,$047,$057,$067,$077
	DC.W	$177,$277,$377,$477,$577,$677,$777
	DC.W	$776,$775,$774,$773,$772,$771,$770
	DC.W	$670,$570,$470,$370,$270,$170,$070
;	DC.W	$060,$050,$040,$030,$020,$010,$000

	DCB.W	42,0

;
	DC.W	$100,$200,$300,$400,$500,$600,$700
	DC.W	$710,$720,$730,$740,$750,$760,$770
	DC.W	$771,$772,$773,$774,$775,$776,$777
	DC.W	$677,$577,$477,$377,$277,$177,$077
	DC.W	$066,$055,$044,$033,$022,$011,$001


DATA	
	REPT	4
	DCB.L	5,6
	DCB.L	4,4
	DCB.L	3,2
	DCB.L	2,0
	DCB.L	3,-2
	DCB.L	4,-4
	DCB.L	5,-6

	DCB.L	5,-6
	DCB.L	4,-4
	DCB.L	3,-2
	DCB.L	2,0
	DCB.L	3,2
	DCB.L	4,4
	DCB.L	5,6
	ENDR
	
	DCB.L	5,6
	DCB.L	4,4
	DCB.L	3,2
	DCB.L	2,0
	DCB.L	3,-2
	DCB.L	4,-4
	DCB.L	5,-6

	DCB.L	5,-6
	DCB.L	4,-4
	DCB.L	3,-2
	DCB.L	2,0
	DCB.L	3,2
	DCB.L	1,4	*4

	DC.L	-1

BIDON	REPT	199
	DC.L	0,0,0,0,0,0,2,2,2,2,2,2,4,4,4,4,4,4,2,2,2,2,2
	ENDR
	DC.L	-1

	SECTION	BSS

PNT2	DS.L	1
PNT	DS.L	1
COLP	DS.L	1	
CNT	DS.L	1	
COLPLUS	DS.L	1
POINT	DS.L	1
PDTA	DS.L	1
PDTA2	DS.L	1
ANC_PAL	DS.L	8
SAUV_SP	DS.L	1
ANC_VBL	DS.L	1
;SCRP1	DS.B	1
	EVEN
SCREEN1	DS.L	1
SCREEN2	DS.L	1
	DS.B	256
BUFFER	DS.L	16000
	DS.B	256
SAUVEC	DS.W	1	