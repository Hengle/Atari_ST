	* ROUTINE DE REMPLISSAGE TRES PRêCAIRE
	* D0 & D1 SONT X1 & X2
	* D2 REPRESENTE Y*160
	* AFFICHE ENVIRON 225 DROITES DE (0,Y)-(319,Y)
	* AVEC CLIPPING GAUCHE-DROITE ET TOUT LES AUTRES TESTS.
	* ON PEUT METTRE X1 ET X2 DANS N'IMPORTE QUEL ORDRE,
	* X1 ET X2 PEUVENT APPARTENIR AU MEME MOT D'ECRAN (SAME WORD)
	* X1 PEUT ETRE EGAL A X2 (AFF_PLOT)

REMPLIT	MOVE.L	A0,A5	;SAUVEGARDE DE L'ADRESSE ECRAN
	ADD.W	D2,A5	;ADDITION DE Y(*160!)
	MOVEQ	#15,D4
	MOVE.W	#-16,D5
	CMP.W	D0,D1
	BGE.S	NO_CHANGES
	EXG.L	D0,D1
NO_CHANGES	MOVE.W	D0,D0
	BPL.S	CLIP_G1
	MOVEQ	#0,D0
CLIP_G1	MOVE.W	D1,D1
	BPL.S	CLIP_GOCH
	BRA.S	FIN_REMP
CLIP_GOCH	CMPI.W	#320,D1
	BLT.S	CLIP_D1
	MOVE.W	#319,D1
CLIP_D1	CMPI.W	#320,D0
	BLT.S	CLIP_DROIT
	BRA.S	FIN_REMP
CLIP_DROIT	CMP.W	D0,D1
	BEQ.S	AFF_PLOT
	MOVE.W	D0,D6
	MOVE.W	D1,D7
	AND.W	D5,D6
	AND.W	D5,D7
	LSR.W	#1,D6
	LSR.W	#1,D7

	AND.W	D4,D0
	ADD.W	D0,D0
	LEA	PART1(PC),A0
	MOVE.W	(A0,D0.W),D0

	AND.W	D4,D1
	ADD.W	D1,D1
	LEA	PART2(PC),A0
	MOVE.W	(A0,D1.W),D1
	
	CMP.W	D6,D7
	BEQ.S	SAME_WORD

	MOVE.L	A5,A1	;A5=ADRESSE ECRAN
	ADDA.W	D6,A1
	ADDA.W	D7,A5

	OR.W	D0,(A1)
	OR.W	D1,(A5)
	SUB.W	D6,D7
	LSR	#3,D7
	SUBQ.W	#2,D7
	BMI.S	FIN_REMP
	ADD.W	D7,D7
	ADD.W	D7,D7
	ADDQ.W	#8,A1
	MOVEQ	#-1,D3
	LEA	DIFF_ROUTS(PC),A3
	ADDA.W	D7,A3
	MOVE.L	(A3),A2
	JMP	(A2)
FIN_REMP	RTS

SAME_WORD	ADDA.W	D6,A5	;A5=ADRESSE ECRAN
	EOR.W	D0,D1
	NOT.W	D1
	OR.W	D1,(A5)
	RTS

AFF_PLOT	AND.W	D5,D0	;D5=-16
	LSR	#1,D0
	ADDA.W	D0,A5	;A5=ADRESSE ECRAN
	AND.W	D4,D1	;D4=15
	ADD.W	D1,D1
	LEA	PNTS,A0
	MOVE.W	(A0,D1.W),D0
	OR.W	D0,(A5)
	RTS

AFF18	MOVE.W	D3,136(A1)
AFF17	MOVE.W	D3,128(A1)
AFF16	MOVE.W	D3,120(A1)
AFF15	MOVE.W	D3,112(A1)
AFF14	MOVE.W	D3,104(A1)
AFF13	MOVE.W	D3,96(A1)
AFF12	MOVE.W	D3,88(A1)
AFF11	MOVE.W	D3,80(A1)
AFF10	MOVE.W	D3,72(A1)
AFF9	MOVE.W	D3,64(A1)
AFF8	MOVE.W	D3,56(A1)
AFF7	MOVE.W	D3,48(A1)
AFF6	MOVE.W	D3,40(A1)
AFF5	MOVE.W	D3,32(A1)
AFF4	MOVE.W	D3,24(A1)
AFF3	MOVE.W	D3,16(A1)
AFF2	MOVE.W	D3,8(A1)
AFF1	MOVE.W	D3,(A1)
	RTS

DIFF_ROUTS	DC.L	AFF1,AFF2,AFF3,AFF4,AFF5,AFF6,AFF7,AFF8
	DC.L	AFF9,AFF10,AFF11,AFF12,AFF13,AFF14,AFF15
	DC.L	AFF16,AFF17,AFF18

PART1	DC.W	%1111111111111111
	DC.W	%0111111111111111
	DC.W	%0011111111111111
	DC.W	%0001111111111111
	DC.W	%0000111111111111
	DC.W	%0000011111111111
	DC.W	%0000001111111111
	DC.W	%0000000111111111
	DC.W	%0000000011111111
	DC.W	%0000000001111111
	DC.W	%0000000000111111
	DC.W	%0000000000011111
	DC.W	%0000000000001111
	DC.W	%0000000000000111
	DC.W	%0000000000000011
	DC.W	%0000000000000001

PART2	DC.W	%1000000000000000
	DC.W	%1100000000000000
	DC.W	%1110000000000000
	DC.W	%1111000000000000
	DC.W	%1111100000000000
	DC.W	%1111110000000000
	DC.W	%1111111000000000
	DC.W	%1111111100000000
	DC.W	%1111111110000000
	DC.W	%1111111111000000
	DC.W	%1111111111100000
	DC.W	%1111111111110000
	DC.W	%1111111111111000
	DC.W	%1111111111111100
	DC.W	%1111111111111110
	DC.W	%1111111111111111