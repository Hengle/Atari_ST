	CLR.L	-(SP)
	MOVE.W	#$20,-(SP)
	TRAP	#1
	ADDQ.W	#6,SP
	MOVE.L	D0,SAUV_SP

	LEA	DATA_PACKE,A0
	LEA	BUF_DEPACK,A1
	BSR	DEPACK

	MOVEQ	#1,D0
	JSR	BUF_DEPACK
	MOVE.L	#BUF_DEPACK+8,$4D2.W

	MOVE.W	#7,-(SP)
	TRAP	#1
	ADDQ.W	#2,SP

	CLR.L	$4D2.W
	MOVE.L	#$8080000,$FFFF8800.W
	MOVE.L	#$9090000,$FFFF8800.W
	MOVE.L	#$A0A0000,$FFFF8800.W

	MOVE.L	SAUV_SP,-(SP)
	MOVE.W	#$20,-(SP)
	TRAP	#1
	ADDQ.W	#6,SP

	CLR.W	-(SP)
	TRAP	#1

DEPACK	BSR	CONTROLE
	BSR	DEPACKING
FIN_DEPACKING	RTS

CONTROLE	CMPI.L	#"Huff",(A0)+
	BNE	NICHT_GUT
	MOVEQ	#0,D6
	ADDQ.W	#4,A0
	MOVE.W	(A0)+,D7
	MOVE.L	A0,ADR_1	;ADRESSE DE DEPART DE LA TABLE DES CODES
	ADD.W	D7,D7
	ADD.W	D7,D7
	ADDA.W	D7,A0
	MOVE.L	A0,ADR_2	;ADRESSE DE DEPART DES DATAS A DEPACKER
	RTS

DEPACKING	MOVE.L	$44E.W,A5
	MOVEQ	#0,D5	;D5 RESTERA TOUJOURS A ZERO
	MOVE.L	ADR_2,A2	;DATAS
	MOVEQ	#16,D1
	MOVE.W	(A2)+,D0
OCTET_SUIVANT	MOVEQ	#0,D2	;CODE A DECODER
	MOVEQ	#0,D3	;NOMBRE DE BITS
CONT_DECAL	ADD.W	D2,D2
	LSL	#1,D0
	ADDX.W	D5,D2
	ADDQ.W	#1,D3
	BSR	CODE_SVP
	SUBQ.W	#1,D1
	BNE.S	CONT_DECAL
	MOVE.W	(A2)+,D0
	MOVEQ	#$10,D1
	CMPA.L	#FIN_DATA,A2
	BEQ.S	FIN_DEPACKING
	BRA.S	CONT_DECAL

CODE_SVP	MOVE.L	ADR_1,A0
	MOVE.W	D7,D4
	SUBQ.W	#1,D4
RECOMANC	CMP.W	2(A0),D2
	BEQ.S	BON_CODE
	ADDQ.W	#4,A0
	DBRA	D4,RECOMANC
	RTS
BON_CODE	CMP.B	1(A0),D3
	BEQ.S	C_EST_LE_BON
	ADDQ.W	#4,A0
	DBRA	D4,RECOMANC
	RTS
C_EST_LE_BON	MOVE.B	(A0),(A1)+
	MOVE.B	(A0),(A5)+
	MOVE.W	D6,$FFFF8240.W
	ADDI.W	#$30,D6
	SUBQ.W	#1,D1
	BNE.S	OCTET_SUIVANT
	MOVE.W	(A2)+,D0
	MOVEQ	#$10,D1
	CMPA.L	#FIN_DATA,A2
	BEQ	FIN_DEPACKING
	BRA.S	OCTET_SUIVANT
	
NICHT_GUT	RTS

ADR_1	DS.L	1	;POUR L'ADRESSE DE DEPART DE LA TABLE
ADR_2	DS.L	1	;POUR L'ADRESSE DE DEPART DES DATAS

	SECTION	DATA
DATA_PACKE	INCBIN	MUS1COMP.Huf
FIN_DATA	EVEN
	SECTION	BSS
SAUV_SP	DS.L	1
BUF_DEPACK	DS.B	20000