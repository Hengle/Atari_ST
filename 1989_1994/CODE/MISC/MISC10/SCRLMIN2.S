	CLR.L	-(SP)
	MOVE.W	#$20,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP	
	MOVE.L	D0,SAUV_SP

	CLR.W	-(SP)
	MOVE.L	#-1,-(SP)
	MOVE.L	#-1,-(SP)
	MOVE.W	#5,-(SP)
	TRAP	#14
	LEA	12(SP),SP

	MOVE.L	#FIN,$008.W
	MOVE.L	#FIN,$00C.W
	MOVE.L	#FIN,$010.W

	MOVEM.L	$FFFF8240.W,D0-D7
	MOVEM.L	D0-D7,ANC_PAL

	MOVEQ	#8,D2
	MOVEQ	#0,D5
	
	MOVE.L	$70.W,ANC_VBL
	MOVE.L	#VBLR,$70.W

BOUCLE	BRA.S	BOUCLE

FIN	MOVE.L	ANC_VBL,$70.W

	MOVEM.L	ANC_PAL,D0-D7
	MOVEM.L	D0-D7,$FFFF8240.W

	CLR.W	-(SP)
	TRAP	#1
	
VBLR	SF	$FFFF8240.W
	LEA	PALETTE(PC),A6
	CMPI.L	#8,D2
	BNE.S	SUITV0
	BSR	TEST_LET
	MOVEQ	#0,D2
SUITV0	BSR.S	SCROLL
	BSR.S	SCROLL

full	
	MOVE.L	#$FFFF8209,A3	
	MOVE.L	#$FFFF8260,A1	
	MOVE.L	#$FFFF820A,A0	
	MOVEQ	#8,D0		* NB DE LIGNES
	MOVEQ	#0,D1		
	MOVEQ	#0,D4
	MOVEQ	#2,D3
	MOVEQ	#$10,D6
	MOVE	#$2700,SR


SYNCHRO	MOVE.B	(A3),D7     * SYNCHRO
	BEQ.S	SYNCHRO
	SUB.W	D7,D6		
	LSL.W	D6,D1		

	moveq	#30,D1
d	dbf	D1,d
	nop
	nop	
FULLSCREEN
	MOVE.B	D3,(A1)
	NOP
	MOVE.B	D4,(A1)

	MOVE	(a6)+,$ffff8244.W		
		
	moveq	#26,D1
da	dbf	D1,da
	nop
	nop			 

	MOVE.B	D4,(A0)
	MOVE.B	D3,(A0)
	
	moveq	#2,D1
d3	dbf	D1,d3
	nop
	nop
	
	MOVE.B	D3,(A1)
	NOP
	MOVE.B	D4,(A1)

	moveq	#1,D1
f	dbf	D1,f
	nop

	DBF	D0,FULLSCREEN

	CMPI.B	#$39,$FFFFFC02.W
 	BEQ	FIN
	RTE


SCROLL	MOVE.L	$44E.W,A0
	LEA	160(A0),A0
	LEA	BUF_LET(PC),A1
	
	MOVEQ	#6,D7
OI	ROXL	(A1)
	moveQ	#28,d4
rox	roxl	226(a0)
	lea	-8(a0),a0
	dbf	d4,rox
	lea	29*8(a0),a0
	
	LEA	230(A0),A0
	ADDQ.L	#2,A1
	DBF	D7,OI
	ADDQ.L	#1,D2
	RTS

TEST_LET	MOVEQ	#0,D0
	LEA	TEXT1(PC),A0
	ADDA.L	D5,A0
	LEA	FONT8_8(PC),A1
	CMPI.B	#$FF,(A0)
	BNE.S	SUITTST
	CLR.L	D5
	LEA	TEXT1(PC),A0
SUITTST	MOVE.B	(A0),D0	
	SUBI.B	#65,D0	
	mulu	#7,D0
	ADDA.L	D0,A1	
	LEA	BUF_LET(PC),A2
	MOVEQ	#6,D7
KOP	MOVE.B	(A1)+,(A2)
	LEA	2(A2),A2
	DBF	D7,KOP
	ADDQ.L	#1,D5
	RTS
	
	SECTION	DATA

TEXT1	DC.B	" THIS IS A FULL SCROLLER CODED BY ZAPPY   "
	DC.B	"               ",$FF

FONT8_8	
	DC.B	124,230,230,254,230,230,230
	DC.B	252,230,230,252,230,230,252
	DC.B	124,230,224,224,224,230,124
	DC.B	252,230,230,230,230,230,252
	DC.B	254,224,224,248,224,224,254
	DC.B	254,224,224,248,224,224,224
	DC.B	124,230,224,224,238,230,124
	DC.B	230,230,230,254,230,230,230
	DC.B	124,56,56,56,56,56,124
	DC.B	14,14,14,14,14,206,124
	DC.B	230,238,252,248,252,238,230
	DC.B	224,224,224,224,224,224,254
	DC.B	198,238,246,230,230,230,230
	DC.B	252,230,230,230,230,230,230
	DC.B	124,230,230,230,230,230,124
	DC.B	252,230,230,252,224,224,224
	DC.B	121,230,230,230,238,252,118
	DC.B	252,230,230,252,236,230,230
	DC.B	124,230,224,124,14,206,124
	DC.B	254,56,56,56,56,56,56
	DC.B	230,230,230,230,230,230,124
	DC.B	230,230,230,230,230,124,56
	DC.B	230,230,230,230,254,238,198
	DC.B	198,238,124,56,124,238,198
	DC.B	230,230,230,124,56,56,56
	DC.B	254,206,28,56,112,230,254
PALETTE
	DC.W	$020,$131,$242,$353,$464,$575,$676
	

	SECTION	BSS
ANC_PAL	DS.L	8
SAUV_SP	DS.L	1
ANC_VBL	DS.L	1
BUF_LET	DS.B	(1*7)*2
