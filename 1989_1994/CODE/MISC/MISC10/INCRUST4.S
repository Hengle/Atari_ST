	CLR.L	LIGNES
	CLR.L	TM
	CLR.L	D0
	
	LEA	BUFFER,A0
	LEA	INSTRUCTIONS,A1
	LEA	BUFFER_FULL,A2
BOUCLE	MOVE	(A1),D2
	MOVE	2(A1),D1
	MOVE	4(A1),D0
	CMP	(A0),D0
	BEQ.S	THATS_IT
	CMPI	#$4E75,(A0)
	BEQ	THE_END
	CMPI	#$ABCD,D0
	BEQ	PROBLEME_NUMERO_UN
	LEA	6*2(A1),A1
	BRA.S	BOUCLE
THATS_IT
	CMPI.L	#0,TM
	BNE.S	PAS_OVER_GAUCHE
	MOVE.L	#$12834E71,(A2)+
	MOVE	#$1283,(A2)+
	MOVE.L	#5,TM
PAS_OVER_GAUCHE
	CMPI.L	#94,TM
	BLE	PARTIE_UN
	CMPI.L	#111,TM
	BLE.S	PARTIE_DEUX
	CMPI.L	#128,TM
	BLE	PARTIE_TROIS


PARTIE_TROIS
	MOVE.L	TM,D4
	ADD.L	D1,D4
	CMPI.L	#128,D4
	BGT.S	TOUJOURS_TROP_GRAND	SI=ALORS CA RENTRE
	BRA	CA_RENTRE
TOUJOURS_TROP_GRAND
	MOVE.L	#128,D4
	MOVE.L	TM,D5
	SUB.L	D5,D4
	CMPI.L	#0,D4
	BEQ.S	DECIDEMENT_PAS_DE_NOP
	SUBQ.L	#1,D4
NOPZ	MOVE	#$4E71,(A2)+
	DBF	D4,NOPZ
DECIDEMENT_PAS_DE_NOP	
	MOVE.L	#$12834E71,(A2)+
	MOVE	#$1284,(A2)+
	MOVE.L	#5,TM
	ADD.L	#1,LIGNES
	BRA	CA_RENTRE

PARTIE_DEUX
	MOVE.L	TM,D4
	ADD.L	D1,D4
	CMPI.L	#111,D4
	BGT.S	ENCORE_TROP_GRAND	SI=ALORS CA RENTRE
	BRA	CA_RENTRE
ENCORE_TROP_GRAND
	MOVE.L	#111,D4
	MOVE.L	TM,D5
	SUB.L	D5,D4
	CMPI.L	#0,D4
	BEQ.S	TOUJOURS_PAS_DE_NOP
	SUBQ.L	#1,D4
NOPX	MOVE	#$4E71,(A2)+
	DBF	D4,NOPX
TOUJOURS_PAS_DE_NOP	
	MOVE.L	#$12834E71,(A2)+
	MOVE	#$1284,(A2)+
	MOVE.L	#116,TM
	BRA.S	CA_RENTRE
	
PARTIE_UN
	MOVE.L	TM,D4
	ADD.L	D1,D4
	CMPI.L	#94,D4
	BGT.S	TROP_GRAND	SI=ALORS CA RENTRE
	BRA	CA_RENTRE
TROP_GRAND
	MOVE.L	#94,D4
	MOVE.L	TM,D5
	SUB.L	D5,D4
	CMPI.L	#0,D4
	BEQ.S	PAS_DE_NOP
	SUBQ.L	#1,D4
NOPY	MOVE	#$4E71,(A2)+
	DBF	D4,NOPY
PAS_DE_NOP	
	MOVE.L	#$10831084,(A2)+
	MOVE.L	#98,TM
CA_RENTRE	
	SUBQ	#1,D2
ICI	MOVE	(A0)+,(A2)+
	DBF	D2,ICI
	ADD.L	D1,TM
	LEA	INSTRUCTIONS,A1
	BRA	BOUCLE

THE_END
	JSR	NOPS_QUI_RESTENT
	MOVE	#$4E75,(A2)
	
	MOVE.L	#TEXTE2,-(SP)
	MOVE	#$9,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP
	MOVE	#$7,-(SP)
	TRAP	#1
	ADDQ.L	#2,SP
	BRA.S	FIN

PROBLEME_NUMERO_UN
	MOVE.L	#TEXTE1,-(SP)
	MOVE	#$9,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP
	MOVE	#$7,-(SP)
	TRAP	#1
	ADDQ.L	#2,SP
	BRA.S	FIN
PROBLEME_NUMBER_TWO
	MOVE.L	#TEXTE3,-(SP)
	MOVE	#$9,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP
	MOVE	#$7,-(SP)
	TRAP	#1
	ADDQ.L	#2,SP
	BRA.S	FIN

NOPS_QUI_RESTENT
	CMPI.L	#124,TM
	BGT.S	PROBLEME_NUMBER_TWO

	CMPI.L	#94,TM
	BEQ.S	MILIEU
	CMPI.L	#111,TM
	BEQ.S	OUT_DR
	CMPI.L	#124,TM
	BEQ.S	OUT
	MOVE	#$4E71,(A2)+
	ADD.L	#1,TM
	BRA.S	NOPS_QUI_RESTENT
MILIEU	MOVE.L	#$10841083,(A2)+
	ADD.L	#4,TM
	BRA.S	NOPS_QUI_RESTENT
OUT_DR	MOVE.L	#$12834E71,(A2)+
	MOVE	#$1284,(A2)+
	ADD.L	#5,TM
	BRA.S	NOPS_QUI_RESTENT
OUT	MOVE	#$4E75,(A2)+
	RTS
	
FIN	CLR.L	-(SP)
	TRAP	#1

BUFFER
	REPT	500
	MOVE	#$FFFF,(A0)
	MOVE.L	#$FFFF,(A0)
	ENDR
	RTS

TEXTE1	DC.B	'INSTRUCTION NON RECONNUE.',0
TEXTE2	DC.B	'CA ROULE.',0
TEXTE3	DC.B	'PROB DS LES NOPS DE FIN.',0
	EVEN
	
INSTRUCTIONS
 DC	4,6,$217C,$FFFF,$FFFF,$0008	;MOVE.L	#$FFFFFFFF,8(A0)
 DC	3,4,$317C,$FFFF,$0008,$0000	;MOVE	#$FFFF,8(A0)
 DC	3,4,$117C,$00FF,$0008,$0000	;MOVE.B	#$FF,8(A0)
 DC	3,5,$20BC,$FFFF,$FFFF,$0000	;MOVE.L	#$FFFFFFFF,(A0)
; 	     22						   (A1)
; 	     24						   (A2)
; 	     26						   (A3)
; 	     28						   (A4)
; 	     2A						   (A5)
; 	     2C						   (A6)
 DC	2,3,$30BC,$FFFF,$0000,$0000	;MOVE	#$FFFF,(A0)
 DC	2,3,$10BC,$00FF,$0000,$0000	;MOVE.B	#$FF,(A0)

 DC	4,8,$00A8,$FFFF,$FFFF,$0008     ;ORI.L   #$FFFFFFFF,8(A0)
 DC	3,5,$0068,$FFFF,$0008,$0000           ;ORI     #$FFFF,8(A0)
 DC	3,5,$0028,$00FF,$0008,$0000     ;ORI.B   #$FF,8(A0)
 DC	3,7,$0090,$FFFF,$FFFF,$0000           ;ORI.L   #$FFFFFFFF,(A0)
 DC	2,4,$0050,$FFFF,$0000,$0000                 ;ORI     #$FFFF,(A0)
 DC	2,4,$0010,$00FF,$0000,$0000                 ;ORI.B   #$FF,(A0)

 DC	4,8,$02A8,$FFFF,$FFFF,$0008     ;ANDI.L  #$FFFFFFFF,8(A0)
 DC	3,5,$0268,$FFFF,$0008,$0000           ;ANDI    #$FFFF,8(A0)
 DC	3,5,$0228,$00FF,$0008,$0000           ;ANDI.B  #$FF,8(A0)
 DC	3,7,$0290,$FFFF,$FFFF,$0000           ;ANDI.L  #$FFFFFFFF,(A0)
 DC	2,4,$0250,$FFFF,$0000,$0000                 ;ANDI    #$FFFF,(A0)
 DC	2,4,$0210,$00FF,$0000,$0000                 ;ANDI.B  #$FF,(A0)


 DC	4,8,$00A9,$FFFF,$FFFF,$0008     ;ORI.L   #$FFFFFFFF,8(A1)
 DC	3,5,$0069,$FFFF,$0008,$0000           ;ORI     #$FFFF,8(A1)
 DC	3,5,$0029,$00FF,$0008,$0000           ;ORI.B   #$FF,8(A1)
 DC	3,7,$0091,$FFFF,$FFFF,$0000           ;ORI.L   #$FFFFFFFF,(A1)
 DC	2,4,$0051,$FFFF,$0000,$0000                 ;ORI     #$FFFF,(A1)
 DC	2,4,$0011,$00FF,$0000,$0000                 ;ORI.B   #$FF,(A1)

 DC	4,8,$02A9,$FFFF,$FFFF,$0008     ;ANDI.L  #$FFFFFFFF,8(A1)
 DC	3,5,$0269,$FFFF,$0008,$0000           ;ANDI    #$FFFF,8(A1)
 DC	3,5,$0229,$00FF,$0008,$0000           ;ANDI.B  #$FF,8(A1)
 DC	3,7,$0291,$FFFF,$FFFF,$0000           ;ANDI.L  #$FFFFFFFF,(A1)
 DC	2,4,$0251,$FFFF,$0000,$0000                 ;ANDI    #$FFFF,(A1)
 DC	2,4,$0211,$00FF,$0000,$0000                 ;ANDI.B  #$FF,(A1)

 DC	4,8,$00AA,$FFFF,$FFFF,$0008     ;ORI.L   #$FFFFFFFF,8(A2)
 DC	3,5,$006A,$FFFF,$0008,$0000           ;ORI     #$FFFF,8(A2)
 DC	3,5,$002A,$00FF,$0008,$0000           ;ORI.B   #$FF,8(A2)
 DC	3,7,$0092,$FFFF,$FFFF,$0000           ;ORI.L   #$FFFFFFFF,(A2)
 DC	2,4,$0052,$FFFF,$0000,$0000                 ;ORI     #$FFFF,(A2)
 DC	2,4,$0012,$00FF,$0000,$0000                 ;ORI.B   #$FF,(A2)

 DC	4,8,$02AA,$FFFF,$FFFF,$0008     ;ANDI.L  #$FFFFFFFF,8(A2)
 DC	3,5,$026A,$FFFF,$0008,$0000           ;ANDI    #$FFFF,8(A2)
 DC	3,5,$022A,$00FF,$0008,$0000           ;ANDI.B  #$FF,8(A2)
 DC	3,7,$0292,$FFFF,$FFFF,$0000           ;ANDI.L  #$FFFFFFFF,(A2)
 DC	2,4,$0252,$FFFF,$0000,$0000                 ;ANDI    #$FFFF,(A2)
 DC	2,4,$0212,$00FF,$0000,$0000                 ;ANDI.B  #$FF,(A2)

 DC	4,8,$00AB,$FFFF,$FFFF,$0008     ;ORI.L   #$FFFFFFFF,8(A3)
 DC	3,5,$006B,$FFFF,$0008,$0000           ;ORI     #$FFFF,8(A3)
 DC	3,5,$002B,$00FF,$0008,$0000           ;ORI.B   #$FF,8(A3)
 DC	3,7,$0093,$FFFF,$FFFF,$0000           ;ORI.L   #$FFFFFFFF,(A3)
 DC	2,4,$0053,$FFFF,$0000,$0000                 ;ORI     #$FFFF,(A3)
 DC	2,4,$0013,$00FF,$0000,$0000                 ;ORI.B   #$FF,(A3)

 DC	4,8,$02AB,$FFFF,$FFFF,$0008     ;ANDI.L  #$FFFFFFFF,8(A3)
 DC	3,5,$026B,$FFFF,$0008,$0000           ;ANDI    #$FFFF,8(A3)
 DC	3,5,$022B,$00FF,$0008,$0000           ;ANDI.B  #$FF,8(A3)
 DC	3,7,$0293,$FFFF,$FFFF,$0000           ;ANDI.L  #$FFFFFFFF,(A3)
 DC	2,4,$0253,$FFFF,$0000,$0000                 ;ANDI    #$FFFF,(A3)
 DC	2,4,$0213,$00FF,$0000,$0000                 ;ANDI.B  #$FF,(A3)

 DC	4,8,$00AC,$FFFF,$FFFF,$0008     ;ORI.L   #$FFFFFFFF,8(A4)
 DC	3,5,$006C,$FFFF,$0008,$0000           ;ORI     #$FFFF,8(A4)
 DC	3,5,$002C,$00FF,$0008,$0000           ;ORI.B   #$FF,8(A4)
 DC	3,7,$0094,$FFFF,$FFFF,$0000           ;ORI.L   #$FFFFFFFF,(A4)
 DC	2,4,$0054,$FFFF,$0000,$0000                 ;ORI     #$FFFF,(A4)
 DC	2,4,$0014,$00FF,$0000,$0000                 ;ORI.B   #$FF,(A4)

 DC	4,8,$02AC,$FFFF,$FFFF,$0008     ;ANDI.L  #$FFFFFFFF,8(A4)
 DC	3,5,$026C,$FFFF,$0008,$0000           ;ANDI    #$FFFF,8(A4)
 DC	3,5,$022C,$00FF,$0008,$0000           ;ANDI.B  #$FF,8(A4)
 DC	3,7,$0294,$FFFF,$FFFF,$0000           ;ANDI.L  #$FFFFFFFF,(A4)
 DC	2,4,$0254,$FFFF,$0000,$0000                 ;ANDI    #$FFFF,(A4)
 DC	2,4,$0214,$00FF,$0000,$0000                 ;ANDI.B  #$FF,(A4)

 DC	4,8,$00AD,$FFFF,$FFFF,$0008     ;ORI.L   #$FFFFFFFF,8(A5)
 DC	3,5,$006D,$FFFF,$0008,$0000           ;ORI     #$FFFF,8(A5)
 DC	3,5,$002D,$00FF,$0008,$0000           ;ORI.B   #$FF,8(A5)
 DC	3,7,$0095,$FFFF,$FFFF,$0000           ;ORI.L   #$FFFFFFFF,(A5)
 DC	2,4,$0055,$FFFF,$0000,$0000                ;ORI     #$FFFF,(A5)
 DC	2,4,$0015,$00FF,$0000,$0000                 ;ORI.B   #$FF,(A5)

 DC	4,8,$02AD,$FFFF,$FFFF,$0008     ;ANDI.L  #$FFFFFFFF,8(A5)
 DC	3,5,$026D,$FFFF,$0008,$0000           ;ANDI    #$FFFF,8(A5)
 DC	3,5,$022D,$00FF,$0008,$0000           ;ANDI.B  #$FF,8(A5)
 DC	3,7,$0295,$FFFF,$FFFF,$0000           ;ANDI.L  #$FFFFFFFF,(A5)
 DC	2,4,$0255,$FFFF,$0000,$0000                 ;ANDI    #$FFFF,(A5)
 DC	2,4,$0215,$00FF,$0000,$0000                 ;ANDI.B  #$FF,(A5)

 DC	4,8,$00AE,$FFFF,$FFFF,$0008     ;ORI.L   #$FFFFFFFF,8(A6)
 DC	3,5,$006E,$FFFF,$0008,$0000           ;ORI     #$FFFF,8(A6)
 DC	3,5,$002E,$00FF,$0008,$0000           ;ORI.B   #$FF,8(A6)
 DC	3,7,$0096,$FFFF,$FFFF,$0000           ;ORI.L   #$FFFFFFFF,(A6)
 DC	2,4,$0056,$FFFF,$0000,$0000                 ;ORI     #$FFFF,(A6)
 DC	2,4,$0016,$00FF,$0000,$0000                 ;ORI.B   #$FF,(A6)

 DC	4,8,$02AE,$FFFF,$FFFF,$0008     ;ANDI.L  #$FFFFFFFF,8(A6)
 DC	3,5,$026E,$FFFF,$0008,$0000           ;ANDI    #$FFFF,8(A6)
 DC	3,5,$022E,$00FF,$0008,$0000           ;ANDI.B  #$FF,8(A6)
 DC	3,7,$0296,$FFFF,$FFFF,$0000           ;ANDI.L  #$FFFFFFFF,(A6)
 DC	2,4,$0256,$FFFF,$0000,$0000                 ;ANDI    #$FFFF,(A6)
 DC	2,4,$0216,$00FF,$0000,$0000                 ;ANDI.B  #$FF,(A6)

 DC	9,9,$ABCD			;FIN

;FULLSCREEN
;1283	MOVE.B	D3,(A1)			2
;	NOP				1	3
;1284	MOVE.B	D4,(A1)			2	5
;	REPT	89			89	94
;	NOP				
;	ENDR
;1084	MOVE.B	D4,(A0)			2	96
;1083	MOVE.B	D3,(A0)			2	98
;	REPT	13			13	111
;	NOP
;	ENDR
;1283	MOVE.B	D3,(A1)			2	113
;	NOP				1	114
;1284	MOVE.B	D4,(A1)			2	116
;	REPT	12			12	128
;	NOP			 
;	ENDR




	SECTION	BSS
LIGNES	DS.L	1
TM	DS.L	1	
BUFFER_FULL
	DS.B	10000
	EVEN