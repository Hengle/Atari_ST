MAIN
	CLR.L	-(SP)
	MOVE.W	#$20,-(SP)
	TRAP	#1
	ADDQ.W	#6,SP

	CLR.W	-(SP)
	PEA	-1.W
	PEA	-1.W
	MOVE.W	#5,-(SP)
	TRAP	#14
	LEA	12(SP),SP

	BSR	PREP_GOKU_SONS

	MOVEM.L	PIC_1+2,D0-D7
	MOVEM.L	D0-D7,$FFFF8240.W
	CLR.W	$FFFF8242.W

	MOVE.W	#$2700,SR
	CLR.B	$FFFFFA07.W
	CLR.B	$FFFFFA09.W
	CLR.B	$FFFFFA13.W
	CLR.B	$FFFFFA15.W
	MOVE.B	#1,$FFFFFA07.W
	MOVE.B	$FFFFFA07.W,$FFFFFA13.W
	MOVE.L	#VBL_GEN,$70.W
	MOVE.W	#$2300,SR

LOOP	JMP	LOOP

VBL_GEN	CMPI.B	#$50,$FFFFFC02.W
	BNE.S	.TEST_2
	ADDI.L	#160,SCREEN1
.TEST_2	CMPI.B	#$48,$FFFFFC02.W
	BNE.S	.TEST_3
	SUBI.L	#160,SCREEN1
.TEST_3	MOVE.B	SCREEN1+1,$FFFF8201.W
	MOVE.B	SCREEN1+2,$FFFF8203.W
	MOVE.B	SCREEN1+3,$FFFF820D.W
	RTE

PREP_GOKU_SONS	LEA	PIC_1+34,A0
	LEA	BUFFER,A1
	BSR	PUT_IMG
	LEA	PIC_2+34,A0
	BSR	PUT_IMG
	LEA	PIC_3+34,A0
	BSR	PUT_IMG

	MOVE.L	#BUFFER,D0
	MOVE.L	D0,SCREEN1
	MOVE.B	SCREEN1+1,$FFFF8201.W
	MOVE.B	SCREEN1+2,$FFFF8203.W
	RTS

PUT_IMG	MOVE.W	#7999,D7
.RECOP	MOVE.L	(A0)+,(A1)+
	DBRA	D7,.RECOP
	RTS

PIC_1	INCBIN	GOKU_3.PI1
PIC_2	INCBIN	GOKU_2.PI1
PIC_3	INCBIN	GOKU_1.PI1

	SECTION	BSS
SCREEN1	DS.L	1
	DS.B	256
BUFFER	DS.B	160*600