	LEA	FIC,A0
	LEA	REPEAT,A1
	LEA	MASK,A2
	MOVEQ	#0,D0
RECOM_2	CMPA.L	#FIN_FIC,A0
	BGE.S	FIN_CALC
	MOVEQ	#3,D7
RECOM_1	MOVE.W	(A0),D5
	MOVE.W	(A2,D0.W),D1
	MOVE.W	2(A2,D0.W),D3
	AND.W	D1,D5
	LSR.W	D3,D5
	ADD.W	D5,D5
	ADD.W	D5,D5
	ADDQ.L	#1,(A1,D5.W)
	ADDQ.W	#4,D0
	ANDI.W	#15,D0
	DBRA	D7,RECOM_1
	ADDQ.W	#2,A0
	BRA.S	RECOM_2

FIN_CALC

FIC	INCBIN	PRES1B.PI1
	EVEN
FIN_FIC

MASK	DC.W	$F000,12,$F00,8,$F0,4,$F,0

BUF	DS.B	10000
REPEAT	DS.L	16