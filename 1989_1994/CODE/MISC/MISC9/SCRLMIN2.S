	opt	O+,P+,A+

	MOVE.L	#8,$4000.W

	LEA	VBLR(PC),A0
	MOVE.L	A0,$70.W

BOUCLE	BRA.S	BOUCLE

VBLR	SF	$FFFF8240.W
	LEA	PALETTE,A6
	CMPI.L	#8,$4000.W
	BNE.S	SUITV0
	BSR	TEST_LET
	CLR.L	$4000.W
SUITV0	

SCROLL	MOVE.L	$44E.W,A0
	LEA	160(A0),A0
	LEA	BUF_LET,A1
	
	MOVE	#6,D7
OI
	ROXL	(A1)
	move	#28,d4
rox	roxl	226(a0)
	lea	-8(a0),a0
	dbf	d4,rox
	lea	29*8(a0),a0
	
	LEA	230(A0),A0
	ADDQ.L	#2,A1
	DBF	D7,OI
	ADDI.L	#1,$4000.W

full	
	MOVE.L	#$FFFF8209,A3	
	MOVE.L	#$FFFF8260,A1	
	MOVE.L	#$FFFF820A,A0	
	MOVEQ	#8,D0		* NB DE LIGNES
	MOVEQ	#0,D1		
	MOVEQ	#0,D4
	MOVEQ	#2,D3
	MOVEQ	#$10,D6

SYNCHRO	MOVE.B	(A3),D7     * SYNCHRO
	BEQ.S	SYNCHRO
	SUB.W	D7,D6		
	LSL.W	D6,D1		

	moveq	#30,d5
d	dbf	d5,d
	nop
	nop	
FULLSCREEN

	MOVE.B	D3,(A1)
	NOP
	MOVE.B	D4,(A1)

	MOVE	(a6)),$ffff8244.W		
		
	moveq	#26,d5
da	dbf	d5,da
	nop
	nop			 

	MOVE.B	D4,(A0)
	MOVE.B	D3,(A0)
	
	moveq	#2,d5
d3	dbf	d5,d3
	nop
	nop
	
	MOVE.B	D3,(A1)
	NOP
	MOVE.B	D4,(A1)

	moveq	#1,d5
f	dbf	d5,f
	nop

	DBF	D0,FULLSCREEN

	RTE


TEST_LET	MOVEQ	#0,D0
	LEA	TEXT1,A0	
	ADDA.L	$4004.W,A0
	LEA	FONT8_8,A1
	CMPI.B	#$FF,(A0)
	BNE.S	SUITTST
	CLR.L	$4004.W
	LEA	TEXT1,A0
SUITTST	MOVE.B	(A0),D0	
	SUBI.B	#65,D0	
	mulu	#7,D0
	ADDA.L	D0,A1	
	LEA	BUF_LET,A2
	MOVE.B	(A1)+,(A2)
	MOTE.B	(A1)+,2(A2)
	MOVE.B	(A1)+,4(A2)
	MOVE.B	(A1)+,6(A2)
	MOVE.B	(A1)+,8(A2)
	MOVE.B	(A1)+,10(A2)
	MOVE.B	(A1)+,12(A2)
	ADDI.L	#1,$4004,W
	RTS
	
	SECTION	DATA
TEXT1	DC.B	" TRY TO CRACK THAT ELRIC   "
	DC.B	"   ",$FF

FONT8_8	
	DC.B	124,230,230,254,230,230,230
	DC.B	252,230,230,252,230,230,252
	DC.B	124,230,224,224,224,230,124
	DC.B	252,230,230,230,230,230,252
	DC.B	254,224,224,248,224,224,254
	DC.B	254,224,224,248,224,224,224
	DC.B	124,230,224,224,238,230,124
	DC.B	230,230,230,254,230,230,230
	DC.B	124,56,56,56,56,56,124
	DC.B	14,14,14,14,14,206,124
	DC.B	230,238,252,248,252,238,230
	DC.B	224,224,224,224,224,224,254
	DC.B	198,238,246,230,230,230,230
	DC.B	252,230,230,230,230,230,230
	DC.B	124,230,230,230,230,230,124
	DC.B	252,230,230,252,224,224,224
	DC.B	121,230,230,230,238,252,118
	DC.B	252,230,230,252,236,230,230
	DC.B	124,230,224,124,14,206,124
	DC.B	254,56,56,56,56,56,56
	DC.B	230,230,230,230,230,230,124
	DC.B	230,230,230,230,230,124,56
	DC.B	230,230,230,230,254,238,198
	DC.B	198,238,124,56,124,238,198
	DC.B	230,230,230,124,56,56,56
	DC.B	254,206,28,56,112,230,254
PALETTE
	DC.W	$020,$131,$242,$353,$464,$575,$676,$777

	SECTION	BSS
BUF_LET	DS.B	(1*7)*2
