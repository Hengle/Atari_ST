	CLR.L	-(SP)
	MOVE.W	#$20,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP
	MOVE.L	D0,SAUV_SP
	
	CLR.W	-(SP)
	MOVE.L	#-1,-(SP)
	MOVE.L	#-1,-(SP)
	MOVE.W	#5,-(SP)
	TRAP	#14
	LEA	12(SP),SP
	
	MOVE.L	#FIN,$008
	MOVE.L	#FIN,$00C
	MOVE.L	#FIN,$010
	MOVE.L	#FIN,$014
	MOVE.L	#FIN,$018
	MOVE.L	#FIN,$01C
	MOVE.L	#FIN,$020
	MOVE.L	#FIN,$024
	
	ANDI.B	#%11111000,$484.W
	
	MOVEM.L	$FFFF8240.W,D0-D7
	MOVEM.L	D0-D7,ANC_PAL
	MOVE.L	#$00000777,$FFFF8240.W
	MOVE.B	$FFFF8201.W,SAUVEC
	MOVE.B	$FFFF8203.W,SAUVEC+1
	
	BSR	PREP_BUF
	BSR	PREP_ECR
	
	MOVEQ	#2,D0
	JSR	MUZAXX

	MOVE.L	$70.W,ANC_VBL
	MOVE.L	#VBLR,$70.W
	
LOOP	JMP	LOOP

FIN	MOVE.L	ANC_VBL,$70.W
	
	MOVE.B	SAUVEC,$FFFF8201.W
	MOVE.B	SAUVEC+1,$FFFF8203.W

	ORI.B	#%00000111,$484.W
	
	MOVEM.L	ANC_PAL,D0-D7
	MOVEM.L	D0-D7,$FFFF8240.W
	
	MOVE.L	#$8080000,$FFFF8800.W
	MOVE.L	#$9090000,$FFFF8800.W
	MOVE.L	#$A0A0000,$FFFF8800.W
	
	MOVE.L	SAUV_SP,-(SP)
	MOVE.W	#$20,-(SP)
	TRAP	#1
	ADDQ.L	#2,SP	
	
	CLR.W	-(SP)
	TRAP	#1
	ADDQ.L	#2,SP
	
	*******	V B L  &  P R O C E D U R E S   *******
VBLR	BSR	BOUGMES
	CMPI.B	#$39,$FFFFFC02.W
	BEQ	FIN
	RTE

BOUGMES	LEA	MVTXT,A0
	ADDA.L	POS_TXT,A0
	CMPI.W	#-1,(A0)
	BNE	SUITBGM1
	CLR.L	POS_TXT
	LEA	MVTXT,A0
SUITBGM1	MOVEQ	#0,D0
	MOVE.W	(A0),D0
	ANDI.W	#%0000000000001111,D0
	ADD.L	D0,D0
	LEA	CORES_BUF,A0
	ADDA.L	D0,A0	
	MOVE.L	SCREEN1,A1
	LEA	80(A1),A1
	LEA	BUF

AFF_BTMS
N	SET	0
N2	SET	0
	REPT	8
	MOVE.W	N2(A0),N(A1)
	MOVE.W	N2+2(A0),N+8(A1)
	MOVE.W	N2+4(A0),N+16(A1)
	MOVE.W	N2+6(A0),N+24(A1)
	MOVE.W	N2+8(A0),N+32(A1)
	MOVE.W	N2+10(A0),N+40(A1)
	MOVE.W	N2+12(A0),N+48(A1)
	MOVE.W	N2+14(A0),N+56(A1)
	MOVE.W	N2+16(A0),N+64(A1)
	MOVE.W	N2+18(A0),N+72(A1)
N	SET	N+160
N2	SET	N2+500
	ENDR
	RTS

SWAPEC	MOVE.L	SCREEN2,D0
	MOVE.L	SCREEN1,SCREEN2
	MOVE.L	D0,SCREEN1
	MOVE.B	SCREEN1+1,$FFFF8201.W
	MOVE.B	SCREEN1+2,$FFFF8203.W
	RTS

PREP_BUF	LEA	TXTPTT,A0
	LEA	BUF_MESS,A2
RECOMLT1	CMPI.B	#$FF,(A0)
	BEQ	FINPBFT
	MOVEQ	#0,D0
	MOVE.B	(A0)+,D0
	SUBI.B	#32,D0
	LSL.W	#3,D0
	LEA	FNT8_8,A1
	ADDA.L	D0,A1
	MOVE.B	(A1)+,(A2)
	MOVE.B	(A1)+,500(A2)
	MOVE.B	(A1)+,1000(A2)
	MOVE.B	(A1)+,1500(A2)
	MOVE.B	(A1)+,2000(A2)
	MOVE.B	(A1)+,2500(A2)
	MOVE.B	(A1)+,3000(A2)
	MOVE.B	(A1)+,3500(A2)
	ADDQ.L	#1,A2
	BRA	RECOMLT1	
FINPBFT	LEA	BUF_MESS,A0
	MOVEQ	#15,D7
PREDECG	LEA	4000(A0),A2
	MOVE.W	#3999,D0
RECOPMS	MOVE.B	(A0)+,(A2)+
	DBRA	D0,RECOPMS
	MOVE.W	#1999,D0
DECALMS	ROXR	(A0)+
	DBRA	D0,DECALMS
	SUBA.L	#4000,A0
	DBRA	D7,PREDECG
	RTS	

PREP_ECR	MOVE.L	#BUFFER,D0
	ANDI.B	#0,D0
	MOVE.L	D0,SCREEN1
	ADDI.L	#32000+6400,D0
	MOVE.L	D0,SCREEN2
	MOVE.B	SCREEN1+1,$FFFF8201.W
	MOVE.B	SCREEN1+2,$FFFF8203.W
	RTS

	SECTION	DATA
MUZAXX	INCBIN	ASTAROD.MUS

FNT8_8	INCLUDE	FONT8_83.S

TXTPTT	DC.B	"                BONJOUR A TOUS CECI EST UN SCROLL TOUT PETIT QUI NE DURE PAS LONGTEMPS               ",$FF

CORES_BUF	DC.W	60000,56000,52000,48000,44000,40000,36000,32000,28000,24000,20000,16000,12000,8000,4000,0

MVTXT	
N	SET	0
	REPT	20
	DC.W	1+N,2+N,3+N,4+N,6+N,8+N,10+N,12+N,15+N,18+N,21+N,24+N,26+N,28+N,30+N,32+N,33+N,34+N,35+N,36+N
	DC.W	35+N,34+N,32+N,30+N,27+N,24+N,22+N,20+N,19+N,18+N
N	SET	N+18
	ENDR
	DC.W	-1

	SECTION	BSS
ANC_PAL	DS.L	8
SAUV_SP	DS.L	1
ANC_VBL	DS.L	1
POS_TXT	DS.L	1
SCREEN1	DS.L	1
SCREEN2	DS.L	1
SAUVEC	DS.W	1
	DS.B	256
BUFFER	DS.L	20000
	DS.B	256
BUF_MESS	DS.B	(500*8)*16