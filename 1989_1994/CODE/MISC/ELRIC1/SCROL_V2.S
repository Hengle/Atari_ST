	CLR.L	-(SP)
	MOVE.W	#$20,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP
	MOVE.L	D0,SAUV_SP
	
	CLR.W	-(SP)
	MOVE.L	#-1,-(SP)
	MOVE.L	#-1,-(SP)
	MOVE.W	#5,-(SP)
	TRAP	#14
	LEA	12(SP),SP
	
	MOVEM.L	$FFFF8240.W,D0-D7
	MOVEM.L	D0-D7,ANC_PAL
	
	MOVE.L	#FIN,$008
	MOVE.L	#FIN,$00C
	MOVE.L	#FIN,$010
	MOVE.L	#FIN,$014
	MOVE.L	#FIN,$018
	MOVE.L	#FIN,$01C
	MOVE.L	#FIN,$020
	MOVE.L	#FIN,$024

	ANDI.B	#%11111000,$484.W
	
	BSR	PREP_CAR
	
	MOVE.L	$70.W,ANC_VBL
	MOVE.L	#VBLR,$70.W
	
LOOP	JMP	LOOP

FIN	MOVE.L	ANC_VBL,$70.W

	MOVEM.L	ANC_PAL,D0-D7
	MOVEM.L	D0-D7,$FFFF8240.W
	
	ORI.B	#%00000111,$484.W
	
	MOVE.L	SAUV_SP,A0
	MOVE.L	A0,USP
	ANDI.W	#%1101111111111111,SR
	
	CLR.W	-(SP)
	TRAP	#1
	ADDQ.L	#2,SP
	
	*******	V B L  &  P R O C E D U R E S   *******
VBLR	MOVE.L	$44E.W,A0
	JSR	AFF_C
	CMPI.B	#$39,$FFFFFC02.W
	BEQ	FIN
	RTE

PREP_CAR	LEA	AFF_C,A0
	LEA	EFF_C,A1
	MOVEQ	#0,D2
	MOVE.W	#9,D7
RECOMPC	MOVE.W	#$317C,(A0)+
	MOVE.W	#%1111111111111111,(A0)+
	MOVE.W	D2,(A0)+
	MOVE.W	#$4268,(A1)+
	MOVE.W	D2,(A1)+
	ADDI.W	#160,D2
	DBRA	D7,RECOMPC	
	MOVE.W	#$4E75,(A0)
	MOVE.W	#$4E75,(A1)
	RTS

	SECTION	DATA
FONT8_8	INCLUDE	FONT8_83.S
	
	SECTION	BSS
ANC_PAL	DS.L	8
SAUV_SP	DS.L	1
ANC_VBL	DS.L	1
AFF_C	DS.W	61
EFF_C	DS.W	41