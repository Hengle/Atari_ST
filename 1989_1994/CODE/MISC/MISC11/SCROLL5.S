	CLR.L	-(SP)
	MOVE.W	#$20,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP	
	MOVE.L	D0,SAUV_SP

	CLR.W	-(SP)
	MOVE.L	#-1,-(SP)
	MOVE.L	#-1,-(SP)
	MOVE.W	#5,-(SP)
	TRAP	#14
	LEA	12(SP),SP
	

	JSR	SET_SCR


	MOVE.L	#FIN,$008.W
	MOVE.L	#FIN,$00C.W
	MOVE.L	#FIN,$010.W



	MOVE.B	#$12,$FFFFFC02.W
	DC.W	$A00A




	ANDI.B	#%11111000,$484.W

	CLR.L	D0
	CLR.L	D1
	CLR.L	D2


	MOVEM.L	$FFFF8240.W,D0-D7
	MOVEM.L	D0-D7,ANC_PAL

;	MOVEQ	#1,D0
;	JSR	MUZAXX



	MOVE.L	$70.W,ANC_VBL
	MOVE.L	#VBLR,$70.W

BOUCLE	JMP	BOUCLE

FIN	MOVE.L	ANC_VBL,$70.W

	MOVEM.L	ANC_PAL,D0-D7
	MOVEM.L	D0-D7,$FFFF8240.W

	MOVE.L	#$8080000,$FFFF8800.W
	MOVE.L	#$9090000,$FFFF8800.W
	MOVE.L	#$A0A0000,$FFFF8800.W

	BSET	#0,$484.W
	BSET	#1,$484.W
	BSET	#2,$484.W

	MOVE.B	#8,$FFFFFC02.W

	MOVE.L	SAUV_SP,-(SP)
	MOVE.W	#$20,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP

	CLR.W	-(SP)
	TRAP	#1
	ADDQ.L	#2,SP

	
VBLR
	CMPI.B	#$3B,$FFFFFC02.W
	BEQ	POPO
	JSR	SWAP_SCR
	JSR	SCROLL
	
	MOVEM.L	IMAGE+2,D0-D7
	MOVEM.L	D0-D7,$FFFF8240.W
	
 	ADDQ.L	#1,PNT
	CMPI.L	#11,PNT
	BNE.S	OKAY
	MOVE.L	#1,PNT
OKAY	CMPI.L	#1,PNT
	BEQ	PART1
	CMPI.L	#2,PNT
	BEQ	PART1B
	CMPI.L	#3,PNT
	BEQ	PART2
	CMPI.L	#4,PNT
	BEQ	PART2B
	CMPI.L	#5,PNT
	BEQ	PART3
	CMPI.L	#6,PNT
	BEQ	PART3B
	
	CMPI.L	#7,PNT
	BEQ	PART4
	CMPI.L	#8,PNT
	BEQ	PART4B
	CMPI.L	#9,PNT
	BEQ	PART5
	CMPI.L	#10,PNT
	BEQ	PART5B
RETURN2	
POPO	CMPI.B	#$39,$FFFFFC02.W
	BEQ	FIN
	RTE

SCROLL
	MOVEA.L	SCREEN2,A0
	MOVEA.L	SCREEN2,A1
	LEA	8(A0),A0
	REPT	40*81
	MOVE.L	(A0)+,(A1)+
	ENDR
	RTS

PART5
	MOVEA.L	#IMAGE+34,A0
	MOVEA.L	SCREEN2,A1
INC	SET	0
INC2	SET	152
	REPT	81
	MOVE.B	INC+25(A0),INC2(A1)
	MOVE.B	INC+27(A0),INC2+2(A1)
	MOVE.B	INC+29(A0),INC2+4(A1)
	MOVE.B	INC+31(A0),INC2+6(A1)

	MOVE.B	INC+32(A0),INC2+1(A1)
	MOVE.B	INC+34(A0),INC2+3(A1)
	MOVE.B	INC+36(A0),INC2+5(A1)
	MOVE.B	INC+38(A0),INC2+7(A1)

INC	SET	INC+160
INC2	SET	INC2+160
	ENDR

	BRA	RETURN2

	
PART4
	MOVEA.L	#IMAGE+34,A0
	MOVEA.L	SCREEN2,A1
INC	SET	0
INC2	SET	152
	REPT	81
	MOVE.B	INC+17(A0),INC2(A1)
	MOVE.B	INC+19(A0),INC2+2(A1)
	MOVE.B	INC+21(A0),INC2+4(A1)
	MOVE.B	INC+23(A0),INC2+6(A1)

	MOVE.B	INC+24(A0),INC2+1(A1)
	MOVE.B	INC+26(A0),INC2+3(A1)
	MOVE.B	INC+28(A0),INC2+5(A1)
	MOVE.B	INC+30(A0),INC2+7(A1)

INC	SET	INC+160
INC2	SET	INC2+160
	ENDR

	BRA	RETURN2


PART3
	MOVEA.L	#IMAGE+34,A0
	MOVEA.L	SCREEN2,A1
INC	SET	0
INC2	SET	152
	REPT	81
	MOVE.B	INC+9(A0),INC2(A1)
	MOVE.B	INC+11(A0),INC2+2(A1)
	MOVE.B	INC+13(A0),INC2+4(A1)
	MOVE.B	INC+15(A0),INC2+6(A1)

	MOVE.B	INC+16(A0),INC2+1(A1)
	MOVE.B	INC+18(A0),INC2+3(A1)
	MOVE.B	INC+20(A0),INC2+5(A1)
	MOVE.B	INC+22(A0),INC2+7(A1)

INC	SET	INC+160
INC2	SET	INC2+160
	ENDR

	BRA	RETURN2


PART2

	MOVEA.L	#IMAGE+34,A0
	MOVEA.L	SCREEN2,A1
INC	SET	0
INC2	SET	152
	REPT	81
	MOVE.B	INC+1(A0),INC2(A1)
	MOVE.B	INC+3(A0),INC2+2(A1)
	MOVE.B	INC+5(A0),INC2+4(A1)
	MOVE.B	INC+7(A0),INC2+6(A1)

	MOVE.B	INC+8(A0),INC2+1(A1)
	MOVE.B	INC+10(A0),INC2+3(A1)
	MOVE.B	INC+12(A0),INC2+5(A1)
	MOVE.B	INC+14(A0),INC2+7(A1)
INC	SET	INC+160
INC2	SET	INC2+160
	ENDR
	BRA	RETURN2

PART1

	MOVEA.L	#IMAGE+34,A0
	MOVEA.L	SCREEN2,A1
INC	SET	0
INC2	SET	152
	REPT	81
	MOVE.B	INC(A0),INC2+1(A1)
	MOVE.B	INC+2(A0),INC2+3(A1)
	MOVE.B	INC+4(A0),INC2+5(A1)
	MOVE.B	INC+6(A0),INC2+7(A1)
INC	SET	INC+160
INC2	SET	INC2+160
	ENDR
	BRA	RETURN2


PART1B	
	MOVEA.L	#IMAGE+34,A0
	MOVEA.L	SCREEN2,A1
INC	SET	0
INC2	SET	152
	REPT	81
	MOVEM.L	INC(A0),D0-D1
	MOVEM.L	D0-D1,INC2(A1)
INC	SET	INC+160
INC2	SET	INC2+160
	ENDR
	BRA	RETURN2
PART2B	
	MOVEA.L	#IMAGE+34,A0
	MOVEA.L	SCREEN2,A1
INC	SET	8
INC2	SET	152
	REPT	81
	MOVEM.L	INC(A0),D0-D1
	MOVEM.L	D0-D1,INC2(A1)
INC	SET	INC+160
INC2	SET	INC2+160
	ENDR
	BRA	RETURN2
PART3B	
	MOVEA.L	#IMAGE+34,A0
	MOVEA.L	SCREEN2,A1
INC	SET	16
INC2	SET	152
	REPT	81
	MOVEM.L	INC(A0),D0-D1
	MOVEM.L	D0-D1,INC2(A1)
INC	SET	INC+160
INC2	SET	INC2+160
	ENDR
	BRA	RETURN2

PART4B	
	MOVEA.L	#IMAGE+34,A0
	MOVEA.L	SCREEN2,A1
INC	SET	24
INC2	SET	152
	REPT	81
	MOVEM.L	INC(A0),D0-D1
	MOVEM.L	D0-D1,INC2(A1)
INC	SET	INC+160
INC2	SET	INC2+160
	ENDR
	BRA	RETURN2

PART5B	
	MOVEA.L	#IMAGE+34,A0
	MOVEA.L	SCREEN2,A1
INC	SET	32
INC2	SET	152
	REPT	81
	MOVEM.L	INC(A0),D0-D1
	MOVEM.L	D0-D1,INC2(A1)
INC	SET	INC+160
INC2	SET	INC2+160
	ENDR
	BRA	RETURN2

SET_SCR:	MOVE.L	#BUFFERSCR,D0
	AND.L	#$FFFFFF00,D0
	MOVE.L	D0,SCREEN1
	ADD.L	#32000,D0
	MOVE.L	D0,SCREEN2
	RTS

SWAP_SCR:	move.l	SCREEN1,d0
	move.l	SCREEN2,SCREEN1
	move.l	d0,SCREEN2
	lsr.l	#8,d0
	move.l	#$ffff8201,a0
	movep	d0,(a0)
	rts
		



	
	

IMAGE	INCBIN	FNT_80.PI1

	SECTION	BSS
PNT	DS.L	1
PNT2	DS.L	1
SCREENA	DS.L	1
SCREEN	DS.L	1
SCREEN1	DS.L	1
SCREEN2	DS.L	1
	DS.B	256
BUFFERSCR	DS.B	32000*2
	ds.b	256
ANC_PAL	DS.L	8
SAUV_SP	DS.L	1
ANC_VBL	DS.L	1
DATAPNT2	DS.L	1
DATAPNT	DS.L	1
VALUE2	DS.L	1
VALUE	DS.L	1
ASCREEN2	DS.L	1
ASCREEN1	DS.L	1
PLUS2	DS.L	1
PLUS	DS.L	1
