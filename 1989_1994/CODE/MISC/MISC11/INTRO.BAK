     CLR.L   -(SP)
     MOVE.W   #$20,-(SP)
     TRAP     #1
     LEA   6(SP),SP
     MOVE.L  D0,SAUV_SP
   

	MOVE.L	#FIN,$008.W
	MOVE.L	#FIN,$00C.W
	MOVE.L	#FIN,$010.W

     MOVE.B  #$12,$FFFFFC02.W
     DC.W    $A00A

	MOVE.L	#8,NB_PART

     CLR.W  -(SP)
     MOVE.L  #-1,-(SP)
     MOVE.L  #-1,-(SP)
     MOVE.W  #$5,-(SP)
     TRAP    #14
     LEA     12(SP),SP

     AND.B   #%11111000,$484


	JSR	SET_SCR


;     MOVE.L  #BUFFER,D0
;     AND.B   #0,D0
;     MOVE.L  D0,SCREEN
;     ADDI.L  #32000,D0
;     MOVE.L  D0,SCREEN2
;	SUBI.L	#33280,D0
;	MOVE.L	D0,SCREEN3

;     MOVEM.L  PICFON+2,D0-D7
;     MOVEM.L  D0-D7,$FFFF8240.W

;     BSR  PREPECR

     MOVE.B   SCREEN1+1,$FFFF8201.W
     MOVE.B   SCREEN1+2,$FFFF8203.W

     MOVE.L   $70,ANC_VBL
     MOVE.L   #VBLR,$70

WAIT  CMPI.B  #$39,$FFFFFC02.W
      BEQ  FIN
      JMP  WAIT

FIN    MOVE.L  ANC_VBL,$70.W

      MOVE.W  #$25,-(SP)
      TRAP  #14
      LEA   2(SP),SP
      MOVE.B  #8,$FFFFFC02.W
      BSET   #0,$484
      BSET   #1,$484
      BSET   #2,$484

      MOVE.L   SAUV_SP,-(SP)
      MOVE.W   #$20,-(SP)
      TRAP     #1
      LEA   6(SP),SP

      CLR.W  -(SP)
      TRAP   #1
      LEA   2(SP),SP


SET_SCR:	move.l	#BUFFER,d0
	and.l	#$ffffff00,d0
	move.l	d0,SCREEN1
	add.l	#32000,d0
	move.l	d0,SCREEN2
	move.l	#BUFFERSCR,d0
	MOVE.L	D0,SCREEN3

	rts			


VBLR

	CMPI.L	#8,NB_PART
	BNE	SUITV0
	BSR	TEST_LET
	CLR.L	NB_PART
SUITV0	JSR	SCROLL


	  ADDI.L  #1280,SCREEN1
      MOVE.L  SCREEN1,D0
      MOVE.L  SCREEN2,D1
      CMP.L   D1,D0
      BNE     H_SCROL
      MOVE.L  SCREEN2,SCREEN1
      SUBI.L  #32000,SCREEN1
H_SCROL MOVE.B  SCREEN1+1,$FFFF8201.W
        MOVE.B  SCREEN1+2,$FFFF8203.W

	MOVE.L	SCREEN3,A0
	MOVE.L	SCREEN1,A1
	ADDA.L	#160*192,A1
	MOVE.L	SCREEN1,A2
	SUBA.L	#160*8,A2

	REPT	40*8
	MOVE.L	(A0),(A1)+
	MOVE.L	(A0)+,(A2)+
	ENDR



        RTE

;PREPECR MOVE.L SCREEN1,D1
;        MOVE.L  #1,D2
;RECOMC  MOVE.L  D1,A6
;        MOVE.L  #199,D3
;        LEA    PICFON+34,A0
;AFFP    REPT 40
;        MOVE.L  (A0)+,(A6)+
;        ENDR
;        DBRA  D3,AFFP
;        ADDI.L  #32000,D1
;        DBRA  D2,RECOMC
;        RTS


SCROLL	MOVE.L	SCREEN3,A0
	LEA	BUF_LET,A1
	REPT	8
	ROXL	(A1)
	ROXL	154(A0)
	ROXL	146(A0)
	ROXL	138(A0)
	ROXL	130(A0)
	ROXL	122(A0)
	ROXL	114(A0)
	ROXL	106(A0)
	ROXL	98(A0)
	ROXL	90(A0)
	ROXL	82(A0)
	ROXL	74(A0)
	ROXL	66(A0)
	ROXL	58(A0)	
	ROXL	50(A0)
	ROXL	42(A0)
	ROXL	34(A0)
	ROXL	26(A0)
	ROXL	18(A0)
	ROXL	10(A0)
	ROXL	2(A0)
	LEA	160(A0),A0
	ADDQ.L	#2,A1
	ENDR
	ADDI.L	#1,NB_PART
	RTS

TEST_LET	MOVEQ	#0,D0
	LEA	TEXT1,A0	
	ADDA.L	POINT,A0
	LEA	FONT8_8,A1
	CMPI.B	#$FF,(A0)
	BNE	SUITTST
	CLR.L	POINT
	LEA	TEXT1,A0
SUITTST	MOVE.B	(A0),D0	
	SUBI.B	#32,D0	
	LSL.W	#3,D0	
	ADDA.L	D0,A1	
	LEA	BUF_LET,A2
	MOVE.B	(A1)+,(A2)
	MOVE.B	(A1)+,2(A2)
	MOVE.B	(A1)+,4(A2)
	MOVE.B	(A1)+,6(A2)
	MOVE.B	(A1)+,8(A2)
	MOVE.B	(A1)+,10(A2)
	MOVE.B	(A1)+,12(A2)
	MOVE.B	(A1)+,14(A2)
	ADDI.L	#1,POINT
	RTS
	


       SECTION DATA

;PICFON  INCBIN  FNT_80.PI1

TEXT1	DC.B	" HI TO YOU BUT SORRY I HAVE A TRY TO MAKE BEFORE SPEAKING WITH YOU    "
	DC.B	" ABCDEFGHIJKLMNOPQRSTUVWXYZ  OK  ALL RIGHT  AND WRAP   HAHAHAHAHAHAH     ",$FF

FONT8_8
	REPT	33
	DC.B	0,0,0,0,0,0,0,0
	ENDR
	DC.B	124,230,230,254,230,230,230,0	;A
	DC.B	252,230,230,252,230,230,252,0	;B
	DC.B	124,230,224,224,224,230,124,0	;C
	DC.B	252,230,230,230,230,230,252,0	;D
	DC.B	254,224,224,248,224,224,254,0	;E
	DC.B	254,224,224,248,224,224,224,0	;F
	DC.B	124,230,224,224,238,230,124,0	;G
	DC.B	230,230,230,254,230,230,230,0	;H
	DC.B	124,56,56,56,56,56,124,0	;I
	DC.B	14,14,14,14,14,206,124,0	;J
	DC.B	230,238,252,248,252,238,230,0	;K
	DC.B	224,224,224,224,224,224,254,0	;L
	DC.B	198,238,246,230,230,230,230,0	;M
	DC.B	252,230,230,230,230,230,230,0	;N
	DC.B	124,230,230,230,230,230,124,0	;O
	DC.B	252,230,230,252,224,224,224,0	;P
	DC.B	121,230,230,230,238,252,118,0	;Q
	DC.B	252,230,230,252,236,230,230,0	;R
	DC.B	124,230,224,124,14,206,124,0	;S
	DC.B	254,56,56,56,56,56,56,0	;T
	DC.B	230,230,230,230,230,230,124,0	;U
	DC.B	230,230,230,230,230,124,56,0	;V
	DC.B	230,230,230,230,254,238,198,0	;W
	DC.B	198,238,124,56,124,238,198,0	;X
	DC.B	230,230,230,124,56,56,56,0	;Y
	DC.B	254,206,28,56,112,230,254,0	;Z


       SECTION BSS


          DS.B  256
	  DS.B	160*8
BUFFER    DS.B  64000
          DS.B  256
BUFFERSCR	DS.B	160*8
POINT	DS.L	1
NB_PART	DS.L	1
BUF_LET	DS.B	(1*8)*2
SAUV_SP   DS.L  1
SCREEN1   DS.L  1
SCREEN2   DS.L  1
SCREEN3		DS.L	1
ANC_VBL   DS.L  1


		