PAS_X = 10
PAS_Y = 10
NB_PT_X = 10
NB_PT_Y = 10

MAIN	CLR.L	-(SP)
	MOVE.W	#$20,-(SP)
	TRAP	#1
	ADDQ.W	#6,SP

	CLR.W	-(SP)
	PEA	-1.W
	PEA	-1.W
	MOVE.W	#5,-(SP)
	TRAP	#14
	LEA	12(SP),SP

	BSR	PREP_ECR
	MOVE.L	#COORS,PT_REB

	MOVE.W	#$2700,SR
	CLR.B	$FFFFFA07.W
	CLR.B	$FFFFFA09.W
	MOVE.L	#VBLR,$70.W
	MOVE.W	#$2300,SR

IT_VBL	BSR	VSYNC
	BSR	EFF
	BSR	GEST_REBOND
	BSR	SWAPEC
	BRA	IT_VBL

GEST_REBOND	MOVE.L	PT_REB,A0
	MOVEQ	#7,D7
.REPEAT	MOVE.W	(A0)+,D0	;Y
	BLT.S	.ON_Y_RETOURNE
	MULU.W	#160,D0
	MOVE.L	SCREEN2,A1
	ADDA.W	D0,A1
	MOVEQ	#-1,D1
	MOVE.W	D1,(A1)
	MOVE.W	D1,8(A1)
	MOVE.W	D1,16(A1)
	MOVE.W	D1,24(A1)
	MOVE.W	D1,32(A1)
	MOVE.W	D1,40(A1)
	MOVE.W	D1,48(A1)
	MOVE.W	D1,56(A1)
	MOVE.W	D1,64(A1)
	MOVE.W	D1,72(A1)
	MOVE.W	D1,80(A1)
	MOVE.W	D1,88(A1)
	MOVE.W	D1,96(A1)
	MOVE.W	D1,104(A1)
	MOVE.W	D1,112(A1)
	MOVE.W	D1,120(A1)
	MOVE.W	D1,128(A1)
	MOVE.W	D1,136(A1)
	MOVE.W	D1,144(A1)
	MOVE.W	D1,152(A1)
.ON_Y_RETOURNE	DBRA	D7,.REPEAT
	CMPI.W	#$1234,(A0)
	BNE.S	.OK
	LEA	-16(A0),A0
.OK	MOVE.L	A0,PT_REB
	RTS

EFF	MOVE.L	SCREEN2,A1
	MOVEQ	#0,D1
	MOVE.W	#199,D7
.FUCK	MOVE.W	D1,(A1)
	MOVE.W	D1,8(A1)
	MOVE.W	D1,16(A1)
	MOVE.W	D1,24(A1)
	MOVE.W	D1,32(A1)
	MOVE.W	D1,40(A1)
	MOVE.W	D1,48(A1)
	MOVE.W	D1,56(A1)
	MOVE.W	D1,64(A1)
	MOVE.W	D1,72(A1)
	MOVE.W	D1,80(A1)
	MOVE.W	D1,88(A1)
	MOVE.W	D1,96(A1)
	MOVE.W	D1,104(A1)
	MOVE.W	D1,112(A1)
	MOVE.W	D1,120(A1)
	MOVE.W	D1,128(A1)
	MOVE.W	D1,136(A1)
	MOVE.W	D1,144(A1)
	MOVE.W	D1,152(A1)
	LEA	160(A1),A1
	DBRA	D7,.FUCK
	RTS

VSYNC	CMPI.W	#1,NB_VBL
	BLT.S	VSYNC
	CLR.W	NB_VBL
	RTS

VBLR	ADDQ.W	#1,NB_VBL
	RTE

SWAPEC	MOVE.L	SCREEN1,D0
	MOVE.L	SCREEN2,SCREEN1
	MOVE.L	D0,SCREEN2
	MOVE.B	SCREEN1+1,$FFFF8201.W
	MOVE.B	SCREEN1+2,$FFFF8203.W
	RTS

PREP_ECR	MOVE.L	#BUFFER,D0
	CLR.B	D0
	MOVE.L	D0,SCREEN1
	ADDI.L	#32000,D0
	MOVE.L	D0,SCREEN2
	MOVE.B	SCREEN1+1,$FFFF8201.W
	MOVE.B	SCREEN1+2,$FFFF8203.W
	RTS

COORS	INCBIN	REB_COOL.DAT
	DC.W	$1234

	SECTION	BSS
PT_REB	DS.L	1
NB_VBL	DS.W	1
SCREEN1	DS.L	1
SCREEN2	DS.L	1
	DS.B	256
BUFFER	DS.B	64000