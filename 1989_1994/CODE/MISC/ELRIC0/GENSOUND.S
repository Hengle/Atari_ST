	CLR.L	-(SP)
	MOVE.W	#$20,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP
	MOVE.L	D0,SAUV_SP

	CLR.W	-(SP)
	MOVE.L	#-1,-(SP)
	MOVE.L	#-1,-(SP)
	MOVE.W	#5,-(SP)
	TRAP	#14
	LEA	12(SP),SP

	ANDI.B	#%11111000,$484.W

	MOVE.B	#8,$FFFF8800.W
	MOVE.B	#12,$FFFF8802.W
	MOVE.B	#7,$FFFF8800.W
	BCLR	#0,$FFFF8802.W

	MOVE.L	$70.W,ANC_VBL
	MOVE.L	#VBLR,$70.W

BOUCLE	JMP	BOUCLE

FIN	MOVE.L	ANC_VBL,$70.W

	MOVE.L	#$8080000,$FFFF8800.W
	MOVE.L	#$9090000,$FFFF8800.W
	MOVE.L	#$A0A0000,$FFFF8800.W

	BSET	#0,$484.W
	BSET	#1,$484.W
	BSET	#2,$484.W

	MOVE.L	SAUV_SP,-(SP)
	MOVE.W	#$20,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP

	CLR.W	-(SP)
	TRAP	#1
	ADDQ.L	#2,SP

	*******	V B L  &  P R O C E D U R E S   *******
VBLR	BSR	J_INST
	BSR	TESTT
	CMPI.B	#$39,$FFFFFC02.W
	BEQ	FIN
	CMPI.B	#0,$FFFFFC02.W
	BNE	FINV
	CLR.L	AD
FINV	RTE

J_INST	LEA	INST1,A0
	ADDA.L	AD,A0
	CMPI.B	#-1,(A0)
	BNE	SUITJ
	SUBQ.L	#1,AD
	LEA	INST1,A0
	ADDA.L	AD,A0
SUITJ	MOVE.B	#8,$FFFF8800.W
	MOVE.B	(A0),$FFFF8802.W
	ADDQ.L	#1,AD
	RTS

TESTT	MOVEQ	#0,D1
	MOVEQ	#0,D0
	MOVE.B	$FFFFFC02.W,D1
	LEA	TABLE1,A0
	LSL.W	#1,D1
	ADDA.L	D1,A0
	MOVE.W	(A0),D0
J_N	MOVE.W	D0,D1
	ANDI.W	#%1111111100000000,D0
	LSR.W	#8,D0
	MOVE.B	#0,$FFFF8800.W
	MOVE.B	D1,$FFFF8802.W
	MOVE.B	#1,$FFFF8800.W
	MOVE.B	D0,$FFFF8802.W
	RTS

	SECTION	DATA
TABLE1	DC.W	0,0,0,451,402,0,338,301,268,0,0,0,0,0,0
	DC.W	0,477,425,379,358,318,284,253,239,0,0,0,0,0,0
	DC.W	897,800,0,674,601,536,0,0,0,0,0,0,0,0
	DC.W	847,756,713,636,567,506,477,0,0,0,0,0,0,0
	DC.W	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
	DC.W	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
	DC.W	951
	REPT	120
	DC.W	0
	ENDR

INST1	DC.B	0,2,4,6,8,10,12,14,15,13,11,9,7,5,3,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,-1

	SECTION	BSS
ANC_VBL	DS.L	1
SAUV_SP	DS.L	1
AD	DS.L	1