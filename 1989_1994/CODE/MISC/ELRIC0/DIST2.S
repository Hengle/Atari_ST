	* CODED VERY FASTLY IN 3/4 HOURS
	CLR.L	-(SP)
	MOVE.W	#$20,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP
	MOVE.L	D0,SAUV_SP

	CLR.W	-(SP)
	MOVE.L	#-1,-(SP)
	MOVE.L	#-1,-(SP)
	MOVE.W	#5,-(SP)
	TRAP	#14
	LEA	12(SP),SP

	MOVE.B	#$12,$FFFFFC02.W
	DC.W	$A00A

	MOVE.L	$44E.W,A0
	MOVE.W	#7999,D0
EFF	CLR.L	(A0)+
	DBRA	D0,EFF

	BSR	PREP1
	BSR	MAK_TAB

	MOVE.W	#39,D0
	MOVE.L	$44E.W,A0
EFF2	CLR.L	(A0)+
	DBRA	D0,EFF2

	ANDI.B	#%11111000,$484.W

	MOVE.L	#FIN,$008
	MOVE.L	#FIN,$00C
	MOVE.L	#FIN,$010
	MOVE.L	#FIN,$014
	MOVE.L	#FIN,$018
	MOVE.L	#FIN,$01C
	MOVE.L	#FIN,$020

	MOVEM.L	PAL1(PC),D0-D3
	MOVEM.L	D0-D3,$FFFF8242.W

	MOVE.B	$FFFFFA07.W,MFP
	MOVE.B	$FFFFFA09.W,MFP+1
	MOVE.B	$FFFFFA0F.W,MFP+2
	MOVE.B	$FFFFFA13.W,MFP+3
	MOVE.B	$FFFFFA1B.W,MFP+4
	MOVE.B	$FFFFFA21.W,MFP+5

	CLR.B	$FFFFFA07.W
	CLR.B	$FFFFFA09.W

	MOVE.L	#PAL1,PALET
	MOVEQ	#0,D0
	JSR	MUZAXX

	MOVE.L	$70.W,ANC_VBL
	MOVE.L	#VBLR,$70.W
	MOVE.L	$120.W,ANC_TIM
	MOVE.L	#TB0,$120.W
	CLR.B	$FFFFFA1B.W
	BSET	#0,$FFFFFA07.W
	BSET	#0,$FFFFFA13.W	

BOUCLE	JMP	BOUCLE(PC)

FIN	MOVE.L	ANC_VBL,$70.W
	MOVE.L	ANC_TIM,$120.W

	MOVE.B	MFP,$FFFFFA07.W
	MOVE.B	MFP+1,$FFFFFA09.W
	MOVE.B	MFP+2,$FFFFFA0F.W
	MOVE.B	MFP+3,$FFFFFA13.W
	MOVE.B	MFP+4,$FFFFFA1B.W
	MOVE.B	MFP+5,$FFFFFA21.W

	MOVE.W	#$25,-(SP)
	TRAP	#14
	ADDQ.L	#2,SP
	MOVE.B	#8,$FFFFFC02.W

	MOVE.L	#$8080000,$FFFF8800.W
	MOVE.L	#$9090000,$FFFF8800.W
	MOVE.L	#$A0A0000,$FFFF8800.W

	ORI.B	#%00000111,$484.W

	MOVE.L	SAUV_SP,-(SP)
	MOVE.W	#$20,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP

	CLR.W	-(SP)
	TRAP	#1
	
	*******	V B L  & P R O C E D U R E S   *******
VBLR	JSR	MUZAXX+8
	MOVEQ	#0,D0
	MOVE.L	PALET,A6
	LEA	MVTY,A0
	ADDA.L	AD,A0
	CMPI.L	#-1,(A0)
	BNE	SUITV0
	LEA	MVTY,A0
	CLR.L	AD
SUITV0	MOVE.L	(A0),D0
	ADDA.L	D0,A6
	CLR.B	$FFFFFA1B.W
	MOVE.B	#1,$FFFFFA21.W
	MOVE.B	#8,$FFFFFA1B.W
	CMPI.B	#$39,$FFFFFC02.W
	BEQ	FIN
	ADDQ.L	#1,NO_PAL
	CMPI.L	#7,NO_PAL
	BNE	SUITEX
	CLR.L	NO_PAL
SUITEX	MOVE.L	NO_PAL,D0
	LSL.L	#2,D0
	LEA	CORES1,A0
	ADDA.L	D0,A0
	MOVE.L	(A0),PALET
	ADDQ.L	#4,AD
	RTE

TB0	MOVE.W	(A6)+,$FFFF8242.W
	MOVE.W	(A6)+,$FFFF8244.W
	MOVE.W	(A6)+,$FFFF8246.W
	MOVE.W	(A6)+,$FFFF8248.W
	MOVE.W	(A6)+,$FFFF824A.W
	MOVE.W	(A6)+,$FFFF824C.W
	MOVE.W	(A6)+,$FFFF824E.W
	MOVE.B	#1,$FFFFFA21.W
	MOVE.B	#8,$FFFFFA1B.W
	MOVE.L	#TB0,$120.W
	BCLR	#0,$FFFFFA0F.W
	RTE	 

PREP1	LEA	GRAPH(PC),A0
	MOVE.L	$44E.W,A1
	MOVE.W	#230,D0
NEW_MOT	MOVE.L	(A0),(A1)
	MOVE.W	4(A0),4(A1)
	MOVE.L	6(A0),8(A1)
	MOVE.W	10(A0),12(A1)
	MOVE.L	12(A0),16(A1)
	MOVE.W	16(A0),20(A1)
	MOVE.L	18(A0),24(A1)
	MOVE.W	22(A0),28(A1)
	MOVE.L	24(A0),32(A1)
	MOVE.W	28(A0),36(A1)
	MOVE.L	30(A0),40(A1)
	MOVE.W	34(A0),44(A1)
	MOVE.L	36(A0),48(A1)
	MOVE.W	40(A0),52(A1)
	MOVE.L	(A0),56(A1)
	MOVE.W	4(A0),60(A1)
	MOVE.L	6(A0),64(A1)
	MOVE.W	10(A0),68(A1)
	MOVE.L	12(A0),72(A1)
	MOVE.W	16(A0),76(A1)
	MOVE.L	18(A0),80(A1)
	MOVE.W	22(A0),84(A1)
	MOVE.L	24(A0),88(A1)
	MOVE.W	28(A0),92(A1)
	MOVE.L	30(A0),96(A1)
	MOVE.W	34(A0),100(A1)
	MOVE.L	36(A0),104(A1)
	MOVE.W	40(A0),108(A1)
	MOVE.L	(A0),112(A1)
	MOVE.W	4(A0),116(A1)
	MOVE.L	6(A0),120(A1)
	MOVE.W	10(A0),124(A1)
	MOVE.L	12(A0),128(A1)
	MOVE.W	16(A0),132(A1)
	MOVE.L	18(A0),136(A1)
	MOVE.W	22(A0),140(A1)
	MOVE.L	24(A0),144(A1)
	MOVE.W	28(A0),148(A1)
	MOVE.L	30(A0),152(A1)
	MOVE.W	34(A0),156(A1)
	LEA	160(A1),A1
	DBRA	D0,NEW_MOT
	RTS

MAK_TAB	LEA	PAL1,A0
	LEA	BUF1,A1
	MOVE.W	#230,D0	
	BSR	DEC_TAB
	LEA	BUF1,A0
	LEA	BUF2,A1
	MOVE.W	#230,D0	
	BSR	DEC_TAB
	LEA	BUF2,A0
	LEA	BUF3,A1
	MOVE.W	#230,D0	
	BSR	DEC_TAB
	LEA	BUF3,A0
	LEA	BUF4,A1
	MOVE.W	#230,D0	
	BSR	DEC_TAB
	LEA	BUF4,A0
	LEA	BUF5,A1
	MOVE.W	#230,D0	
	BSR	DEC_TAB
	LEA	BUF5,A0
	LEA	BUF6,A1
	MOVE.W	#230,D0	
	BSR	DEC_TAB
	RTS

DEC_TAB:
BCL1	MOVE.W	2(A0),(A1)
	MOVE.W	4(A0),2(A1)
	MOVE.W	6(A0),4(A1)
	MOVE.W	8(A0),6(A1)
	MOVE.W	10(A0),8(A1)
	MOVE.W	12(A0),10(A1)
	MOVE.W	(A0),12(A1)
	LEA	14(A0),A0
	LEA	14(A1),A1
	DBRA	D0,BCL1
	RTS

	SECTION	DATA
MUZAXX	INCBIN	3.MUS

GRAPH	DC.W	%1010101101010110
	DC.W	%0110011011001101
	DC.W	%0001111000111100
	
	DC.W	%1010110101011010	
	DC.W	%1001101100110110
	DC.W	%0111100011110001
	
	DC.W	%1011010101101010
	DC.W	%0110110011011001
	DC.W	%1110001111000111
	
	DC.W	%1101010110101011
	DC.W	%1011001101100110
	DC.W	%1000111100011110
	
	DC.W	%0101011010101101	
	DC.W	%1100110110011011
	DC.W	%0011110001111000
	
	DC.W	%0101101010110101
	DC.W	%0011011001101100
	DC.W	%1111000111100011
	
	DC.W	%0110101011010101
	DC.W	%1101100110110011
	DC.W	%1100011110001111
		
PAL1	REPT	7 
	DC.W	$000,$777,$000,$000,$000,$777,$000
	DC.W	$000,$777,$000,$000,$000,$777,$000
	DC.W	$000,$777,$000,$000,$000,$777,$000
	DC.W	$000,$777,$000,$000,$000,$777,$000
	DC.W	$000,$777,$777,$777,$777,$777,$000
	DC.W	$000,$777,$000,$000,$000,$777,$000
	DC.W	$000,$777,$000,$000,$000,$777,$000
	DC.W	$000,$777,$000,$000,$000,$777,$000
	DC.W	$000,$777,$000,$000,$000,$777,$000
	DC.W	$000,$000,$000,$000,$000,$000,$000
	DC.W	$000,$000,$000,$000,$000,$000,$000
	DC.W	$000,$000,$000,$000,$000,$000,$000
	DC.W	$000,$000,$000,$000,$000,$000,$000
	DC.W	$000,$000,$000,$000,$000,$000,$000
	DC.W	$000,$777,$777,$777,$777,$777,$000
	DC.W	$000,$777,$777,$777,$777,$777,$000
	DC.W	$000,$777,$777,$777,$777,$777,$000
	DC.W	$000,$000,$000,$000,$000,$000,$000
	DC.W	$000,$000,$000,$000,$000,$000,$000
	DC.W	$000,$000,$000,$000,$000,$000,$000
	DC.W	$000,$000,$000,$000,$000,$000,$000
	DC.W	$000,$777,$777,$777,$777,$777,$000
	DC.W	$000,$777,$000,$000,$000,$000,$000
	DC.W	$000,$777,$000,$000,$000,$000,$000
	DC.W	$000,$777,$000,$000,$000,$000,$000
	DC.W	$000,$777,$000,$000,$000,$000,$000
	DC.W	$000,$777,$000,$000,$000,$000,$000
	DC.W	$000,$777,$000,$000,$000,$000,$000
	DC.W	$000,$777,$000,$000,$000,$000,$000
	DC.W	$000,$777,$777,$777,$777,$777,$000
	DC.W	$000,$000,$000,$000,$000,$000,$000
	ENDR
	DC.W	$000,$000,$000,$000,$000,$000,$000
	DC.W	$000,$777,$000,$000,$000,$777,$000
	DC.W	$000,$777,$000,$000,$000,$777,$000
	DC.W	$000,$777,$000,$000,$000,$777,$000
	DC.W	$000,$777,$000,$000,$000,$777,$000
	DC.W	$000,$777,$777,$777,$777,$777,$000
	DC.W	$000,$777,$000,$000,$000,$777,$000
	DC.W	$000,$777,$000,$000,$000,$777,$000
	DC.W	$000,$777,$000,$000,$000,$777,$000
	DC.W	$000,$777,$000,$000,$000,$777,$000
	DC.W	$000,$000,$000,$000,$000,$000,$000
	DC.W	$000,$000,$000,$000,$000,$000,$000
	DC.W	$000,$000,$000,$000,$000,$000,$000
	DC.W	$000,$000,$000,$000,$000,$000,$000

CORES1	DC.L	PAL1,BUF1,BUF2,BUF3,BUF4,BUF5,BUF6

MVTY	DC.L	0,14,14*2,14*3,14*4,14*5,14*6,14*7,14*8,14*9
	DC.L	14*10,14*11,14*12,14*13,14*14,14*15
	DC.L	14*16,14*17,14*18,14*19,14*20,14*21
	DC.L	14*22,14*23,14*24,14*25,14*26,14*27
	DC.L	14*28,14*29,14*30,14*31
	DC.L	14*30,14*29,14*28,14*27
	DC.L	14*26,14*25,14*24,14*23,14*22,14*21
	DC.L	14*20,14*19,14*18,14*17,14*16,14*15
	DC.L	14*14,14*13,14*12,14*11,14*10,14*9
	DC.L	14*8,14*7,14*6,14*5,14*4,14*3,14*2,14,0,-1

	SECTION	BSS
MFP	DS.B	8
SAUV_SP	DS.L	1
ANC_VBL	DS.L	1	
ANC_TIM	DS.L	1
PALET	DS.L	1
NO_PAL	DS.L	1
AD	DS.L	1	
BUF1	DS.W	1617
BUF2	DS.W	1617
BUF3	DS.W	1617
BUF4	DS.W	1617
BUF5	DS.W	1617
BUF6	DS.W	1617