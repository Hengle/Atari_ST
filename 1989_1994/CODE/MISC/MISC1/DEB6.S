DEBUT:	MOVEA.L  A7,A5
	LEA.L 	D_PILE,A7
	MOVE.L 	4(A5),A5
	MOVE.L 	$C(A5),D0
	ADD.L 	$14(A5),D0
	ADD.L 	$1C(A5),D0
	ADD.L 	#$100,D0		
	MOVE.L 	D0,-(SP)		
	MOVE.L 	A5,-(SP)
	MOVE 	#0,-(SP)
	MOVE 	#$4A,-(SP)
	TRAP 	#1
	LEA 	12(SP),SP


	CLR.L	-(SP)
	MOVE	#$20,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP
	
	CLR	-(SP)
	MOVE.L	#-1,-(SP)	
	MOVE.L	#-1,-(SP)
	MOVE	#5,-(SP)
	TRAP	#14
	ADDA.L	#12,SP
	CLR.L	PNTXT
	CLR.L	PNTZ
	MOVE.L	#8,PNTZ
	
	move.l	#BUFFERSCR,d0
	and.l	#$ffffff00,d0		
	move.l	d0,SCREEN1		
	add.l	#32000,d0		
	move.l	d0,SCREEN2

	move.l	SCREEN1,d0	
;	move.l	SCREEN2,SCREEN1		
;	move.l	d0,SCREEN2
	lsr.l	#8,d0		
	move.l	#$ffff8201,a0
	movep	d0,(a0)




	
	MOVE	#$700,$FFFF8242.W
	MOVE	#$500,$FFFF8244.W
	MOVE	#$300,$FFFF8248.W
	MOVE	#$100,$FFFF8250.W

	MOVEA.L	SCREEN1,A0
	LEA	FNT+34,A1
	MOVE.L	#(40*64)-1,D0
COPY	
	MOVE.B	(A1),(A0)
	MOVE.B	(A1),64*160(A0)
	MOVE.B	(A1),64*160*2(A0)
	MOVE.B	(A1),64*160*3(A0)
	MOVE.B	1(A1),1(A0)
	MOVE.B	1(A1),64*160+1(A0)
	MOVE.B	1(A1),64*160*2+1(A0)
	MOVE.B	1(A1),64*160*3+1(A0)

	LEA	4(A1),A1
	LEA	4(A0),A0
	DBF	D0,COPY
;
;
	MOVEA.L	SCREEN1,A0
	LEA	64*160(A0),A0
	JSR	DECAL
	MOVEA.L	SCREEN1,A0
	LEA	64*160*2(A0),A0
	JSR	DECAL
	MOVEA.L	SCREEN1,A0
	LEA	64*160*2(A0),A0

	JSR	DECAL
	MOVEA.L	SCREEN1,A0
	LEA	64*160*3(A0),A0
	JSR	DECAL
	MOVEA.L	SCREEN1,A0
	LEA	64*160*3(A0),A0

	JSR	DECAL
	MOVEA.L	SCREEN1,A0
	LEA	64*160*3(A0),A0

	JSR	DECAL

	LEA	BUF1,A0
	MOVEA.L	SCREEN1,A1
	MOVE.L	#(40*64*4)-1,D0
DO_IT	MOVE.L	(A1)+,(A0)+
	DBF	D0,DO_IT	

;	JSR	VOID

	
	REPT	4
	MOVEA.L	SCREEN1,A0
	JSR	DECAL
	ENDR
	REPT	4
	MOVEA.L	SCREEN1,A0
	LEA	64*160(A0),A0
	JSR	DECAL
	ENDR

	REPT	4
	MOVEA.L	SCREEN1,A0
	LEA	64*160*2(A0),A0

	JSR	DECAL
	ENDR

	REPT	4
	MOVEA.L	SCREEN1,A0
	LEA	64*160*3(A0),A0

	JSR	DECAL
	ENDR



	LEA	BUF1,A0
	MOVEA.L	SCREEN1,A1
	MOVE.L	#(40*64*4)-1,D0
DO_IT_AGAIN	MOVE.B	(A1),D1
	MOVE.B	1(A1),D2
	OR.B	D1,2(A0)
	OR.B	D2,3(A0)
	LEA	8(A0),A0
	LEA	8(A1),A1
	DBF	D0,DO_IT_AGAIN
;	JSR	VOID
	
	REPT	4
	MOVEA.L	SCREEN1,A0
	JSR	DECAL
	ENDR
	
	REPT	4
	MOVEA.L	SCREEN1,A0
	LEA	64*160(A0),A0
	JSR	DECAL
	ENDR

	REPT	4
	MOVEA.L	SCREEN1,A0
	LEA	64*160*2(A0),A0
	JSR	DECAL
	ENDR

	REPT	4
	MOVEA.L	SCREEN1,A0
	LEA	64*160*3(A0),A0
	JSR	DECAL
	ENDR


	
	LEA	BUF1,A0
	MOVEA.L	SCREEN1,A1
	MOVE.L	#(40*64*4)-1,D0
DO_IT_AGAI	MOVE.B	(A1),D1
	MOVE.B	1(A1),D2
	OR.B	D1,4(A0)
	OR.B	D2,5(A0)
	LEA	8(A0),A0
	LEA	8(A1),A1
	DBF	D0,DO_IT_AGAI


;	JSR	VOID
	
	REPT	4
	MOVEA.L	SCREEN1,A0
	JSR	DECAL
	ENDR
	REPT	4
	MOVEA.L	SCREEN1,A0
	LEA	64*160(A0),A0

	JSR	DECAL
	ENDR

	REPT	4
	MOVEA.L	SCREEN1,A0
	LEA	64*160*2(A0),A0

	JSR	DECAL
	ENDR

	REPT	4
	MOVEA.L	SCREEN1,A0
	LEA	64*160*3(A0),A0

	JSR	DECAL
	ENDR

;	JSR	VOID


	LEA	BUF1,A0
	MOVEA.L	SCREEN1,A1
	MOVE.L	#(40*64*4)-1,D0
DO_IT_AGA	MOVE.B	(A1),D1
	MOVE.B	1(A1),D2
	OR.B	D1,6(A0)
	OR.B	D2,7(A0)
	LEA	8(A0),A0
	LEA	8(A1),A1
	DBF	D0,DO_IT_AGA

COOL	
	JSR	EFF_SCR

;	MOVEA.L	SCREEN1,A1
;	LEA	BUF1,A0
;	MOVE.L	#(40*4*64)-1,D0
;AFF	MOVE.L	(A0),(A1)

;;	MOVE.B	4(A0),4(A1)
;;	MOVE.B	5(A0),5(A1)

;	LEA	8(A0),A0
;	LEA	8(A1),A1
;	DBF	D0,AFF
	
;	MOVE	#7,-(SP)
;	TRAP	#1
;	ADDQ.L	#2,SP
	
;	TRAP	#1


	MOVE.L	#FIN,$008.W
	MOVE.L	#FIN,$00C.W
	MOVE.L	#FIN,$010.W
			
	MOVE.B	$FFFFFA07.W,MFP1
	MOVE.B	$FFFFFA09.W,MFP2
	MOVE.B	$FFFFFA0F.W,MFP3
	MOVE.B	$FFFFFA13.W,MFP4
	MOVE.B	$FFFFFA1B.W,MFP5
	MOVE.B	$FFFFFA21.W,MFP6
	
	CLR.B	$FFFFFA07.W
	CLR.B	$FFFFFA09.W
	
	MOVE	#4,-(SP)
	TRAP 	#14
	ADDQ.L	#2,SP
	MOVE	D0,RES
	
	MOVE	#2,-(SP)
	TRAP 	#14
	ADDQ.L 	#2,SP
	MOVE.L	D0,ANC_ECR
	
	CLR.W 	-(SP)
	MOVE.L	#-1,-(SP)
	MOVE.L	#-1,-(SP)
	MOVE 	#5,-(SP)
	TRAP 	#14
	LEA.L 	12(SP),SP


	LEA.L	$FFFF8240.W,A0
	MOVEM.L	(A0),D0-D7
	LEA.L	ANC_PAL,A0
	MOVEM.L	D0-D7,(A0)
	
        
	MOVE.L	$70.W,ANC_VBL
	MOVE.L	#VBL_IR,$70.W
	MOVE.L	$120.W,ANC_TB
	MOVE.L	#TB0_IR,$120.W
	
	DC.W	$A00A
	MOVE.B	#$12,$FFFFFC02.W
	
	CLR.B	$FFFFFA1B.W
	BSET	#0,$FFFFFA07.W
	BSET	#0,$FFFFFA13.W


BOUCLE	JMP	BOUCLE

FIN:	
	MOVE.B	#8,$FFFFFC02.W
	MOVE.B	MFP1,$FFFFFA07.W
	MOVE.B	MFP2,$FFFFFA09.W
	MOVE.B	MFP3,$FFFFFA0F.W
	MOVE.B	MFP4,$FFFFFA13.W
	MOVE.B	MFP5,$FFFFFA1B.W
	MOVE.B	MFP6,$FFFFFA21.W
	
	MOVE.L	ANC_VBL,$70.W
	MOVE.L	ANC_TB,$120.W
	
	LEA.L	ANC_PAL,A0
	MOVEM.L	(A0),D0-D7
	LEA.L	$FFFF8240.W,A0
	MOVEM.L	D0-D7,(A0)
	
	MOVE 	RES,-(SP)	
	MOVE.L	ANC_ECR,-(SP)	
	MOVE.L	ANC_ECR,-(SP)	
	MOVE 	#5,-(SP)	
	TRAP 	#14		
	LEA.L 	12(SP),SP	
	
	MOVE.L	SAUVE,-(SP)	
	MOVE 	#$20,-(SP)	
	TRAP 	#1		
	ADDQ.L 	#6,SP		
	
;	PEA	CHUT_DA	   	
;	MOVE	#$20,-(A7) 	
;	TRAP	#14        	
;	ADDQ.L	#6,A7      	

	CLR.W 	-(SP)		
	TRAP	#1		
	




 


TB0_IR	
	CLR.B	$FFFFFA1B.W
	MOVE.B	#1,$FFFFFA21.W
	MOVE.B	#8,$FFFFFA1B.W
;	MOVE.L	#TB0_IR,$120
	BCLR	#0,$FFFFFA0F.W
	RTE			



VBL_IR	
	CLR	$FFFF8240.W
	CLR.B	$FFFFFA1B.W
	MOVE.B	#1,$FFFFFA21.W
	MOVE.B	#8,$FFFFFA1B.W

	
	CLR.L	D0
	CLR.L	D1

	LEA	PATH1B,A3
	ADDA.L	PNTZ,A3
	ADDA.L	PNTZ,A3
	
	MOVE.L	#15,D7
AICI	CLR.L	D0
	MOVEA.L	SCREEN1,A4
	MOVE	(A3)+,D2
	ADDA.L	D2,A4

N	SET	0	
	rept	16
	CLR	N(A4)
	CLR	N+8(A4)
N	SET	N+160
	ENDR

;	JSR	VOID
;	JSR	EFF_SCR

	LEA	6(A2),A2
	LEA	12(A3),A3
;	ADDA.L	PNTZ,A2
;	ADDA.L	PNTZ,A3
;	ADDA.L	PNTZ,A3

	DBF	D7,AICI

	SUBQ.L	#1,PNTZ
	CMPI.L	#-1,PNTZ
	BNE.S	GAG
	MOVE.L	#6,PNTZ
	ADDQ.L	#1,PNTXT
GAG	

	MOVE	#$070,$FFFF8240.W
GASP
	CLR.L	D0
	CLR.L	D1
	MOVEA.L	SCREEN1,A4

	LEA	PATH1B,A3
	ADDA.L	PNTZ,A3
	ADDA.L	PNTZ,A3
	LEA	PATH1A,A2
	ADDA.L	PNTZ,A2
	
	LEA	TXT,A0
	ADDA.L	PNTXT,A0
	CMPI.B	#-1,(A0)
	BEQ	FIN
	MOVE.L	#15,D7
ICI	CLR.L	D0
	MOVEA.L	SCREEN1,A4
	LEA	TABLE-4,A1
	MOVE.B	(A0)+,D0
	SUBI.L	#65,D0
	LSL	#6,D0
	ADDA.L	D0,A1
	MOVE.B	(A2)+,D1
	ADDA.L	D1,A1	OKAY
	MOVE	(A3)+,D2
	ADDA.L	D2,A4
	MOVE.L	(A1),A1

N	SET	0	
	rept	16
	MOVE	N(A1),D2
	MOVE	N+8(A1),D3
	OR	D2,N(A4)
	OR	D3,N+8(A4)
N	SET	N+160
	ENDR

;	JSR	VOID
;	JSR	EFF_SCR

	LEA	6(A2),A2
	LEA	12(A3),A3
;	ADDA.L	PNTZ,A2
;	ADDA.L	PNTZ,A3
;	ADDA.L	PNTZ,A3

	DBF	D7,ICI

;	JSR	VOID
JH	
;	JSR	EFF_SCR

	MOVE	#$777,$FFFF8240.W
	CMPI.B	#$39,$FFFFFC02.W
	BEQ	FIN
	RTE



DECAL

KOOKOO	MOVE.L	#63,D1
LIGNE	MOVE.L	#19,D0
DECALE	
	ROXR	(A0)
	LEA	8(A0),A0
	DBF	D0,DECALE

	DBF	D1,LIGNE
	RTS
	
VOID	MOVEM.L	D0-D7/A0-A6,SAV
	MOVE	#$7,-(SP)
	TRAP	#1
	ADDQ.L	#2,SP	
	MOVEM.L	SAV,D0-D7/A0-A6
	RTS
EFF_SCR

	MOVEA.L	SCREEN1,A6
	MOVE.L	#7999,D6
EFFACE	CLR.L	(A6)+
	DBF	D6,EFFACE
	RTS
	
	SECTION	DATA
TXT
	REPT	10
	DC.B	'ZAPPYFROMHOLOCAUSTPRESENTSJAPANESEJOURNEY'
	ENDR
	DC.L	-1
	EVEN
TABLE
N	SET	0
	REPT	10
	DC.L	BUF1+N,BUF1+N+64*160,BUF1+N+64*160*2,BUF1+N+64*160*3
	DC.L	BUF1+2+N,BUF1+N+2+64*160,BUF1+N+2+64*160*2,BUF1+N+2+64*160*3
	DC.L	BUF1+4+N,BUF1+N+4+64*160,BUF1+N+4+64*160*2,BUF1+N+4+64*160*3
	DC.L	BUF1+6+N,BUF1+N+6+64*160,BUF1+N+6+64*160*2,BUF1+N+6+64*160*3
N	SET	N+16
	ENDR
N	SET	16*160
	REPT	10
	DC.L	BUF1+N,BUF1+N+64*160,BUF1+N+64*160*2,BUF1+N+64*160*3
	DC.L	BUF1+2+N,BUF1+N+2+64*160,BUF1+N+2+64*160*2,BUF1+N+2+64*160*3
	DC.L	BUF1+4+N,BUF1+N+4+64*160,BUF1+N+4+64*160*2,BUF1+N+4+64*160*3
	DC.L	BUF1+6+N,BUF1+N+6+64*160,BUF1+N+6+64*160*2,BUF1+N+6+64*160*3
N	SET	N+16
	ENDR
N	SET	16*160*2
	REPT	10
	DC.L	BUF1+N,BUF1+N+64*160,BUF1+N+64*160*2,BUF1+N+64*160*3
	DC.L	BUF1+2+N,BUF1+N+2+64*160,BUF1+N+2+64*160*2,BUF1+N+2+64*160*3
	DC.L	BUF1+4+N,BUF1+N+4+64*160,BUF1+N+4+64*160*2,BUF1+N+4+64*160*3
	DC.L	BUF1+6+N,BUF1+N+6+64*160,BUF1+N+6+64*160*2,BUF1+N+6+64*160*3
N	SET	N+16
	ENDR

N	SET	16*160*3
	REPT	10
	DC.L	BUF1+N,BUF1+N+64*160,BUF1+N+64*160*2,BUF1+N+64*160*3
	DC.L	BUF1+2+N,BUF1+N+2+64*160,BUF1+N+2+64*160*2,BUF1+N+2+64*160*3
	DC.L	BUF1+4+N,BUF1+N+4+64*160,BUF1+N+4+64*160*2,BUF1+N+4+64*160*3
	DC.L	BUF1+6+N,BUF1+N+6+64*160,BUF1+N+6+64*160*2,BUF1+N+6+64*160*3
N	SET	N+16
	ENDR




FNT	INCBIN	FNT_16_2.PI1
PATH1A	
 DC.B 64
 DC.B 8
 DC.B 16
 DC.B 24
 DC.B 32
 DC.B 40
 DC.B 48
 DC.B 56
 DC.B 64
 DC.B 8
 DC.B 16
 DC.B 24
 DC.B 32
 DC.B 40
 DC.B 48
 DC.B 56
 DC.B 64
 DC.B 8
 DC.B 16
 DC.B 24
 DC.B 32
 DC.B 40
 DC.B 48
 DC.B 56
 DC.B 64
 DC.B 8
 DC.B 16
 DC.B 24
 DC.B 32
 DC.B 40
 DC.B 48
 DC.B 56
 DC.B 64
 DC.B 8
 DC.B 16
 DC.B 24
 DC.B 32
 DC.B 40
 DC.B 48
 DC.B 56
 DC.B 64
 DC.B 8
 DC.B 16
 DC.B 24
 DC.B 32
 DC.B 40
 DC.B 48
 DC.B 56
 DC.B 64
 DC.B 8
 DC.B 16
 DC.B 24
 DC.B 32
 DC.B 40
 DC.B 48
 DC.B 56
 DC.B 64
 DC.B 8
 DC.B 16
 DC.B 24
 DC.B 32
 DC.B 40
 DC.B 48
 DC.B 56
 DC.B 64
 DC.B 8
 DC.B 16
 DC.B 24
 DC.B 32
 DC.B 40
 DC.B 48
 DC.B 56
 DC.B 64
 DC.B 8
 DC.B 16
 DC.B 24
 DC.B 32
 DC.B 40
 DC.B 48
 DC.B 56
 DC.B 64
 DC.B 8
 DC.B 16
 DC.B 24
 DC.B 32
 DC.B 40
 DC.B 48
 DC.B 56
 DC.B 64
 DC.B 8
 DC.B 16
 DC.B 24
 DC.B 32
 DC.B 40
 DC.B 48
 DC.B 56
 DC.B 64
 DC.B 8
 DC.B 16
 DC.B 24
 DC.B 32
 DC.B 40
 DC.B 48
 DC.B 56
 DC.B 64
 DC.B 8
 DC.B 16
 DC.B 24
 DC.B 32
 DC.B 40
 DC.B 48
 DC.B 56
 DC.B 64
 DC.B 8
 DC.B 16
 DC.B 24
 DC.B 32
 DC.B 40
 DC.B 48
 DC.B 56
 DC.B 64
 DC.B 8
 DC.B 16
 DC.B 24
 DC.B 32
 DC.B 40
 DC.B 48
 DC.B 56
 DC.B 64
 DC.B 8
 DC.B 16
 DC.B 24
 DC.B 32
 DC.B 40
 DC.B 48
 DC.B 56
 DC.B 64
 DC.B 8
 DC.B 16
 DC.B 24
 DC.B 32
 DC.B 40
 DC.B 48
 DC.B 56
 DC.B 64
 DC.B 8
 DC.B 16
 DC.B 24
 DC.B 32
 DC.B 40
 DC.B 48
 DC.B 56
 DC.B 64
 DC.B 8
 DC.B 16
 DC.B 24
 DC.B 32
 DC.B 40
 DC.B 48
 DC.B 56
 DC.B 64

	DC.L	-1
PATH1B
 DC 14872
 DC 14720
 DC 14560
 DC 14400
 DC 14240
 DC 14080
 DC 14080
 DC 13920
 DC 13760
 DC 13608
 DC 13608
 DC 13448
 DC 13288
 DC 13288
 DC 13128
 DC 13128
 DC 12968
 DC 12976
 DC 12976
 DC 12816
 DC 12816
 DC 12816
 DC 12816
 DC 12816
 DC 12816
 DC 12824
 DC 12824
 DC 12824
 DC 12824
 DC 12824
 DC 12824
 DC 12984
 DC 12984
 DC 12992
 DC 13152
 DC 13152
 DC 13312
 DC 13312
 DC 13472
 DC 13472
 DC 13632
 DC 13800
 DC 13960
 DC 13960
 DC 14120
 DC 14280
 DC 14440
 DC 14600
 DC 14760
 DC 14928
 DC 15088
 DC 15248
 DC 15408
 DC 15568
 DC 15728
 DC 15888
 DC 16048
 DC 16216
 DC 16376
 DC 16376
 DC 16536
 DC 16696
 DC 16856
 DC 17016
 DC 17176
 DC 17344
 DC 17504
 DC 17664
 DC 17824
 DC 17984
 DC 17984
 DC 18144
 DC 18304
 DC 18472
 DC 18472
 DC 18632
 DC 18632
 DC 18792
 DC 18792
 DC 18952
 DC 18952
 DC 18960
 DC 19120
 DC 19120
 DC 19120
 DC 19120
 DC 19120
 DC 19120
 DC 19120
 DC 19128
 DC 19128
 DC 19128
 DC 19128
 DC 19128
 DC 18968
 DC 18968
 DC 18968
 DC 18816
 DC 18816
 DC 18656
 DC 18656
 DC 18496
 DC 18336
 DC 18336
 DC 18176
 DC 18024
 DC 17864
 DC 17864
 DC 17704
 DC 17544
 DC 17384
 DC 17224
 DC 17064
 DC 16912
 DC 16752
 DC 16592
 DC 16432
 DC 16272
 DC 16112
 DC 15952
 DC 15792
 DC 15640
 DC 15480
 DC 15320
 DC 15160
 DC 15000
 DC 14840
 DC 14840
 DC 14680
 DC 14528
 DC 14368
 DC 14208
 DC 14048
 DC 13888
 DC 13888
 DC 13728
 DC 13568
 DC 13576
 DC 13416
 DC 13416
 DC 13256
 DC 13256
 DC 13096
 DC 13096
 DC 12936
 DC 12944
 DC 12944
 DC 12944
 DC 12944
 DC 12944
 DC 12944
 DC 12944
 DC 12944
 DC 12952
 DC 12952
 DC 12952
 DC 12952
 DC 13112
 DC 13112
 DC 13112
 DC 13272

	DC.L	-1
	
	SECTION	BSS
F_PILE	DS.L 	128	
D_PILE	DS.L 	1	

	DS.B	256
BUFFERSCR	DS.B	64000
	DS.B	256
BUF1	DS.B	64*160*4
BUF2	DS.B	160*16
SAV	DS.L	16
SCREEN1	DS.L	1
SCREEN2	DS.L	1
PNTXT	DS.L	1
PNTZ	DS.L	1
SAUVE	DS.L	1	
ANC_VBL DS.L	1	
ANC_TB	DS.L	1	
ANC_ECR	DS.L	1	
RES	DS.W	1	
ANC_PAL	DS.W	16
MFP1	DS.B	1
MFP2	DS.B	1
MFP3	DS.B	1
MFP4	DS.B	1
MFP5	DS.B	1
MFP6	DS.B	1
TT	DS.L	1