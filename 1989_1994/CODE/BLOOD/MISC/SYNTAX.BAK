	CLR.L	-(SP)
	MOVE.W	#$20,-(SP)
	TRAP	#1
	ADDQ.W	#6,SP

	MOVE.W	#3,-(A7)
	CLR.L	-(A7)
	MOVE.L	#2,-(A7)
	CLR.L	-(A7)
	PEA	BUF_LOAD
	MOVE.W	#8,-(A7)
	TRAP	#14
	LEA	2(A7),A7
	BSR	VSYNC
	MOVE.B	#2,$FFFF820A.W
	CLR.B	$FFFF8260.W

	MOVE.L	$24.W,SOV_24
	MOVE.L	$C.W,SOV_C
	MOVE.B	$FFFFFA07.W,SOV_A07
	MOVE.B	$FFFFFA09.W,SOV_A09

	MOVE.W	#$2700,SR
	CLR.B	$FFFFFA09.W
	CLR.B	$FFFFFA07.W
	MOVEA.L	(A7),A0	;A0=$10000
	LEA	RT_DECOD(PC),A1
	LEA	BUF_NIB,A2
	MOVE.W	#$43,D0
.COPY_RT	MOVE.B	(A1)+,(A2)+
	DBF	D0,.COPY_RT
	MOVE.W	#$17F,D0
	MOVE.L	#$636F6361,$24.W
	MOVE.L	#$636F6C61,D1
	MOVE.L	#$12345678,$C.W
	LEA	$FFFF8209.W,A1
	MOVEQ	#0,D3
;	JMP	$70.W
RT_DECOD	MOVE.B	(A1),D3
	CMP.W	#$40,D3
	BLT.S	RT_DECOD
	SUB.W	#$40,D3
	NOT.W	D3
	LSR.W	D3,D3
.DECODING	EOR.L	D1,(A0)
	ADD.L	A0,D1
	MOVE.B	(A1),D1
	ROR.L	#7,D1
	MOVE	SR,D1
	ADD.L	$24.W,D1
	NOT.L	D1
	ADD.L	$C.W,D1
	MOVE.B	$FFFFFA09.W,D1
	ADDQ.L	#4,A0
	ADDI.L	#$4E4D4521,$24.W
	ADDI.L	#$534C494D,$C.W
	CLR.L	$426.W
	DBF	D0,.DECODING
	MOVE.L	SOV_24,$24.W
	MOVE.L	SOV_C,$C.W
	MOVE.B	SOV_A07,$FFFFFA07.W
	MOVE.B	SOV_A09,$FFFFFA09.W
	NOP

VSYNC	MOVE.L	$466.W,D0
.STAY	CMP.L	$466.W,D0
	BEQ.S	.STAY
	RTS

MONO_MSG	INCBIN	SYNTAX.MSG

	SECTION	BSS
SOV_24	DS.L	1
SOV_C	DS.L	1
SOV_A07	DS.B	1
SOV_A09	DS.B	1
BUF_NIB	DS.B	10000
BUF_LOAD	DS.B	10000