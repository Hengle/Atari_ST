MAIN	CLR.L	-(SP)
	MOVE.W	#$20,-(SP)
	TRAP	#1
	ADDQ.W	#6,SP

*PASSE 1
	LEA	DATAS,A0
	LEA	BUFFER_W,A1
	LEA	BUFFER_L,A2

.GO	MOVE	(A0)+,D0
	CMPI	#$3140,D0
	BNE.S	.NO_W
	TST	FLAG
	BNE.S	.OK1
	MOVE	#1,FLAG
	MOVE	(A0),(A1)+
	MOVE	(A0)+,SOMME1
	BRA.S	.GO
.OK1	MOVE	(A0)+,(A1)
	MOVE	SOMME1,D5
	SUB	D5,(A1)
	MOVE	(A1)+,D5
	ADD	D5,SOMME1
	BRA.S	.GO
.NO_W
	CMPI	#$2140,D0
	BNE.S	.NO_L
	TST	FLAG2
	BNE.S	.OK2
	MOVE	#1,FLAG2
	MOVE	(A0),(A2)+
	MOVE	(A0)+,SOMME2
	BRA.S	.GO
.OK2
	MOVE	(A0)+,(A2)
	MOVE	SOMME2,D5
	SUB	D5,(A2)
	MOVE	(A2)+,D5
	ADD	D5,SOMME2
	BRA.S	.GO
.NO_L
	CMPI	#$4E75,D0
	BNE.S	.NO_RTS
	MOVE	#$4E75,(A1)+
	MOVE	#$4E75,(A2)+
	CLR	FLAG
	CLR	FLAG2
	BRA	.GO
.NO_RTS	CMPI	#$1234,D0
	BEQ.S	FINI
	MOVE	#$700,$FFFF8240.W
FINI	NOP
	BRA.S	FINI
FLAG	DC	0
FLAG2	DC	0
SOMME1	DC	0
SOMME2	DC	0
	DATA
DATAS	INCBIN	DATAS.EFF
	DC	$1234

	BSS
BUFFER_W	DS.B	100000
BUFFER_L	DS.B	10000
