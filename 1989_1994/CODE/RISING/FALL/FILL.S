X1 = 10
X2 = 300

	CLR.L	-(SP)
	MOVE	#$20,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP
	
	CLR	-(SP)
	PEA	-1.W
	PEA	-1.W
	MOVE	#5,-(SP)
	TRAP	#14
	LEA	12(SP),SP	

	MOVE.L	#FIN,$008.W
	MOVE.L	#FIN,$00C.W
	MOVE.L	#FIN,$010.W
	MOVE.L	#FIN,$014.W

	ST	$FFFF8242.W
	ST	$FFFF8250.W

	LEA	CODE,A0
	MOVE	#8-1,D6
BOUCLE	MOVE	#8-1,D5
	SUB	D6,D5
	MOVE.L	#6,D0	OFFSET
	MOVE	D6,D7
LOOP	MOVE	#$2147,(A0)+
	MOVE	D0,(A0)+
	ADD	#16,D0
	DBF	D7,LOOP
	MOVE	#$89A8,(A0)+
	MOVE	D0,(A0)+
	MOVE.L	#$4E754E71,(A0)+	48 OCT
	TST	D5
	BEQ.S	NONOP
	SUBQ	#1,D5
COMBLE	MOVE.L	#$4E714E71,(A0)+
	DBF	D5,COMBLE
NONOP	DBF	D6,BOUCLE
	MOVE.L	#$89A80006,(A0)+
	MOVE	#$4E75,(A0)
	NOP

	MOVE.L	#VBL,$70.W
J	BRA.S	J
FIN	MOVE.L	4.W,A0
	JMP	(A0)
VBL	SF	$FFFF8240.W
	MOVE.L	#$FFFFFFFF,D7
	MOVE.L	$44E.W,A0
	MOVEQ	#0,D0
N	SET	6
	REPT	10
	MOVE.L	D0,N(A0)
N	SET	N+16
	ENDR
	MOVE.L	$44E.W,A0
	ADDQ.L	#6,A0

	LEA	TABLE,A1
	LEA	TABLE2,A3
	LEA	CODE,A2
MOD	EQU	*+2
	MOVE	#X1,D0
	MOVE	#X2,D1
	LSL	#3,D0
	MOVE.L	(A1,D0.W),D2
	OR.L	D2,(A0)
	LSL	#3,D1
	MOVE.L	(A3,D1.W),D4
	MOVEQ	#0,D4
	MOVE	4(A1,D0.W),D3
;	ADD	4(A3,D1.W),D3
	MULU	#48,D3
	LEA	16-6(A0),A0
	JSR	(A2,D3.W)

	CMPI.B	#$3B,$FFFFFC02.W
	BNE.S	O
	ADD	#1,MOD
O	CMPI.B	#$3C,$FFFFFC02.W
	BNE.S	O2
	SUB	#1,MOD
O2
	CMPI.B	#$F,$FFFFFC02.W
	BNE.S	NCOL
	ST	$FFFF8240.W
NCOL	
	RTE

CODE	DS.B	500
	RTS
;CODE
;N	SET	0
;	REPT	10
;	MOVE.L	D7,N+6(A0)
;N	SET	N+16
;	ENDR
;	OR.L	D4,N+6(A0)
;	RTS


TABLE
N	SET	0
	REPT	20/2
	DC	%1111111111111111,$FFFF,N,0
	DC	%0111111111111111,$FFFF,N,0
	DC	%0011111111111111,$FFFF,N,0
	DC	%0001111111111111,$FFFF,N,0
	DC	%0000111111111111,$FFFF,N,0
	DC	%0000011111111111,$FFFF,N,0
	DC	%0000001111111111,$FFFF,N,0
	DC	%0000000111111111,$FFFF,N,0
	DC	%0000000011111111,$FFFF,N,0
	DC	%0000000001111111,$FFFF,N,0
	DC	%0000000000111111,$FFFF,N,0
	DC	%0000000000011111,$FFFF,N,0
	DC	%0000000000001111,$FFFF,N,0
	DC	%0000000000000111,$FFFF,N,0
	DC	%0000000000000011,$FFFF,N,0
	DC	%0000000000000001,$FFFF,N,0
	DC	0,%1111111111111111,N,0
	DC	0,%0111111111111111,N,0
	DC	0,%0011111111111111,N,0
	DC	0,%0001111111111111,N,0
	DC	0,%0000111111111111,N,0
	DC	0,%0000011111111111,N,0
	DC	0,%0000001111111111,N,0
	DC	0,%0000000111111111,N,0
	DC	0,%0000000011111111,N,0
	DC	0,%0000000001111111,N,0
	DC	0,%0000000000111111,N,0
	DC	0,%0000000000011111,N,0
	DC	0,%0000000000001111,N,0
	DC	0,%0000000000000111,N,0
	DC	0,%0000000000000011,N,0
	DC	0,%0000000000000001,N,0

N	SET	N+1
	ENDR

TABLE2
N	SET	0
	REPT	20/2
	DC	$FFFF,%11111;	LIST
;	OR	D0,(A0)	8150
;N	SET	8
;	REPT	18
;	MOVE	D1,N(A0)	3141
;N	SET	N+8
;	ENDR
;	OR	D2,N(A0)	8568
;	RTS

	CLR.L	-(SP)
	MOVE	#$20,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP
	
	CLR	-(SP)
	PEA	-1.W
	PEA	-1.W
	MOVE	#5,-(SP)
	TRAP	#14
	LEA	12(SP),SP	

	MOVE.L	#FIN,$008.W
	MOVE.L	#FIN,$00C.W
	MOVE.L	#FIN,$010.W
	MOVE.L	#FIN,$014.W
	
	LEA	CODE,A0
	LEA	TABLE,A1

	MOVE.L	A0,(A1)+
	MOVE.L	#8*2,D0
	MOVE	#$C480,(A0)+
	MOVE	#$8590,(A0)+
	MOVE	#$4E75,(A0)+
	MOVE.L	A0,(A1)+
	MOVE.L	#8,D0
	MOVE	#$8190,(A0)+
	MOVE	#$85A8,(A0)+
	MOVE	D0,(A0)+
	MOVE	#$4E75,(A0)+

	MOVE	#17-10,D7
	MOVE	#-1,D6
DOCODE	
	MOVE.L	A0,(A1)+

	MOVE.L	#8*2,D0
	ADDQ	#1,D6
	MOVE	D6,D1
	MOVE	#$8190,(A0)+
DOMOVE	MOVE	#$2141,(A0)+
	MOVE	D0,(A0)+
;	ADDQ	#8,D0
	ADD.L	#16,D0
	DBF	D1,DOMOVE
	MOVE	#$85A8,(A0)+
	MOVE	D0,(A0)+
	MOVE	#$4E75,(A0)+
	DBF	D7,DOCODE



	NOP

	MOVE.L	#VBL,$70.W
H	BRA.S	H
FIN	MOVE.L	4.W,A0
	JMP	(A0)
VBL	SF	$FFFF8240.W
	MOVE.L	$44E.W,A6
	moveq	#0,d0
	MOVE	#199,D1
EFF
N	SET	6
	REPT	10