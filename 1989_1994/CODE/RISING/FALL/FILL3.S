;FILL - ORs/temps r‚el/2 plans (1/4)

;	LIST
;	OR	D0,(A0)	8150
;N	SET	8
;	REPT	18
;	MOVE	D1,N(A0)	3141
;N	SET	N+8
;	ENDR
;	OR	D2,N(A0)	8568
;	RTS

	CLR.L	-(SP)
	MOVE	#$20,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP
	
	CLR	-(SP)
	PEA	-1.W
	PEA	-1.W
	MOVE	#5,-(SP)
	TRAP	#14
	LEA	12(SP),SP	

	MOVE.L	#FIN,$008.W
	MOVE.L	#FIN,$00C.W
	MOVE.L	#FIN,$010.W
	MOVE.L	#FIN,$014.W

	move.l	#BUFFER,d0
	CLR.B	D0
	move.l	d0,SCREEN1		
	add.l	#32000,d0		
	move.l	d0,SCREEN2

	
	LEA	CODE,A0
	LEA	TABLE,A1

	MOVE.L	A0,(A1)+
	MOVE.L	#8*2,D0
	MOVE	#$C480,(A0)+
	MOVE	#$8590,(A0)+
	MOVE	#$4E75,(A0)+
	MOVE.L	A0,(A1)+
	MOVE.L	#8*2,D0
	MOVE	#$8190,(A0)+
	MOVE	#$85A8,(A0)+
	MOVE	D0,(A0)+
	MOVE	#$4E75,(A0)+

	MOVE	#17-10,D7
	MOVE	#-1,D6
DOCODE	
	MOVE.L	A0,(A1)+

	MOVE.L	#8*2,D0
	ADDQ	#1,D6
	MOVE	D6,D1
	MOVE	#$8190,(A0)+
DOMOVE	MOVE	#$2141,(A0)+
	MOVE	D0,(A0)+
;	ADDQ	#8,D0
	ADD.L	#16,D0
	DBF	D1,DOMOVE
	MOVE	#$85A8,(A0)+
	MOVE	D0,(A0)+
	MOVE	#$4E75,(A0)+
	DBF	D7,DOCODE



	NOP

	MOVE.L	#VBL,$70.W
H	BRA.S	H
FIN	MOVE.L	4.W,A0
	JMP	(A0)
VBL	SF	$FFFF8240.W
	MOVE.L	SCREEN2,A6
	moveq	#0,d0
	MOVE	#199,D1
EFF
N	SET	6
	REPT	10
	MOVE.L	D0,N(A6)
N	SET	N+16
	ENDR
	LEA	160(A6),A6
	DBF	D1,EFF
	MOVE	#$002,$FFFF8240.W
	MOVE.L	SCREEN2,A6
	ADDQ	#6,A6
	LEA	TABLE1,A2
	LEA	TABLE2,A3
	MOVE.L	#$FFFFFFFF,D1
	LEA	TABLE,A4
	MOVE	#199,D3
***************************************************************************
ICI
MOD	EQU	*+2
	MOVE	#1,D6	X de d‚part
MOD2	EQU	*+2
	MOVE	#319,D7	X d'arriv‚e

	MOVE.L	A6,A0	1
	MOVE	D6,D5	1
	MOVE	D7,D4	1

	LSR	#5,D7	4
	LSR	#5,D6	4
;	AND	#-32,D7
;	AND	#-32,D6
	SUB	D6,D7	DELTA X	1
	LSL	#2,D7	3

	LSL	#3,D5	3

	ADD	6(A2,D5.W),A0	5
	MOVE.L	(A2,D5.W),D0	motif	5
	LSL	#3,D4	3
	MOVE.L	(A3,D4.W),D2	motif	5

	MOVE.L	(A4,D7.W),A1	5
;	REPT	700
	JSR	(A1)
;	ENDR
	LEA	160(A6),A6
	DBF	D3,ICI
***************************************************************************
	CMPI.B	#$F,$FFFFFC02.W
	BNE.S	NO_T
	MOVE	#$004,$FFFF8240.W
NO_T	NOP
	CMPI.B	#$3B,$FFFFFC02.W
	BNE.S	NO_T2
	ADDQ	#1,MOD
NO_T2	NOP
	CMPI.B	#$3c,$FFFFFC02.W
	BNE.S	NO_T2c
	ADDQ	#1,MOD2
NO_T2c	NOP

	MOVE.L	SCREEN1,D0
	MOVE.L	SCREEN2,SCREEN1
	MOVE.L	D0,SCREEN2

	move.l	SCREEN1,d0	
	lsr.l	#8,d0		
	move.l	#$ffff8201,a0
	movep	d0,(a0)

	RTE

	DATA
TABLE1
N	SET	0
	REPT	10
	DC.L	%11111111111111111111111111111111,N
	DC.L	%01111111111111111111111111111111,N
	DC.L	%00111111111111111111111111111111,N
	DC.L	%00011111111111111111111111111111,N
	DC.L	%00001111111111111111111111111111,N
	DC.L	%00000111111111111111111111111111,N
	DC.L	%00000011111111111111111111111111,N
	DC.L	%00000001111111111111111111111111,N
	DC.L	%00000000111111111111111111111111,N
	DC.L	%00000000011111111111111111111111,N
	DC.L	%00000000001111111111111111111111,N
	DC.L	%00000000000111111111111111111111,N
	DC.L	%00000000000011111111111111111111,N
	DC.L	%00000000000001111111111111111111,N
	DC.L	%00000000000000111111111111111111,N
	DC.L	%00000000000000011111111111111111,N

	DC.L	%00000000000000001111111111111111,N
	DC.L	%00000000000000000111111111111111,N
	DC.L	%00000000000000000011111111111111,N
	DC.L	%00000000000000000001111111111111,N
	DC.L	%00000000000000000000111111111111,N
	DC.L	%00000000000000000000011111111111,N
	DC.L	%00000000000000000000001111111111,N
	DC.L	%00000000000000000000000111111111,N
	DC.L	%00000000000000000000000011111111,N
	DC.L	%00000000000000000000000001111111,N
	DC.L	%00000000000000000000000000111111,N
	DC.L	%00000000000000000000000000011111,N
	DC.L	%00000000000000000000000000001111,N
	DC.L	%00000000000000000000000000000111,N
	DC.L	%00000000000000000000000000000011,N
	DC.L	%00000000000000000000000000000001,N

N	SET	N+16
	ENDR

TABLE2
N	SET	0
	REPT	10
;	DC.L	%00000000000000000000000000000000,N
	DC.L	%10000000000000000000000000000000,N
	DC.L	%11000000000000000000000000000000,N
	DC.L	%11100000000000000000000000000000,N
	DC.L	%11110000000000000000000000000000,N
	DC.L	%11111000000000000000000000000000,N
	DC.L	%11111100000000000000000000000000,N
	DC.L	%11111110000000000000000000000000,N
	DC.L	%11111111000000000000000000000000,N
	DC.L	%11111111100000000000000000000000,N
	DC.L	%11111111110000000000000000000000,N
	DC.L	%11111111111000000000000000000000,N
	DC.L	%11111111111100000000000000000000,N
	DC.L	%11111111111110000000000000000000,N
	DC.L	%11111111111111000000000000000000,N
	DC.L	%11111111111111100000000000000000,N
	DC.L	%11111111111111110000000000000000,N

	DC.L	%11111111111111111000000000000000,N
	DC.L	%11111111111111111100000000000000,N
	DC.L	%11111111111111111110000000000000,N
	DC.L	%11111111111111111111000000000000,N
	DC.L	%11111111111111111111100000000000,N
	DC.L	%11111111111111111111110000000000,N
	DC.L	%11111111111111111111111000000000,N
	DC.L	%11111111111111111111111100000000,N
	DC.L	%11111111111111111111111110000000,N
	DC.L	%11111111111111111111111111000000,N
	DC.L	%11111111111111111111111111100000,N
	DC.L	%11111111111111111111111111110000,N
	DC.L	%11111111111111111111111111111000,N
	DC.L	%11111111111111111111111111111100,N
	DC.L	%11111111111111111111111111111110,N
	DC.L	%11111111111111111111111111111111,N

N	SET	N+16
	ENDR

	BSS
TABLE	DS.L	20
CODE	DS.B	900
SCREEN1	DS.L	1
SCREEN2	DS.L	1

	DS.B	256
BUFFER	DS.B	64000
