	CLR.L	-(SP)
	MOVE	#$20,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP
	
	MOVE.L	#P,$70.W
J	JMP	J
P
	MOVE	#5000,D0
F	DBF	D0,F

	ST	$FFFF8240.W

*valable pour face 1
	LEA	MINI_TABLO,A6
**
	LEA	t_points,a0
	MOVE	2(A0),D0	Y1
	MOVE	2+4(A0),D1	Y2
	MOVE	2+4*2(A0),D2	Y3
	MOVE	2+4*3(A0),D3	Y4
	JSR	TRIE_MAX
	MOVE	D4,4*2*2-2(A6)
	MOVE	D4,4*4*2-2(A6)
	MOVE	D5,3*4(A6)
	MOVE	D5,7*4(A6)
	JSR	TRIE_MIN
	MOVE	D4,2(A6)
	MOVE	D4,4*4+2(A6)
	MOVE	D5,(A6)
	MOVE	D5,4*4(A6)
**
	LEA	t_points,a0
	MOVE	(A0),D0	X1
	MOVE	4(A0),D1	X2
	MOVE	4*2(A0),D2	X3
	MOVE	4*3(A0),D3	X4
	ADDQ.L	#2,A0
	JSR	TRIE_MAX
	MOVE	D4,4*4+4(A6)
	MOVE	D4,4*4+8(A6)
	MOVE	D5,4*4+6(A6)
	MOVE	D5,4*4+10(A6)
	JSR	TRIE_MIN
	MOVE	D4,4(A6)
	MOVE	D4,8(A6)
	MOVE	D5,6(A6)
	MOVE	D5,10(A6)

	MOVE	#$222,$FFFF8240.W

	LEA	ADR_RTS,A4
	LEA	MINI_TABLO,A6
	MOVE	#4-1,D7	D5/D6/D7 LIBRES
CALC	lea	TAB,A3
	MOVEQ	#0,D0
	MOVEQ	#0,D1
	MOVEQ	#0,D2
	MOVEQ	#0,D3
	MOVE	(A6)+,D0
	MOVE	(A6)+,D1
	MOVE	(A6)+,D2
	MOVE	(A6)+,D3
;	MOVE	#-200,D0	X_DEP
;	MOVE	#200,D2	X_FIN
;
;	MOVE	#0,D1	Y_DEP
;	MOVE	#200,D3	Y_FIN=>(D3-D1) MOTS INSCRITS

	JSR	CALCUL
	DBF	D7,CALC
	SF	$FFFF8240.W

	RTE
TRIE_MAX	CMP	D0,D1
	BGT.S	AD1_WIN_A
AD0_WIN_A	CMP	D2,D0
	BGT.S	AD0_WIN_B
AD2_WIN_A	CMP	D3,D2
	BGT.S	AD2_WIN_B
AD3_WIN_A	MOVE	D3,D4
	MOVE	4*3(A0),D5
	RTS
AD2_WIN_B	MOVE	D2,D4
	MOVE	4*2(A0),D5
	RTS
AD0_WIN_B	CMP	D3,D0
	BGT.S	AD0_WIN_C
AD3_WIN_B	MOVE	D3,D4
	MOVE	4*3(A0),D5
	RTS
AD0_WIN_C	MOVE	D0,D4
	MOVE	(A0),D5
	RTS
AD1_WIN_A	CMP	D2,D1
	BGT.S	AD1_WIN_B
AD2_WIN_C	CMP	D3,D2
	BGT.S	AD2_WIN_B
	MOVE	D3,D4
	MOVE	4*3(A0),D5
	RTS
AD1_WIN_B	CMP	D3,D1
	BGT.S	AD1_WIN_C
	MOVE	D3,D4
	MOVE	4*3(A0),D5
	RTS
AD1_WIN_C	MOVE	D1,D4
	MOVE	4(A0),D5
	RTS


TRIE_MIN	CMP	D0,D1
	BLT.S	D1_WIN_A
D0_WIN_A	CMP	D2,D0
	BLT.S	D0_WIN_B
D2_WIN_A	CMP	D3,D2
	BLT.S	D2_WIN_B
D3_WIN_A	MOVE	D3,D4
	MOVE	4*3(A0),D5
	RTS
D2_WIN_B	MOVE	D2,D4
	MOVE	4*2(A0),D5
	RTS
D0_WIN_B	CMP	D3,D0
	BLT.S	D0_WIN_C
D3_WIN_B	MOVE	D3,D4
	MOVE	4*3(A0),D5
	RTS
D0_WIN_C	MOVE	D0,D4
	MOVE	(A0),D5
	RTS
D1_WIN_A	CMP	D2,D1
	BLT.S	D1_WIN_B
D2_WIN_C	CMP	D3,D2
	BLT.S	D2_WIN_B
	MOVE	D3,D4
	MOVE	4*3(A0),D5
	RTS
D1_WIN_B	CMP	D3,D1
	BLT.S	D1_WIN_C
	MOVE	D3,D4
	MOVE	4*3(A0),D5
	RTS
D1_WIN_C	MOVE	D1,D4
	MOVE	4(A0),D5
	RTS

t_points
	DC	1,1
	DC	10,1
	DC	10,10
	DC	1,10

;	DC	160,1
;	DC	1,100
;	DC	160,199
;	DC	319,100

;	DC	0,0
;	DC	0,0
;	DC	0,0
;	DC	0,0




CALCUL
	MOVEQ	#0,D4
	SUB.W	D0,D2	DELTA X
	SUB.W	D1,D3	DELTA Y
	BNE.S	NON_NUL
	RTS
NON_NUL
	MOVE	D2,D4
	
	ASL	#7,D4	*128
;	EXT.L	D4
	DIVS.W	D3,D4	*X(+1)=(DX/DY)+X
	MOVE	#9,D2
	EXT.L	d4
	ASL.L	D2,D4
	
	ADD	D3,D3
	ADD	D3,D3
	NEG	D3
	SWAP	D4
	
;	ADD	D0,D0
;	ADD	D0,D0
	SUB	D1,D1
	JMP	(A4,D3)

	REPT	201
	MOVE	D0,(A3)+
	ADDX.L	D4,D0
	ENDR
ADR_RTS
	RTS
MINI_TABLO	DS.L	8
TAB	DS	200*2
TABE	DC.L	$99999999,0,0,0