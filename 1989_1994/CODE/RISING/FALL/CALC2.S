	CLR.L	-(SP)
	MOVE	#$20,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP
	
	MOVE.L	#VBK,$70.W
	
J	BRA.S	J

VBK
	MOVE	#5000,D0
F	DBF	D0,F
	MOVEQ	#0,D0
	
	ST	$FFFF8240.W
	LEA	ADR_RTS,A4
	lea	TAB,A3
	MOVE	#-200,D0	X_DEP
	MOVE	#200,D2	X_FIN

	MOVE	#0,D1	Y_DEP
	MOVE	#200,D3	Y_FIN=>(D3-D1) MOTS INSCRITS

	JSR	CALCUL
	
	nop

	SF	$FFFF8240.W
	RTE

CALCUL
	MOVEQ	#0,D4
	SUB.W	D0,D2	DELTA X
	SUB.W	D1,D3	DELTA Y
	BNE.S	NON_NUL
	RTS
NON_NUL
	MOVE	D2,D4
	
	ASL	#7,D4	*128
;	EXT.L	D4
	DIVS.W	D3,D4	*X(+1)=(DX/DY)+X
	MOVE	#9,D2
	EXT.L	d4
	ASL.L	D2,D4
	
	ADD	D3,D3
	ADD	D3,D3
	NEG	D3
	SWAP	D4
	
;	ADD	D0,D0
;	ADD	D0,D0
	SUB	D1,D1
	JMP	(A4,D3)

	REPT	201
	MOVE	D0,(A3)+
	ADDX.L	D4,D0
	ENDR
ADR_RTS
	RTS

TAB	DS	200
TABE	DC.L	$99999999,0,0,0