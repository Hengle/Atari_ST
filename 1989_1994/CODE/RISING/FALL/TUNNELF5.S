NB_PTS_CER = 42	;NB DE POINTS CONSTITUANT UN CERCLE
NB_1 = 10
NB_2 = 9
NB_3 = 6

MAIN	;CLR.L	-(SP)
	;MOVE.W	#$20,-(SP)
	;TRAP	#1
	;ADDQ.W	#6,SP

	;CLR.W	-(SP)
	;PEA	-1.W
	;PEA	-1.W
	;MOVE.W	#5,-(SP)
	;TRAP	#14
	;LEA	12(SP),SP

	;MOVE.L	#FIN,$008.W
	;MOVE.L	#FIN,$00C.W
	;MOVE.L	#FIN,$010.W
	;MOVE.L	#FIN,$014.W
	;MOVE.L	#FIN,$018.W
	;MOVE.L	#FIN,$01C.W
	;MOVE.L	#FIN,$020.W

	MOVE.L	A0,MOD_ZIK
	MOVE.L	A1,MOD_RET
	LEA	DEB_BSS,A0
	LEA	END_BSS,A1
EFFD	CLR.L	(A0)+
	CMP.L	A1,A0
	BLE.S	EFFD
	JSR	GENERE

	;MOVEQ	#1,D0
	;JSR	ZIK

	BSR	PREP_ECR
	BSR	PREPARE_ALL

	MOVE.W	#$2700,SR
	CLR.B	$FFFFFA07.W
	CLR.B	$FFFFFA09.W
	CLR.B	$FFFFFA1B.W
	CLR.B	$FFFFFA13.W
	CLR.B	$FFFFFA15.W

	BSET	#0,$FFFFFA07.W
	BSET	#0,$FFFFFA13.W

	MOVE.L	#VBLR,$70.W
	MOVE.L	#INTER_RTE,$68.W
	MOVE.L	#INTER_RTE,$120.W
	MOVE.W	#$2300,SR

J	BRA.S	J
MOD_RET	EQU	*+2
	JMP	MOD_RET
FIN	MOVE.L	4.W,A0
	JMP	(A0)
VBLR
	CLR.B	$FFFFFA1B.W
	CLR.W	$FFFF8240.W
	MOVE.L	#$06660444,$FFFF8242.W
	MOVE.L	#$06660222,$FFFF8246.W
	MOVE.L	#$06660444,$FFFF824A.W
	MOVE.W	#$666,$FFFF824E.W
	MOVE.L	#$03330333,D0
	MOVE.L	D0,$FFFF8250.W
	MOVE.L	D0,$FFFF8254.W
	MOVE.L	D0,$FFFF8258.W
	MOVE.L	D0,$FFFF825C.W
	MOVE.B	#0,$FFFFFA19.W
	MOVE.B	#99,$FFFFFA1F.W
	MOVE.B	#4,$FFFFFA19.W
	BCLR	#3,$FFFFFA17.W
	MOVE.L	#INTER_TMA,$134.W
	ORI.B	#$20,$FFFFFA13.W
	ORI.B	#$20,$FFFFFA07.W
	BSR	GEST_CERCLES1
	MOVE.L	(A6),A0
	MOVE.L	A6,USP
INTER_RTE	RTE

INTER_TMA:	
	CLR.B	$FFFFFA07.W
	CLR.B	$FFFFFA09.W
	MOVE	#$2100,SR
full
	LEA	$FFFF820A.W,A6

	MOVEQ	#0,D4
	MOVEQ	#2,D5

	STOP	#$2100
	MOVE	#$2700,SR
	MOVE	#$2300,(SP)
	MOVEQ	#29,D6
SYNCHROA:	DBF	D6,SYNCHROA
	NOP

	MOVE.B	D4,(A6)
	REPT	6
	NOP
	ENDR
	MOVE.B	D5,(A6)

******
	MOVE.L	#$FFFF8209,A5
	MOVE.L	#$FFFF8260,A6
	MOVE.L	#$FFFF820A,A3
	MOVEQ	#0,D4
	MOVEQ	#$10,D6
;	MOVEQ	#19,D0	2

SYNCHRO	MOVE.B	(A5),D7     * SYNCHRO
	BEQ.S	SYNCHRO
	SUB.W	D7,D6
	LSL.W	D6,D4
	DCB	97-7-5-4,$4E71

	MOVE.L	ADR_EFF_CER,A5
	ADDQ.W	#2,A5
	MOVE.W	(A1)+,D2	;D2=C_X*4	2
	MOVE.W	(A1)+,D3	;D3=C_Y*4	2

	REPT	10-1
	JSR	PART1
	ENDR
	
	JSR	PART1C
	
	REPT	9-1
	JSR	PART1
	ENDR
	JSR	PART1C
	REPT	3
	JSR	PART1
	ENDR

	JSR	PART1B	ON PERD 2 LIGNES
;	MANQUE 7 LIGNES
	JSR	PART1
	JSR	PART1

;FULLSCREEN	NOP
;	MOVE	a6,(A6)
;	MOVE.B	#0,(A6)
;	DCB	88,$4E71
;	MOVE.b	#0,(A3)
;	MOVE	a6,(A3)
;	DCB	13,$4E71
;	MOVE	a6,(A6)
;	MOVE.B	#0,(A6)
;	DCB	12-4,$4E71
;	DBF	D0,FULLSCREEN

	LEA	ADR_EFF_CER,A0
	MOVE.L	(A0)+,D0
	MOVE.L	(A0),-(A0)
	MOVE.L	D0,4(A0)
	MOVEQ	#0,D0
	MOVEQ	#0,D1
	MOVEQ	#0,D2
	MOVEQ	#0,D3
	MOVEQ	#0,D4
	MOVEQ	#0,D5
	MOVEQ	#0,D6
	MOVEQ	#0,D7
	MOVEM.L	D0-D7,$FFFF8240.W
	MOVEM.L	D0-A6,-(SP)
MOD_ZIK	EQU	*+2
	JSR	MOD_ZIK
	MOVEM.L	(SP)+,D0-A6
	BSR	SWAPEC
	CMPI.B	#$39,$FFFFFC02.W
	BNE.S	POPOPOK
	MOVE	#$4E71,J
POPOPOK	RTE

GEST_CERCLES1	MOVE.L	PT_TUNNEL,A0
	LEA	BUF_POZ_COOR_CENTRES,A1
	MOVE.W	#230,D1
	MOVE.W	#100,D2
	SUB.W	(A0)+,D1	;A
	SUB.W	(A0)+,D2	;B
	MOVE.L	A0,PT_TUNNEL
	MOVEQ	#24,D7
	MOVE.L	PT_2,A0
.REPEAT	MOVE.W	(A0)+,D3	;X
	MOVE.W	(A0)+,D4	;Y
	ADD.W	D1,D3	;X+A
	ADD.W	D2,D4	;Y+B
	SUBI.W	#230,D3
	SUBI.W	#100,D4
	ADD.W	D3,D3
	ADD.W	D3,D3
	ADD.W	D4,D4
	MOVE.W	D3,(A1)+
	MOVE.W	D4,(A1)+
	LEA	12(A0),A0
	DBRA	D7,.REPEAT

	MOVE.L	PT_TUNNEL,A0
	CMPA.L	#FIN_PARCOURS,A0
	BNE.S	.FUCK2
	LEA	PARCOURS,A0
	MOVE.L	A0,PT_2
	MOVE.L	A0,PT_TUNNEL
.FUCK2
	MOVE.L	ADR_EFF_CER,A3
	MOVE.L	SCREEN2_TYP,A0
	SUBQ	#8,A0
	LEA	2(A0),A1
	LEA	2(A1),A2
	MOVEQ	#0,D0
	JSR	(A3)

	MOVE.W	Z_DEP,D1
	MOVE.W	D1,D0
	LEA	TABLE_CERCLES,A6
	ADD.W	D0,D0
	ADD.W	D0,D0
	ADDA.W	D0,A6
	SUBQ.W	#1,D1
	ANDI.W	#3,D1
	CMPI.W	#3,D1
	BNE.S	.FUCK
	ADDI.L	#16,PT_2
.FUCK	MOVE.W	D1,Z_DEP

	MOVE.L	ADR_EFF_CER,A5
	ADDQ.W	#2,A5

	LEA	BUF_POZ_COOR_CENTRES,A1
	LEA	CORES_X,A2
	MOVE.L	SCREEN2_TYP,A4
	SUBQ	#8,A4
	RTS

SWAPEC	MOVE.L	SCREEN1_TYP,D0
	MOVE.L	SCREEN2_TYP,SCREEN1_TYP
	MOVE.L	D0,SCREEN2_TYP
	MOVE.L	SCREEN1,D0
	MOVE.L	SCREEN2,SCREEN1
	MOVE.L	D0,SCREEN2
	MOVE.B	SCREEN1+1,$FFFF8201.W
	MOVE.B	SCREEN1+2,$FFFF8203.W
	RTS

PREP_ECR	
	MOVE.L	#BUFFER,D0
	CLR.B	D0
	MOVE.L	D0,SCREEN1
	ADDI.L	#29440+160,D0
	MOVE.L	D0,SCREEN1_TYP
	MOVE.L	#BUFFER2,D0
	CLR.B	D0
	MOVE.L	D0,SCREEN2
	ADDI.L	#29440+160,D0
	MOVE.L	D0,SCREEN2_TYP
	RTS

PREPARE_ALL	
;	LEA	BUF_COD_CERCLES,A0
;	MOVE.L	LITTLE_CODES,(A0)+
;	MOVE.W	#NB_PTS_CER-1,D0
;.RECOP_NB_RT	LEA	ROUTINE_PT_CERCLES,A1
;	MOVE.W	#LONG_RT_CIRCLES-1,D1
;.RECOP_RT	MOVE.W	(A1)+,(A0)+
;	DBRA	D1,.RECOP_RT
;	DBRA	D0,.RECOP_NB_RT
;	MOVE.W	#$4E75,(A0)

	LEA	COEFF_CERCLES,A1
	LEA	BUF_COOR_CERCLES,A2
	LEA	TABLE_CERCLES,A3
	MOVE.W	#199,D6
.RECOM_CALC_ALL_Z
	MOVE.L	A2,(A3)+
	LEA	CIRCLE_COOR,A0
	MOVE.W	(A1)+,D5	;COEFF 3D
	MOVEQ	#NB_PTS_CER-1,D7
.RECOM_CALC_ALL_PNTS
	MOVE.W	(A0)+,D0	;X
	MOVE.W	(A0)+,D1	;Y
	ADD.W	D0,D0
	ADD.W	D1,D1
	MULS.W	D5,D0
	MULS.W	D5,D1
	SWAP	D0
	SWAP	D1
	ADDI.W	#230,D0
	ADDI.W	#100,D1
	ADD.W	D0,D0
	ADD.W	D0,D0
	ADD.W	D1,D1
	ADDI.W	#CORES_Y-CORES_X,D1
	MOVE.W	D0,(A2)+	;X
	MOVE.W	D1,(A2)+	;Y
	DBRA	D7,.RECOM_CALC_ALL_PNTS
	DBRA	D6,.RECOM_CALC_ALL_Z

	LEA	PARCOURS,A0
	MOVE.L	A0,PT_TUNNEL
	MOVE.L	A0,PT_2
	LEA	FIN_PARCOURS,A1
	MOVE.W	#999,D7
.RECOP_FIN	MOVE.W	(A0)+,(A1)+
	DBRA	D7,.RECOP_FIN

	LEA	ADR_EFF_CER,A0
	LEA	RT_EFF_1,A1
	LEA	RT_EFF_2,A2
	MOVE.L	A1,(A0)+
	MOVE.L	A2,(A0)

	CLR.W	Z_DEP

	RTS

LITTLE_CODES	
	MOVE.W	(A1)+,D2	;D2=C_X*4	2
	MOVE.W	(A1)+,D3	;D3=C_Y*4	2

ROUTINE_PT_CERCLES
	MOVE.W	(A0)+,D0	;X*4 ,2
	MOVE.W	(A0)+,D1	;Y*2 ,2
	ADD.W	D2,D0	;+C_X*4	1
	ADD.W	D3,D1	;+C_Y*2	1
	MOVE.W	(A2,D1.W),D1	;Y*160	4
	ADD.W	2(A2,D0.W),D1	;+OFFSET	4
	MOVE.W	(A2,D0.W),D0	;MOTIF	4
	OR.W	D0,(A4,D1.W)	;AFFICHAGE	5
	MOVE.W	D1,(A5)	;2
	ADDQ.W	#4,A5	;1

LONG_RT_CIRCLES = (*-ROUTINE_PT_CERCLES)/2

PART2
	MOVE.W	(A1)+,D2	;D2=C_X*4
	MOVE.W	(A1)+,D3	;D3=C_Y*4

	REPT	14
	MOVEM.W	(A0)+,D0-D1/D4-D7	9
	ADD.W	D2,D0		1
	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

************
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1
	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2
*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2
	ENDR
	RTS
PART1
	MOVE	A6,(A6)	DEB LIGNE 1
	MOVE.B	#0,(A6)
	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 1-3
	ADD.W	D2,D0		1
	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

************
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1
	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2
*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 4-6
	ADD.W	D2,D0		1

;	DCB	88-78,$4E71
	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
;	DCB	13,$4E71
	ADD.W	D3,D1		1
	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1
	ADD.W	D2,D6		1

;	DCB	12-9-2,$4E71

	MOVE	A6,(A6)	DEB LIGNE2
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2
*************
;	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 7-9
	ADD.W	D2,D0		1

	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	DCB	1,$4E71	1 NOP DE PAUMê, GRR!
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1

	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2
	ADDQ.W	#4,A5		2

	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4

	MOVE	A6,(A6)	DEB LIGNE3
	MOVE.B	#0,(A6)
;	DCB	88-13,$4E71
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 10-12
	ADD.W	D2,D0		1

	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

************
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2

*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4

	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	NOP	ENCORE 1!!!!!!!!!!!
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2
	
	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 13-15
	ADD.W	D2,D0		1
	ADD.W	D3,D1		1
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

;	DCB	13-4,$4E71
	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4
;	DCB	12-10,$4E71

	MOVE	A6,(A6)	DEB LIGNE4
	MOVE.B	#0,(A6)
;	DCB	88-23*2-13,$4E71
	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2
************
	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2

*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4

	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 16-18
	ADD.W	D2,D0		1
	ADD.W	D3,D1		1
	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4
	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1
	ADD.W	D2,D6		1
	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4
	MOVE.W	(A2,D4.W),D4		4
	ADD.W	D3,D7		1
;	DCB	13,$4E71
	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2
	ADDQ.W	#4,A5		2
	DCB	12-9,$4E71

	MOVE	A6,(A6)	debut de la ligne5
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 19-21
	ADD.W	D2,D0		1

	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4

	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

************
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4

	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2

*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1

	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	NOP
	NOP
;	DCB	88-12-9-23*2-9-10,$4E71	2
	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2
;	DCB	13-11,$4E71
	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 22-24
	ADD.W	D2,D0		1
	ADD.W	D2,D4		1
	ADD.W	D3,D1		1
;	DCB	12-9,$4E71	fin de la ligne 5

	MOVE	A6,(A6)	debut de la ligne6
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4
	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2
************
	ADD.W	D3,D5		1

	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4

	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2

*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1

	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4

	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 25-27
	ADD.W	D2,D0		1
	ADD.W	D3,D1		1
	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

	DCB	88-66-19-2,$4E71
	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	MOVE.W	(A2,D0.W),D0		4
	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2
;	DCB	13-11,$4E71

	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4

;	DCB	12,$4E71	fin de la ligne

	MOVE	A6,(A6)	debut de la ligne7
	MOVE.B	#0,(A6)
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2
	ADDQ.W	#4,A5		2

*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

;	DCB	88-23-9-55,$4E71
	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 28-30
	ADD.W	D2,D0		1
	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4

	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

************
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4

	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2
	ADD.W	D2,D6		1

*************

	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4
;	DCB	13,$4E71
	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2
	DCB	12-9,$4E71	fin de la ligne 7

	MOVE	A6,(A6)	DEB LIGNE 8
	MOVE.B	#0,(A6)
	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 31-33
	ADD.W	D2,D0		1
	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

************
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1
	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2
*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 34-36
	ADD.W	D2,D0		1

;	DCB	88-78,$4E71
	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
;	DCB	13,$4E71
	ADD.W	D3,D1		1
	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1
	ADD.W	D2,D6		1

;	DCB	12-9-2,$4E71

	MOVE	A6,(A6)	DEB LIGNE9
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2
*************
;	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 37-39
	ADD.W	D2,D0		1

	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	DCB	1,$4E71	1 NOP DE PAUMê, GRR!
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1

	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2
	ADDQ.W	#4,A5		2

	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4

	MOVE	A6,(A6)	DEB LIGNE10
	MOVE.B	#0,(A6)
;	DCB	88-13,$4E71
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 40-42
	ADD.W	D2,D0		1

	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

************
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2

*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4

	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	NOP	ENCORE 1!!!!!!!!!!!
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
;	dcb	13-9,$4e71
	MOVE.L	USP,A6	1
	LEA	4*4(A6),A6	2
	MOVE.L	(A6),A0	3
	MOVE.L	A6,USP	1
	LEA	$FFFF8260.W,A6	2
	MOVE.W	(A1)+,D2	;D2=C_X*4	2
	MOVE.W	(A1)+,D3	;D3=C_Y*4	2

	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	DCB	12-9,$4E71
	rts
PART1B
	MOVE	A6,(A6)	DEB LIGNE 1
	MOVE.B	#0,(A6)
	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 1-3
	ADD.W	D2,D0		1
	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

************
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1
	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2
*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 4-6
	ADD.W	D2,D0		1

;	DCB	88-78,$4E71
	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
;	DCB	13,$4E71
	ADD.W	D3,D1		1
	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1
	ADD.W	D2,D6		1

;	DCB	12-9-2,$4E71

	MOVE	A6,(A6)	DEB LIGNE2
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2
*************
;	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 7-9
	ADD.W	D2,D0		1

	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	DCB	1,$4E71	1 NOP DE PAUMê, GRR!
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1

	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2
	ADDQ.W	#4,A5		2

	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4

	MOVE	A6,(A6)	DEB LIGNE3
	MOVE.B	#0,(A6)
;	DCB	88-13,$4E71
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 10-12
	ADD.W	D2,D0		1

	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

************
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2

*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4

	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	NOP	ENCORE 1!!!!!!!!!!!
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2
	
	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 13-15
	ADD.W	D2,D0		1
	ADD.W	D3,D1		1
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

;	DCB	13-4,$4E71
	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4
;	DCB	12-10,$4E71

	MOVE	A6,(A6)	DEB LIGNE4
	MOVE.B	#0,(A6)
;	DCB	88-23*2-13,$4E71
	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2
************
	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2

*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4

	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 16-18
	ADD.W	D2,D0		1
	ADD.W	D3,D1		1
	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4
	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1
	ADD.W	D2,D6		1
	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4
	MOVE.W	(A2,D4.W),D4		4
	ADD.W	D3,D7		1
;	DCB	13,$4E71
	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2
	ADDQ.W	#4,A5		2
	DCB	12-9,$4E71

	MOVE	A6,(A6)	debut de la ligne5
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 19-21
	ADD.W	D2,D0		1

	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4

	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

************
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4

	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2

*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1

	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	NOP
	NOP
;	DCB	88-12-9-23*2-9-10,$4E71	2
	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2
;	DCB	13-11,$4E71
	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 22-24
	ADD.W	D2,D0		1
	ADD.W	D2,D4		1
	ADD.W	D3,D1		1
;	DCB	12-9,$4E71	fin de la ligne 5

	MOVE	A6,(A6)	debut de la ligne6
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4
	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2
************
	ADD.W	D3,D5		1

	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4

	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2

*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1

	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4

	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 25-27
	ADD.W	D2,D0		1
	ADD.W	D3,D1		1
	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

	DCB	88-66-19-2,$4E71
	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	MOVE.W	(A2,D0.W),D0		4
	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2
;	DCB	13-11,$4E71

	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4

;	DCB	12,$4E71	fin de la ligne

	MOVE	A6,(A6)	debut de la ligne7
	MOVE.B	#0,(A6)
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2
	ADDQ.W	#4,A5		2

*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

;	DCB	88-23-9-55,$4E71
	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 28-30
	ADD.W	D2,D0		1
	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4

	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

************
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4

	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2
	ADD.W	D2,D6		1

*************

	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4
;	DCB	13,$4E71
	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2
	DCB	12-9,$4E71	fin de la ligne 7

	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	DCB	88,$4E71
	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	DCB	13,$4E71
	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	;	ICI=116	NOPS

	CLR.B	$FFFF820A.W 
	DCB	8,$4E71

	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	MOVE	A6,(A3)
	DCB	88-2,$4E71
	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	DCB	13,$4E71
	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	DCB	12,$4E71

	MOVE	A6,(A6)	DEB LIGNE 8
	MOVE.B	#0,(A6)
	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 31-33
	ADD.W	D2,D0		1
	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

************
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1
	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2
*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 34-36
	ADD.W	D2,D0		1

;	DCB	88-78,$4E71
	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
;	DCB	13,$4E71
	ADD.W	D3,D1		1
	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1
	ADD.W	D2,D6		1

;	DCB	12-9-2,$4E71

	MOVE	A6,(A6)	DEB LIGNE9
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2
*************
;	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 37-39
	ADD.W	D2,D0		1

	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	DCB	1,$4E71	1 NOP DE PAUMê, GRR!
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1

	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2
	ADDQ.W	#4,A5		2

	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4

	MOVE	A6,(A6)	DEB LIGNE10
	MOVE.B	#0,(A6)
;	DCB	88-13,$4E71
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 40-42
	ADD.W	D2,D0		1

	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

************
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2

*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4

	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	NOP	ENCORE 1!!!!!!!!!!!
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
;	dcb	13-9,$4e71
	MOVE.L	USP,A6	1
	LEA	4*4(A6),A6	2
	MOVE.L	(A6),A0	3
	MOVE.L	A6,USP	1
	LEA	$FFFF8260.W,A6	2
	MOVE.W	(A1)+,D2	;D2=C_X*4	2
	MOVE.W	(A1)+,D3	;D3=C_Y*4	2

	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	DCB	12-9,$4E71
	rts
PART1C
	MOVE	A6,(A6)	DEB LIGNE 1
	MOVE.B	#0,(A6)
	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 1-3
	ADD.W	D2,D0		1
	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

************
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1
	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2
*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 4-6
	ADD.W	D2,D0		1

;	DCB	88-78,$4E71
	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
;	DCB	13,$4E71
	ADD.W	D3,D1		1
	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1
	ADD.W	D2,D6		1

;	DCB	12-9-2,$4E71

	MOVE	A6,(A6)	DEB LIGNE2
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2
*************
;	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 7-9
	ADD.W	D2,D0		1

	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	DCB	1,$4E71	1 NOP DE PAUMê, GRR!
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1

	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2
	ADDQ.W	#4,A5		2

	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4

	MOVE	A6,(A6)	DEB LIGNE3
	MOVE.B	#0,(A6)
;	DCB	88-13,$4E71
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 10-12
	ADD.W	D2,D0		1

	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

************
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2

*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4

	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	NOP	ENCORE 1!!!!!!!!!!!
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2
	
	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 13-15
	ADD.W	D2,D0		1
	ADD.W	D3,D1		1
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

;	DCB	13-4,$4E71
	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4
;	DCB	12-10,$4E71

	MOVE	A6,(A6)	DEB LIGNE4
	MOVE.B	#0,(A6)
;	DCB	88-23*2-13,$4E71
	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2
************
	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2

*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4

	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 16-18
	ADD.W	D2,D0		1
	ADD.W	D3,D1		1
	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4
	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1
	ADD.W	D2,D6		1
	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4
	MOVE.W	(A2,D4.W),D4		4
	ADD.W	D3,D7		1
;	DCB	13,$4E71
	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2
	ADDQ.W	#4,A5		2
	DCB	12-9,$4E71

	MOVE	A6,(A6)	debut de la ligne5
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 19-21
	ADD.W	D2,D0		1

	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4

	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

************
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4

	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2

*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1

	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	NOP
	NOP
;	DCB	88-12-9-23*2-9-10,$4E71	2
	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2
;	DCB	13-11,$4E71
	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 22-24
	ADD.W	D2,D0		1
	ADD.W	D2,D4		1
	ADD.W	D3,D1		1
;	DCB	12-9,$4E71	fin de la ligne 5

	MOVE	A6,(A6)	debut de la ligne6
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4
	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2
************
	ADD.W	D3,D5		1

	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4

	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2

*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1

	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4

	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 25-27
	ADD.W	D2,D0		1
	ADD.W	D3,D1		1
	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

	DCB	88-66-19-2,$4E71
	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	MOVE.W	(A2,D0.W),D0		4
	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2
;	DCB	13-11,$4E71

	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4

;	DCB	12,$4E71	fin de la ligne

	MOVE	A6,(A6)	debut de la ligne7
	MOVE.B	#0,(A6)
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2
	ADDQ.W	#4,A5		2

*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

;	DCB	88-23-9-55,$4E71
	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 28-30
	ADD.W	D2,D0		1
	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4

	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

************
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4

	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2
	ADD.W	D2,D6		1

*************

	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4
;	DCB	13,$4E71
	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2
	DCB	12-9,$4E71	fin de la ligne 7

	MOVE	A6,(A6)	DEB LIGNE 8
	MOVE.B	#0,(A6)
	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 31-33
	ADD.W	D2,D0		1
	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

************
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1
	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2
*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 34-36
	ADD.W	D2,D0		1

;	DCB	88-78,$4E71
	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
;	DCB	13,$4E71
	ADD.W	D3,D1		1
	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1
	ADD.W	D2,D6		1

;	DCB	12-9-2,$4E71

	MOVE	A6,(A6)	DEB LIGNE9
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2
*************
;	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 37-39
	ADD.W	D2,D0		1

	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	DCB	1,$4E71	1 NOP DE PAUMê, GRR!
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1

	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2
	ADDQ.W	#4,A5		2

	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4
	MOVE.W	(A2,D6.W),D6		4

	MOVE	A6,(A6)	DEB LIGNE10
	MOVE.B	#0,(A6)
;	DCB	88-13,$4E71
	OR.W	D6,(A4,D7.W)		5
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVEM.W	(A0)+,D0-D1/D4-D7	9	RT 40-42
	ADD.W	D2,D0		1

	ADD.W	D3,D1		1

	MOVE.W	(A2,D1.W),D1		4
	ADD.W	2(A2,D0.W),D1		4
	MOVE.W	(A2,D0.W),D0		4

	OR.W	D0,(A4,D1.W)		5
	MOVE.W	D1,(A5)		2
	ADDQ.W	#4,A5		2

************
	ADD.W	D2,D4		1
	ADD.W	D3,D5		1

	MOVE.W	(A2,D5.W),D5		4
	ADD.W	2(A2,D4.W),D5		4

	MOVE.W	(A2,D4.W),D4		4
	OR.W	D4,(A4,D5.W)		5
	MOVE.W	D5,(A5)		2

	ADDQ.W	#4,A5		2

*************
	ADD.W	D2,D6		1
	ADD.W	D3,D7		1
	MOVE.W	(A2,D7.W),D7		4
	ADD.W	2(A2,D6.W),D7		4

	MOVE.W	(A2,D6.W),D6		4
	OR.W	D6,(A4,D7.W)		5
	NOP	ENCORE 1!!!!!!!!!!!
	MOVE.W	D7,(A5)		2
	ADDQ.W	#4,A5		2

	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
;	dcb	13-9,$4e71
	MOVE.L	USP,A6	1
	LEA	4*4(A6),A6	2
	MOVE.L	(A6),A0	3
	MOVE.L	A6,USP	1
	LEA	$FFFF8260.W,A6	2
	MOVE.W	(A1)+,D2	;D2=C_X*4	2
	MOVE.W	(A1)+,D3	;D3=C_Y*4	2

	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	DCB	12-9-2,$4E71
	ADDQ	#2,A4
	rts


***************
	MOVE.L	USP,A6	1
	LEA	4*4(A6),A6	2
	MOVE.L	(A6),A0	3
	MOVE.L	A6,USP	1
	LEA	$FFFF8260.W,A6	2

	MOVE	A6,(A6)	debut de la ligne
	MOVE.B	#0,(A6)
	DCB	88,$4E71
	MOVE.b	#0,(A3)
	MOVE	A6,(A3)
	DCB	13,$4E71
	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	DCB	12,$4E71	fin de la ligne
	RTS

GENERE
	LEA	GêNêRê1,A0
	LEA	64*30*2(A0),A0
	MOVEQ	#0,D0
	MOVEQ	#27,D1
G1	MOVEQ	#15,D2
	MOVE	#32768,D3
G0	MOVE	D3,(A0)+
	MOVE	D0,(A0)+
	LSR	#1,D3
	DBF	D2,G0
	ADDQ	#8,D0
	DBF	D1,G1
	LEA	64*30*2(A0),A0
	MOVE	#399,D0
G2	MOVE	#-131*230,(A0)+
	DBF	D0,G2
	MOVE	#-130,D0
	MOVE	#260-1,D1
G3	MOVE	D0,D2
	MULU	#230,D2
	MOVE	D2,(A0)+
	ADDQ	#1,D0
	DBF	D1,G3
	MOVE	#399,D0
G4	MOVE	#-131*230,(A0)+
	DBF	D0,G4

	LEA	RT_EFF_1,A0
	MOVE	#NB_1,D0
	MOVE	#NB_PTS_CER,D1
	MULU	D0,D1
	SUBQ	#1,D1
F1	MOVE.L	#$31400000,(A0)+
	DBF	D1,F1
	MOVE	#NB_2,D0
	MOVE	#NB_PTS_CER,D1
	MULU	D0,D1
	SUBQ	#1,D1
F2	MOVE.L	#$33400000,(A0)+
	DBF	D1,F2
	MOVE	#NB_3,D0
	MOVE	#NB_PTS_CER,D1
	MULU	D0,D1
	SUBQ	#1,D1
F3	MOVE.L	#$35400000,(A0)+
	DBF	D1,F3
	MOVE	#$4E75,(A0)

	LEA	RT_EFF_2,A0
	MOVE	#NB_1,D0
	MOVE	#NB_PTS_CER,D1
	MULU	D0,D1
	SUBQ	#1,D1
F1B	MOVE.L	#$31400000,(A0)+
	DBF	D1,F1B
	MOVE	#NB_2,D0
	MOVE	#NB_PTS_CER,D1
	MULU	D0,D1
	SUBQ	#1,D1
F2B	MOVE.L	#$33400000,(A0)+
	DBF	D1,F2B
	MOVE	#NB_3,D0
	MOVE	#NB_PTS_CER,D1
	MULU	D0,D1
	SUBQ	#1,D1
F3B	MOVE.L	#$35400000,(A0)+
	DBF	D1,F3B
	MOVE	#$4E75,(A0)

	RTS

	DATA

;BUF_POZ_COOR_CENTRES
;	DS.W	2*30
;
;PROUT	DCB.W	100,0

;	DCB.W	64*30,0
;N	SET	0
;CORES_X	REPT	28
;	DC.W	32768,N,16384,N,8192,N,4096,N,2048,N,1024,N,512,N,256,N,128,N,64,N,32,N,16,N,8,N,4,N,2,N,1,N
;N	SET	N+8
;	ENDR
;	DCB.W	64*30,0
;
;	DCB.W	400,-131*230
;N	SET	-130
;CORES_Y	REPT	130+130
;	DC.W	N*230
;N	SET	N+1
;	ENDR
;	DCB.W	400,-131*230

COEFF_CERCLES	INCBIN	COEFF11.3D

CIRCLE_COOR	INCBIN	CERCLE4.DAT
ZIK	INCBIN	BUGGIN6.MUS

PARCOURS	INCBIN	CHEMIN6.DAT
	SECTION	BSS
DEB_BSS
FIN_PARCOURS	DCB.W	1000,0
	
BUF_POZ_COOR_CENTRES
	DS.W	2*30

Z_DEP	DS.W	1
ADR_EFF_CER	DS.L	2
PT_TUNNEL	DS.L	1
PT_2	DS.L	1
NB_VBL	DS.W	1
SCREEN1	DS.L	1
SCREEN1_TYP	DS.L	1
SCREEN2	DS.L	1
SCREEN2_TYP	DS.L	1
	DS.B	256
	DS.B	8*160
BUFFER	DS.B	64000
	DS.B	8*160
BUFFER2	DS.B	64000
	DS.B	8*160

BUF_COD_CERCLES	DS.W	3+LONG_RT_CIRCLES*NB_PTS_CER
TABLE_CERCLES	DS.L	200
BUF_COOR_CERCLES
	DS.W	NB_PTS_CER*2*200

GêNêRê1	DS.B	11592
CORES_X	EQU	GêNêRê1+64*30*2
CORES_Y	EQU	GêNêRê1+10272
RT_EFF_1	DS.B	4202
RT_EFF_2	DS.B	4202
END_BSS