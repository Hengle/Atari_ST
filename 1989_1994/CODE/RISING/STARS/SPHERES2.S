	CLR.L	-(SP)
	MOVE	#$20,-(SP)
	TRAP	#1
	ADDQ	#6,SP

	CLR	-(SP)
	PEA	-1.W
	PEA	-1.W
	MOVE	#5,-(SP)
	TRAP	#14
	LEA	12(SP),SP
	MOVE	#$001,$FFFF8240.W
	BRA.S	DEBUT

DECALE	MOVEM.L	D0/A0,-(SP)
	LEA	DISK+34,A0
	MOVE	#199,D0
RO
N	SET	0
	REPT	20
	ROXR	N(A0)
N	SET	N+8
	ENDR
	LEA	160(A0),A0
	DBF	D0,RO
	MOVEM.L	(SP)+,D0/A0
	RTS


DEBUT
	LEA	BUF_COD,A0
	LEA	TABLE,A4
	MOVE	#8-1,D4
ICI
	LEA	LITTLE_TABLE,A6
	MOVEQ	#0,D5
FINI	MOVE.L	A0,(A4)+
	MOVE.L	(A6)+,D6
	CMPI.L	#-1,D6
	BEQ.S	TERMINê
;	LEA	VALEURS,A1
	LEA	DISK+34,A2

	LEA	-160(A2),A2
	MOVE	#-160,D7

CONT	;ADDQ	#8,A2
	;ADDQ	#8,D7

	LEA	160(A2),A2
	ADD	#160,D7
	CMPI	#160*200,D7
	BNE.S	OK
	MOVEQ	#0,D7
	ADDQ	#8,D5
	CMPI	#160,D5
	BNE.S	NOT_END
	MOVEQ	#0,D5
	MOVE	#$4E75,(A0)+
	BRA.S	FINI
NOT_END
	MOVE.L	A0,(A4)+
	LEA	DISK+34,A2
OK
;	CMPI	#32000,D7
;	BEQ.S	FINI
	MOVE.L	D6,A1
	MOVE	(A2,D5.W),D0
	BEQ.S	CONT
	MOVEQ	#0,D2
SEARCH	MOVE	(A1)+,D1
	CMPI	#$9999,D1
	BEQ.S	CONT
	CMP	D0,D1
	BNE.S	NOT_THIS_ONE
	MOVE	#$3140,(A0)
	ADD	D2,(A0)+
	MOVE	D7,(A0)
	ADD	D5,(A0)+
	BRA.S	CONT
NOT_THIS_ONE	ADDQ	#1,D2
	BRA.S	SEARCH
TERMINê	NOP
	JSR	DECALE
	JSR	DECALE
	ADDQ	#1,$FFFF8240.W
	DBF	D4,ICI

	SF	$FFFF8240.W
POPO	MOVE.L	$44E.W,A0
	LEA	TABLE,A2
MOD_DEP	EQU	*+2
	LEA	0(A2),A2
	LEA	PART_1,A1
	REPT	4
	MOVEM	(A1)+,D0-D7
	MOVE.L	(A2),A3
	JSR	(A3)
	ADDQ	#2,A1
	LEA	20*4(A2),A2
	ENDR
	MOVE	#7,-(SP)
	TRAP	#1
	ADDQ	#2,SP
	MOVE.L	$44E.W,A0
	MOVE	#7999,D0
EFF	CLR.L	(A0)+
	DBF	D0,EFF
	ADD	#4*20*4+4,MOD_DEP
	BRA	POPO
J	BRA.S	J

DISK	INCBIN	DISK.PI1

LITTLE_TABLE
	DC.L	PART_1
	DC.L	PART_2
	DC.L	PART_3
	DC.L	PART_4
	DC.L	-1
VALEURS
PART_1	DC	%1111111111111111
	DC	%1111111111111110
	DC	%1111111111111100
	DC	%1111111111111000
	DC	%1111111111110000
	DC	%1111111111100000
	DC	%1111111111000000
	DC	%1111111110000000
	DC	$9999

PART_2	DC	%1111111100000000
	DC	%1111111000000000
	DC	%1111110000000000
	DC	%1111100000000000
	DC	%1111000000000000
	DC	%1110000000000000
	DC	%1100000000000000
	DC	%1000000000000000
	DC	$9999

PART_3	DC	%0000000000000000
	DC	%0111111111111111
	DC	%0011111111111111
	DC	%0001111111111111
	DC	%0000111111111111
	DC	%0000011111111111
	DC	%0000001111111111
	DC	%0000000111111111
	DC	$9999

PART_4	DC	%0000000011111111
	DC	%0000000001111111
	DC	%0000000000111111
	DC	%0000000000011111
	DC	%0000000000001111
	DC	%0000000000000111
	DC	%0000000000000011
	DC	%0000000000000001
	DC	$9999

	BSS
TABLE	DS.L	20*4*16
	ds.l	50
BUF_COD	DS.B	100000